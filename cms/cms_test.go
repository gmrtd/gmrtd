package cms

import (
	"testing"

	"github.com/gmrtd/gmrtd/utils"
)

func TestVerifySignedData(t *testing.T) {
	/*
	 * get the (default) CSCA Certificate-Pool
	 */
	cscaCertPool, err := GetDefaultMasterList()
	if err != nil {
		t.Fatalf("CscaCertPool error: %s", err)
	}

	testCases := []struct {
		signedDataBytes   []byte
		expError          bool
		expCertChainItems int
	}{
		{
			// AT
			signedDataBytes:   utils.HexToBytes("3082064906092a864886f70d010702a082063a30820636020103310f300d06096086480165030402010500308201120606678108010101a0820106048201023081ff020100300d060960864801650304020105003081ea3025020101042090462cd4824bc24ce1ce77e0e40da503b5f25063e61a78e22c3ac04e49b2024330250201020420113888bddfb89a94522959f3cf41007bb1241e2fdfa585d8f480317eb648215f302502010304205c1c4fa5fd3d90662a92d5c6c7ee94030ae7eed9070a6d8f1db376b268d99f83302502010b04202a1704fa33c5b3a5760eb8b48ff0ff9178e6470dc525b79b13bdcbc95d9d83d5302502010c0420c9673800c44a18a3d6e5300e6ad35ab8737dcdfb9f259e43bcff0c9b6a2d78a9302502010e0420aff8c92133072ed5703a84a5a6f5fe148f02a86b36b2d5876193bd48243cd2f2a08203e3308203df30820366a00302010202086189db18b6ede857300a06082a8648ce3d040303303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d41555354524941301e170d3233303133313038303430325a170d3333303530363038303430325a3054310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d49310f300d060355040513063030343031353119301706035504030c1044532d415553545249412d654d525444308201333081ec06072a8648ce3d02013081e0020101302c06072a8648ce3d0101022100a9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377304404207d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9042026dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b60441048bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997022100a9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7020101034200048893905193f315ee2e2f1eee3fd5a496f6637deb3778cfe7cc2f6c7f0682acc795b0290265a2cb83119343544f2bbfe42974159ac77b113dafbee860c2523c06a382015930820155301d0603551d0e04160414e76eaa567acf6568c660c985717c3c8a50bd024b301f0603551d230418301680142692c7e398abfbe35192d3f26e9a317d1fed53bd301a0603551d1004133011810f32303233303530363038303430325a30160603551d20040f300d300b06092a28000a0102010101303e0603551d1f043730353033a031a02f862d687474703a2f2f7777772e626d692e67762e61742f637363612f63726c2f43534341415553545249412e63726c300e0603551d0f0101ff04040302078030370603551d120430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f30370603551d110430302ea410300e310c300a06035504070c03415554861a687474703a2f2f7777772e626d692e67762e61742f637363612f301d06076781080101060204123010020100310b1301501302415213024944300a06082a8648ce3d040303036700306402303af7ae31ca6b8fafca6ec51985997f7119fb2e6d20d61b5327d5740109aa310b410bfb44f354e086f207fcab721e69ae023046c68fb7909f994350a2d1c84d1ae5dff8c00de6d86b7891a6cf90ceea09159402e6e2ed3fa548db28d33146319eefda318201213082011d020101304b303f310b3009060355040613024154310b3009060355040a0c024756310c300a060355040b0c03424d493115301306035504030c0c435343412d4155535452494102086189db18b6ede857300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3233303331373133343031385a302f06092a864886f70d01090431220420eb5dd19b9688751461b3e61c9c80f1e848d91eec210048aca6653279c7c37c76300c06082a8648ce3d04030205000446304402202567959c119ee15d14520eab1b527c2bc493253d6733bbec30295af57e3ceb070220614dcea3ba92499e2212b9cd4159758cd49ae240e74b3e20d8d49183ed1feb09"),
			expCertChainItems: 2,
		},
		{
			signedDataBytes:   utils.HexToBytes("3082074206092a864886f70d010702a08207333082072f020103310f300d0609608648016503040202050030820147060804007f0007030201a08201390482013531820131300d060804007f00070202020201023012060a04007f000702020302020201020201483012060a04007f0007020204020202010202010d3012060a04007f0007020204060202010202010d301c060904007f000702020302300c060704007f0007010202010d0201483062060904007f0007020201023052300c060704007f0007010202010d03420004614cd88b00821a887869d0060b44a9d18789353e8cf7dfbc3f29f79327de30b97b1b2dda0be77f24ad415c327c7b7ab2e9c10b0258f5bcbf90c01825fbdfdef702010d3062060904007f0007020201023052300c060704007f0007010202010d034200048488a2dc34b6b36d6c01a8dfbd70a874610c53b32893a1de3b1c4bbf477eef3761aa51dfd6b52da43587e95386fc34ffe178d90086a7d646047c82bebc27da3e020148a082049730820493308203f8a003020102020204a8300a06082a8648ce3d0403043041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e79301e170d3233303130343036303434325a170d3333303730343233353935395a305d310b3009060355040613024445311d301b060355040a0c1442756e646573647275636b6572656920476d6248310c300a060355040513033135323121301f06035504030c18446f63756d656e74205369676e65722050617373706f7274308201b53082014d06072a8648ce3d020130820140020101303c06072a8648ce3d01010231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53306404307bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826043004a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c110461041d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c53150231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565020101036200042ca852cb9a1caaaa466256d1cfd678bb7e5d8502dfa6f3fdb287293c32af9fa77ad3a7fa92e56f608110053121354002198b530bc60ac7050ab98d7f6c475fd50706a4a6207d7a6336cb480b966a3aa64894f7f42b8fb4ac4774c9d6892330fba382016430820160301f0603551d23041830168014a40a5fc380ae3e59af1b32d6136aefeec8ca35e8301d0603551d0e04160414af9dd5e6565737a8804b5b4c6f45093d809aa865300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303130343036303434325a810f32303233303730343233353935395a30160603551d20040f300d300b060904007f000703010101302d0603551d1104263024821262756e646573647275636b657265692e6465a40e300c310a300806035504070c014430510603551d12044a30488118637363612d6765726d616e79406273692e62756e642e6465861c68747470733a2f2f7777772e6273692e62756e642e64652f63736361a40e300c310a300806035504070c01443015060767810801010602040a3008020100310313015030300603551d1f042930273025a023a021861f687474703a2f2f7777772e6273692e62756e642e64652f637363615f63726c300a06082a8648ce3d0403040381880030818402404846f4a03e17896e9094af7652c38fe31ec964c2c3a906af813aabef5fe4f3156d140e2ef991dc11fd860a4a301b225de9fd4ed39b4f47ac72cdb88cc63b335902405d4e2895875e603ce2863073bf441d1ec53761cf47e5bc2b9b6bece4f229712e39002d77b555290fa550df5f40aa22d7d2a1e89feb3fef730ae33c937796e8e3318201313082012d02010130473041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e79020204a8300d06096086480165030402020500a05a301706092a864886f70d010903310a060804007f0007030201303f06092a864886f70d010904313204300ff966ab1283d22a0046338b734fbae653622c15fe7538392e0987d87bee0ab009ba77506e45d964b138e688be8da60d300c06082a8648ce3d040303050004663064023025fde09b7f60e9b8f57413427128e6b9ed29c252e396d0f699a84b90247bdbdca66bda66a319423eb1d95d206e6bdae8023016d075859d63301201e925a55accc7d3bc1e4c0457a87f5575821c6345ff1c059deef935e8125ea948baac7a9ef97199"),
			expCertChainItems: 2,
		},
		{
			// DE
			signedDataBytes:   utils.HexToBytes("3082070b06092a864886f70d010702a08206fc308206f8020103310f300d06096086480165030402020500308201120606678108010101a0820106048201023081ff020101300b06096086480165030402023081dc303502010104302daffeb0f67656ae099fd655b32f7dc857c31073df9bc0af8c9cc783fb40cd9c3fe7503e07421f560ecd7a09b6133d4e303502010204302c65a444298e8a7c1fe51ede7f2cdd9b8439597330fe142a1996984f841ed3840ee6fef3475336d29d94012149d9669730350201030430a668251fb0ffdaef79fedbd092a296bd808e79fae546754d0e7f2c9f3f016f23849dd0b7c74a8752dda554412a8542cd303502010e0430c87ab92f21166ae1059b7d7d995dce9cdd3e211aecfb943259d88bb2eb8b533b2b5c780251eb5ad21b0a4a8d8a9ee1a2300e1304303130381306303430303030a082049730820493308203f8a003020102020204a8300a06082a8648ce3d0403043041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e79301e170d3233303130343036303434325a170d3333303730343233353935395a305d310b3009060355040613024445311d301b060355040a0c1442756e646573647275636b6572656920476d6248310c300a060355040513033135323121301f06035504030c18446f63756d656e74205369676e65722050617373706f7274308201b53082014d06072a8648ce3d020130820140020101303c06072a8648ce3d01010231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53306404307bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826043004a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c110461041d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c53150231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565020101036200042ca852cb9a1caaaa466256d1cfd678bb7e5d8502dfa6f3fdb287293c32af9fa77ad3a7fa92e56f608110053121354002198b530bc60ac7050ab98d7f6c475fd50706a4a6207d7a6336cb480b966a3aa64894f7f42b8fb4ac4774c9d6892330fba382016430820160301f0603551d23041830168014a40a5fc380ae3e59af1b32d6136aefeec8ca35e8301d0603551d0e04160414af9dd5e6565737a8804b5b4c6f45093d809aa865300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303130343036303434325a810f32303233303730343233353935395a30160603551d20040f300d300b060904007f000703010101302d0603551d1104263024821262756e646573647275636b657265692e6465a40e300c310a300806035504070c014430510603551d12044a30488118637363612d6765726d616e79406273692e62756e642e6465861c68747470733a2f2f7777772e6273692e62756e642e64652f63736361a40e300c310a300806035504070c01443015060767810801010602040a3008020100310313015030300603551d1f042930273025a023a021861f687474703a2f2f7777772e6273692e62756e642e64652f637363615f63726c300a06082a8648ce3d0403040381880030818402404846f4a03e17896e9094af7652c38fe31ec964c2c3a906af813aabef5fe4f3156d140e2ef991dc11fd860a4a301b225de9fd4ed39b4f47ac72cdb88cc63b335902405d4e2895875e603ce2863073bf441d1ec53761cf47e5bc2b9b6bece4f229712e39002d77b555290fa550df5f40aa22d7d2a1e89feb3fef730ae33c937796e8e33182012f3082012b02010130473041310b3009060355040613024445310d300b060355040a0c0462756e64310c300a060355040b0c036273693115301306035504030c0c637363612d6765726d616e79020204a8300d06096086480165030402020500a058301506092a864886f70d01090331080606678108010101303f06092a864886f70d01090431320430c194cbc52aac7a5077e792739434040cce0c465ddebf366d64eb3ab8ef5bb457cf5c4bd3d28f69804e5507308dcae3e8300c06082a8648ce3d0403030500046630640230403c68550dbc310a8002110ee18aef04e00b119030e0cc3ac8cad347d87f59031af26867f1855b1f1555b7c925b92d8a02307185621cd2cda6051e81627be5a486eb667897440f5bd69f96b8dd43f4f0b0a0cd21df376012dba79d9f7138c2d9b3c7"),
			expCertChainItems: 2,
		},
		{
			// MY
			signedDataBytes:   utils.HexToBytes("3082098a06092a864886f70d010702a082097b30820977020103310f300d06096086480165030402010500308201120606678108010101a0820106048201023081ff020100300d060960864801650304020105003081ea3025020101042070d01631abbf347f1fb7ca0b7e8fe6468b84fae853cb7fab2a2e05ef1519c58c30250201020420470beea11e946390967f3521407a29e258179661d6857e8a7d87a5afe9f23cb4302502010304204aea153d17588f1b22a886762789f911abd3ed9017e2d9a150967c70b6c61036302502010b0420a96b4199a460644233ab19cd648edee9c12c520365084356fb5cbb5f962c9024302502010c04206c00c5168e184d6b94129e79d4fbace2a0b4837b7ae196327cf7a8c567085872302502010e042056139d693f679511a91d67585aac748f0b70ca6e14417c1a73f15f205a03cc14a08205d0308205cc30820400a003020102020869ee7da36620dfab304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232303831363039333731345a170d3238303831343039333731345a30819b311c301a06035504030c134d616c617973696120446f63205369676e657231293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f727431233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310e300c06035504070c054a6f686f72310e300c06035504080c054a6f686f72310b3009060355040613024d5930820122300d06092a864886f70d01010105000382010f003082010a028201010098153deed15a97298a0190224b91725d0dbd872bc78da1e88b0a0acfc4d74904d2438be7ce7a0876cd4b50c0edfd3337c9278e76f1be9c3469c8ca45a786923eb73c044e2940a4dfe8dee5eb5d9ac46a2297d737a13ab6243418ad2ac2642a5858b79c6d494dcd835d9b8f32eae830c330c375530fb9024126fb050e03ba9c2addacfd7e3df1805c00a8d5aa55811f7f5ebe29cd2442c5e4cbc640468bfdd5b660ef5434e1cba0ad713886ba14acc9ffc3eff47d54b063bb97d2ac19eea1c00d5389b61dd8aeb249e010802d9f2923a56aedf54fd86011a07e89882e84b631588b94dafd3f0d638134ec2bf3335e53162ee1d066f4197f4ec1cc37d252c582db0203010001a38201233082011f301d0603551d0e04160414d63a217ed5886cec8406b8b3f161e0d3dc5379e7301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d59533015060767810801010602040a30080201003103130150302b0603551d1004243022800f32303232303831363039333731345a810f32303233303832363039333731345a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020780301c0603551d110415301381116a696d706b6940696d692e676f762e6d79304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181004a8caeeb0558a5c763262b003719e0d4cbc90ff6ed105af2793eac441f4a6cee1b78be1f4488e2439163ff5a708e50189a1a7d7fe6868ef7bb6c1dd1554cc322c94cc4f02ee9058c0a77a2a2aa5261a9f4fdfacf9fa68337aeeedfa33cbcf2a789887c1c7932cd59bb473d6a9c8f999819385d6517a2412696110514ab63a58672ddca1db5654a818b6714692008ec8da37793b759c222534f0d63cbacf6e9e8afe60ef70fe69ee9c83125710392c31dba5ed553b879a5b66fa2119ac4ef37dd43902b70dde59073b97ae5b5a111a7df3fcc3f471aa64927ed4adc8feb3d77036d16cb9a24e6692c0df7b4e4ae66b6b65a0f5caf036b4ecc432ef5326f29fa047a386390136a0f618e114a235a4db556dc9fc28f46553df18f315bcd611e8f790135ca5dbcc4cbc128bbe5b185925825558c67637c3f2f2586ae03b3f82238d9058b083d2aa1ebba422f7aa0344614a4f0c182383889097813f0c4b760b44272b1b387de5c4dda19d03a7f636f9e8843df927e04ac3667db6a3d456cadfd919b31820275308202710201013081ad3081a0310b3009060355040613024d5931233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c6179736961310b300906035504080c0257503112301006035504070c0950757472616a61796131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572020869ee7da36620dfab300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3233303132343036313931345a302f06092a864886f70d010904312204202ce83a982160f9753ea1a0d8d82f59c0ec9e40647d0015a702823143989a7eb6304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201200482010096e3cb962a1d8cf79787783bcaa26cd80d2fed9282f97cd1f4a2a64f9170d459dc71e9d9a6f9a9eb259f0ef0bd064d3e17bc4c7bed1eeb4e8b73615f1335e1eab147f6bdd2d510afd3dc09b9dd36eb27db96a76045fa56acecbc1d4d5ce66df2a10d3ed3a9fb41d7c6d221a4568e74d496410c8c024006c7d6a990b2c5c8193b03f45c8a9fe11c17c9367ce7dc13c7813fe1abc9a79df39182bf76ddd6de44717ea6a5d3abcfb4c1c6e617543afa53d12719671590b4f48cd75e7ce79698237f3c589f7b224215fc11e97d19b0bd40c769898dc0701675dddd0bf129b5bfebda4b68d11a96cd073ace5590f63d1dddc2abd0970e6ea95a04792b1af82cc7195f"),
			expCertChainItems: 2,
		},
		{
			// RU
			signedDataBytes:   utils.HexToBytes("3082057406092a864886f70d010702a0820565308205610201033109300706052b0e03021a3081a70606678108010101a0819c048199308196020100300706052b0e03021a30818730190201010414d827533c7441e5d1b203d38cb33c47938657e87530190201020414e434f427beeb2c72166a981dc4a59d7209a4d8f830190201030414c349debef530d52175ca314da92a44c6c01fd725301902010d0414ed7a89dcdf13764bda04e00179d8c02ae3291e76301902010e041432807180f407b08d05ac998ede91f7f157500741a082034830820344308202eba003020102020200d0300906072a8648ce3d040130818e310b3009060355040613025255310f300d06035504081306527573736961310f300d060355040713064d6f73636f7731173015060355040a130e46535545205354432041746c6173310d300b060355040b1304555a4953311430120603550403130b435343412d527573736961311f301d06092a864886f70d010901161063616d61696c407374636e65742e7275301e170d3139313131333035353135325a170d3331313131303035353135325a308180310b3009060355040613025255310f300d06035504070c064d6f73636f7731123010060355040a0c095354432d41746c6173310d300b060355040b0c04555a4953311c301a06035504030c13446f63756d656e745f5369676e65725f332e33311f301d06092a864886f70d010901161063616d61696c407374636e65742e72753082014b3082010306072a8648ce3d02013081f7020101302c06072a8648ce3d0101022100ffffffff00000001000000000000000000000000ffffffffffffffffffffffff305b0420ffffffff00000001000000000000000000000000fffffffffffffffffffffffc04205ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b031504c49d360886e704936a6678e1139d26b7819f7e900441046b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325510201010342000452e2aa04eed2cfeccf391e81870fef1de3c5089a0e6691c45cece028fdfdfdc6ecbd15c92be84581ed0d9806429cc43e6758d147f6daaf3b0a1cfad2902e0bb7a3523050300e0603551d0f0101ff040403020780301d0603551d0e0416041439d649889fe3dd3c0e81f48961b05b0f6ff6ada5301f0603551d23041830168014850c53f7160e5def64a5677cf7c1849205d2b29c300906072a8648ce3d0401034800304502205f86f3e3545e11ac947423b8b542eb69a1fda07177df071a7597b06306ab4fd2022100c847125abc58cc70d1febe52dc9439c2feb0bf8b98182daf5feea497992cef84318201593082015502010130819530818e310b3009060355040613025255310f300d06035504081306527573736961310f300d060355040713064d6f73636f7731173015060355040a130e46535545205354432041746c6173310d300b060355040b1304555a4953311430120603550403130b435343412d527573736961311f301d06092a864886f70d010901161063616d61696c407374636e65742e7275020200d0300706052b0e03021aa05a301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3230303132323037323135385a302306092a864886f70d01090431160414f4346383db86975f9c6c59f1c3db73a8b78a6b3b300906072a8648ce3d040104483046022100c31abec9e53734a4728fd6017b719badd4474a3682b9bceef591f040f6f074a30221008ae5c38ba1e519f3b1dbcfa62f724ed4603b7c13aaf76f673c0e0e247f1472f2"),
			expCertChainItems: 2,
		},
		{
			// FI
			signedDataBytes:   utils.HexToBytes("3082088806092a864886f70d010702a082087930820875020103310d300b06096086480165030402033082019b0606678108010101a082018f0482018b30820187020101300b06096086480165030402033082016330450201010440a0b15e7466598ae774aec55d6aa596cb2febf044e0f0a90466249672312f733e3b57eeb116e020caaba0361479c6e1f099c8c8ca0aa24a9139811b5c5a3e031f304502010204401cefc2c48091a24631b32208ee8c3dcbd8e8a4c8aad87a4a46b89121a8617447f83bc5fd0c11cccf0423d4fae2c1954d01c16f5cd43c0b44b58e87faf3baef0f304502010304407fb5cc189137a7455068a1755439beeff0a889ee0b2eb8808bb6e08d28ad39e2eb01009cae80869293e770a0e47fd651c2771f5a6b672bd9952ec3e5db59b90d30450201070440b3430bb89d0fac56e6ff2a77350926b19f69ba517f3052324f41c09b687ed6c11a92114ab28a9291f8de4845441dacc3c403deac385b431de79435162495b431304502010e04401755b7a48d3394aa84e9ff977be9eb9e6e0c9001ea19341b57001e1963e7554136ea6bcd72dbd7f4942ec868cdbc313e9ac888b6d715191e5335e0e7f295b00d300e1304303130381306303430303030a082055a30820556308204bba0030201020204009eb12b300a06082a8648ce3d0403043044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e64301e170d3233303733303032303030305a170d3238313033303231353935395a305b313a303806035504030c314943414f20436f6d706c69616e7420446f63756d656e74205369676e657220666f72204964656e746974792043617264733110300e060355040a0c0746696e6c616e64310b300906035504061302464930820238308201af06072a8648ce3d0201308201a2020101304c06072a8648ce3d0101024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f330818404407830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca04403df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f7230481810481aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f8227dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892024100aadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca9006902010103818200047104ced432749be70d31cc2282ea2d76e63495f3c23c79a45d3c8deb2f5742b0cf807f863b772a9485759d921e83d6e561232770e35a4ab875ec774193ab4eed64aa980bae6853e2fde8d4af7a7310fdf6e0bfbf8a1e546b9ae52531143214b0d24461ffc427da7ab4a40c8cff50a19d050d37007289069a67ffa9bee53fdf5ca38201a13082019d301f0603551d23041830168014d69f6ca7f2e0ab2c5afaf19e697268364d31d393301d0603551d0e04160414843719d5e6ebeab022f12ffdfee6cd0e6544f87d300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303233303733303032303030305a810f32303233313033313231353935395a30160603551d20040f300d300b06092a81768405020a0502304f0603551d1204483046a410300e310c300a06035504070c0346494e8116435343412e46696e6c616e6440676f767365632e6669861a687474703a2f2f7777772e706f6c696973692e66692f6373636130320603551d11042b302981156549442e46696e6c616e6440676f767365632e6669a410300e310c300a06035504070c0346494e306a0603551d1f04633061302da02ba0298627687474703a2f2f70726f78792e66696e6569642e66692f63726c2f6373636166696e632e63726c3030a02ea02c862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f46494e2e63726c3015060767810801010602040a30080201003103130149300a06082a8648ce3d04030403818800308184024025f44a41c77bbc747f0dfd2eed410a2adb6bd9ba2feffe733cdb4d323ed5a300541b373be7859435256ced64b9cbdc1688fcce1b774cc3b00d7d5a0370a7c8f6024043f7198e91f5af185009711b93d37b6c7119f4bed0014605a906fc837d96c70055667f55cba632b0af45c0286ac36584b3072d9893a5da7e9a3b0c2357abd384318201623082015e020101304c3044310b30090603550406130246493110300e060355040a0c0746696e6c616e64310c300a060355040b0c0356524b3115301306035504030c0c435343412046696e6c616e640204009eb12b300b0609608648016503040203a068301506092a864886f70d01090331080606678108010101304f06092a864886f70d01090431420440a3d4fc4488ad552d1d9def987ac4f52b7c8dde70158d2cf2bd131feac6e4476d9e33e6ee25a196009e1c72334c81e50bef1182db529ffd71f9b7bd6191643730300a06082a8648ce3d04030404818730818402404fc84f664786dd227ddfe2667108a4c20ac51e5abcb44c9fcd82027cb63eba4f0a62aacc21b41bae84f8a04d5efcf0daedf5e6e4d9cb1e71a8f128b4779a471602406d87171b1513b7c4234704eb2e8520a1b11c76f624ef74f99374a9b099525de2db4a1c13d1b9e8641787411808065b8a7af910f65fe52f0aaffd08f2b533588c"),
			expCertChainItems: 2,
		},
		{
			signedDataBytes:   utils.HexToBytes("3082084e06092a864886f70d010702a082083f3082083b020103310f300d06096086480165030402010500308201100606678108010101a0820104048201003081fd020100300b06096086480165030402013081ea30250201010420c34b96088c91a4b07deec841d55a886b51e1c7afd79f058f42171fa498f95f2430250201020420c2bfb7e9b14ce960fe1ac3b455913624d1e1ed4ab92e6e2d20a69ec986116787302502010c0420022ffd5a0a871ec28947ec940fb279fdbcb4b25ef03465e653bcd3dd5c370a5f302502010d0420fdd73aef84c4f9fc4ab807f2efadbd013452f1ee7200287added53edcc5d2bb7302502010e04203c8134cf5a985863519b68bd8fa5ee2edcad7c375247393e02d84c0dbd7939d3302502010f0420a5ed6c2a093e548a30f0bef91ac4c07d12e5733df252af1e24fced0ece56bf99a0820503308204ff308202e7a003020102020442e57a41300d06092a864886f70d01010b0500306d310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f72747331263024060355040b0c1d4964656e746974792053657276696365732050617373706f7274204341301e170d3137313030313230333935365a170d3238303231323131303030305a307b310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f727473310d300b060355040b0c044d5254443125302306035504030c1c446f63756d656e74205369676e65722032303137313030323030303130820122300d06092a864886f70d01010105000382010f003082010a0282010100c0287bde6240e37aec9741d64947758b2bbbcd58a87429442fa6c14ee6481f94d2a221352e663d4c1eaec896f18c235160d47b548e5b445948c976614d263c6568ea9d08ea504fd930d9775d9ce82a3a834c4efde2d6bab04c499045a3c25dcf29c8e9ba4c58958300c687323066a2ad9ea54c8a23d4aa75dbcaf0ae5cfc8176a94b891ad97c328ca03186c1151d4eb3dcbbcabef8a9f77f50959bfe30891605a7725bf6de59240dd1818c6cbd4b71c9a41c8d0a8c77eca1559b3ca124a09f75bb44178a17e29d5c871da0dc5a50dad2873321fdefe8374abfe41fb0fc2cc2cb4f255aa5fb3d614b18fee3fe3346c8e0f9f73de66348e011a17be8851c59d3250203010001a38198308195300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303137313030313230333935365a810f32303138303231323131303030305a30160603551d20040f300d300b060960842a65826c010101301f0603551d23041830168014f9d6c969fe97d184eef2c1d7e520b66032be3df7301d0603551d0e0416041424757f42b10ee096409789ffad2d9150ecfdc5be300d06092a864886f70d01010b050003820201000d64025fb39bbb1606c76ae6211dd773b0b02675d079ebc3283a8e84c763024471463272b2dc389db2cb282a0931bc57627b9f4fe774ba031c97f371fa9a50fdb0f363fe85786ddacc3e3264317312bc538116d1664a84b641e8260f23dd6b8d5eb42399b2ea944ee20dafaa074cafc9f93febaea4d17c8a2de3200a335ba3260d594a85d85db9c5d2391fb9190f4bf30835d1e9965eb22fb35d7e8380a7bd014f9757e4d4934f548d47e35b878fc2c7dc411c01ea54eb33cb0b91ec88d91b67b45c30b021f6d9a866000a80686047c8365b1b81099fcab5af3642993498bc8b667812872319ed6395c39d4183c21bc1cd7bfe5381479775affa8ce9b2de8347c4623382320bbe4466d700941175a0802ae0182ec882ff26c5351b754270c3129895a58e659690774c5c175b9903a33fb111d10f856f6d452f3d58a9bcbb414cf3017f803e718470007120c65255aefff526a15297b5191a1ebcceb63680039c5b04d08ea739df0628ea109b42f87411553fba2bb4a23f64e012f0c7dfafb5ed7afe7dc474f87a741e01a03a09af84f5e7f5ca15a0114c377f6b0012df83f9e694e839d190658945bf7014fa69e5cc6ae75c96dd3ab98ce636d9ef42a80d5a24ec3d83c6e1195e2efcd63b335dbd32717f71858d50998c383291d530f1bf8d5c7ecf674a1f200f989d2589fb6a634666eeb9e33441abdb060ddf0576420f4d0a31820208308202040201013075306d310b3009060355040613024e5a31223020060355040a0c19476f7665726e6d656e74206f66204e6577205a65616c616e6431123010060355040b0c0950617373706f72747331263024060355040b0c1d4964656e746974792053657276696365732050617373706f7274204341020442e57a41300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3137313131353030333631325a302f06092a864886f70d0109043122042071cb0413dac76278e04bf30a3df13afc0d706e3c95cce1d16250b6ae3694eefd300d06092a864886f70d0101010500048201003593195e884103297dfe628dc10230063bcef6edf13369499ece259ae1f70c1a59cce9f1b444b2f9d12c7c2c877d7be1b81b61a36827862a596853412d1849ca36e6e5de095c7a8d505784955ad321cbccbe7a6f5172bc26e32c9f01c8c5d7cf38cf33aa53a4e174cbc86d5e18a9312a2d5377027a274d002a5ab4f5fedfb3cc5af9eb4b7d6158a8bef16a627be88058342683699e72b3e2f35f5a7e41451d458ae92a6d26da693df4bd4d9d8a498a07323934fb50c9b9bcca013e98e872937ae3875fba6665e3b92cf22f33a1087c5cb655724a1fff183f4be5980e3bc19a46f9656ef81ad2ed6ee3f0e74dc91ec71c1a82fc1db4e1ed8dd5eef9a6361cb849"),
			expCertChainItems: 2,
		},
		{
			// SG
			signedDataBytes:   utils.HexToBytes("308209c106092a864886f70d010702a08209b2308209ae020103310d300b0609608648016503040201308201210606678108010101a0820115048201113082010d020101300b06096086480165030402013081ea30250201010420b8531d522af781ebba2f78465b5beab1fcce2861dd947316a217a0f31f06598330250201020420d2fc98effeaac17d42987c48f310315086fc920054f900002df114a79ff2774b30250201030420883155f3a1ea7948bf4a416625c767ed1f4ed2eaed731f143cc8a22ceabc0cb13025020104042010500f4bc7437f061d4ce735ac0c4f35cf71adb7c5112aaf9b2ccb2c9bd20c3a302502010d0420aded95a855d5c0ac69599f46c4c464ad2aab053798aebe74c69472ff2ffbb0b4302502010e04209cda75e7b4f6168e6586ccd175c0aab3e90f47a68d68e922122937414a90622d300e1304303130381306303430303030a08206603082065c30820410a00302010202045fcdc27c304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035301e170d3232303632373032333934315a170d3332313132373135313232355a305d310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311d301b06035504030c1453472044534331302032303232303632372d303130820122300d06092a864886f70d01010105000382010f003082010a0282010100a695ef6e7174aa7428b351d0106d1b31d0cbc40e2d2feffa6f6def30220648c124856c14006c2b961cff1d81776e3704a00e0bb243cb72f1776b7f6eb917f5a9450c2d1cbb0574add7bb8d75fae7746d6c622cc0a5314bb5812d680077bd45ddf49f58cf7d5d9294cc8045219c8280f8ddde95b529c9f4aaae45150252b5c691c46b78ff58df1f2d7ace90e14e0920b6e4524e87e596e232f6b80d0bcbbeca94edb552e4eaaaca21ae6ae56c0f961836c90e198aed563100b49e1bb93497592b2ce6a61a494cf76219b96fa52675a4fa39c6249fc07665564bec456cdb9217a6fbfa9af2e043968b51e551cf70861e5bfa5493f3ffe40ff937cf5b55e50135e70203010001a38201b7308201b3300e0603551d0f0101ff0404030207803015060767810801010602040a30080201003103130150301b0603551d1204143012a410300e310c300a06035504070c03534750301b0603551d1104143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035310d300b06035504030c0443524c31302b0603551d1004243022800f32303232303632373032333934315a810f32303232313132373135313232355a301f0603551d2304183016801484cd5d8a477755058d4ec97e0d4992322be1c545301d0603551d0e04160414a91a62a686df680a934c0b68032bfaaa100638a6304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010027186e71cb7f33b78fd28565eb886a8224bab30752bde7c53257360c872de2e89318c14f0bbcbe8b34d08463f504c5ad11e5603b71f3d075b00fbed8fb16e9c5f9e95221783f9463c67f78cc3bd80d6eb8b523de1c7ead4c88f4ce3b799a2f60bdc11919ff9a68698686072740f7ab6b60f4958e29c6d7113ba25fec02a1852783068847476dc313889d5df2255097067edc02e97eecbc2b42c8b3072171540320745994c42bf7f3e67e47dc20859c2ba02e722b22568e26bc8429480ec1c95b1f02a14bea48cc51961ac8ddd35702ca814530d4c8125762655125d67ea6b38570d779ebfd6c3c53636cb65b92f4ae27632c7eb15588a537e1619bd3125f7f80cb80e53de0c998afdcf02d07d1fc6de140c462a9c868742bd8fb256cf2f231a3db45d54c407d262b4365a5a84ca4243327a31a792f56ae9376c56fc84e63ffc079e85eec6b866465eed66d95520448d74b09f20e450f4b6b116e85a2bc9c0deaf6dc0063841e49e8c17478e67f28db7451d97af0b82996094808b14a2ad0523d75ecdec9b1e44fdd44d821591439b13ed851ae532fe70447e6504f455fb9d5f7e4fda0736d6c3f5895c6a474cdef2a2213a698e101ffa89d6325c37e0fbabae6dba6064fa33479c7c2055c2b245a609a57de4b254a4eca9da97ecb288510f94be8dcc76520874e76930ffd61afad808374c916e3a08b1f2ef6be8070816109743182020f3082020b02010130683060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203502045fcdc27c300b0609608648016503040201a048301506092a864886f70d01090331080606678108010101302f06092a864886f70d01090431220420f990482cf40e723640e3b80910805150e5f5e461fc94c147fb47524d0055445d304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201200482010038d6b5b0dbdcb5cbe3c196613ef5a7311bf391aea6ded3aacc763af849ae8d166fa627658f051b18fc119e430b9e1578bf6a9ed5cd6978701fb81d26735d623d835233ea8613e0a96226e048a02bcd776742bb5cb4d97008608b140df58f15e0900fbe433c0a370f99d77d057f19fef490297fbd525af0d8d0f4ac64db54489009d68fabd416237b2c90c7e98402ff04daa6cad7d08933a78d26d2fe111643f1b530de43df71ae701ef960b273df6b0b9a664aa01ed4d601a2c2192185e1e8729c386a89ddb47101dde606deefd8f6815d598601fb6943da2bb5b044fa034c770df2529d6379a6d5189328e3c04936833e7bbe9e65dea4ce103d8494efadb04f"),
			expCertChainItems: 2,
		},
		{
			// UK
			signedDataBytes:   utils.HexToBytes("308205f006092a864886f70d010702a08205e1308205dd020103310d300b06096086480165030402013081a80606678108010101a0819d04819a308197020101300b06096086480165030402013075302502010104204bc4557ceb919591ec29a09a7dad569d6f8fd01ca09d1dd9268adec7e81ae33c3025020102042082138f13331d5d689950b7fd60b725639f203d8415877deb89d3c68dc37e3f62302502010e042002be33ba93183907394f3392c80c9a4b07988d79b6ca603e2a3dfb2ba2972411300e1304303130381306303430303030a082041c308204183082039da0030201020204492efae1300a06082a8648ce3d0403023041310b3009060355040613024742310e300c060355040a1305554b4b50413122302006035504031319436f756e747279205369676e696e6720417574686f72697479301e170d3231303230313030303030305a170d3332303630313030303030305a305d310b3009060355040613024742311b3019060355040a1312484d2050617373706f7274204f6666696365310f300d060355040b13064c6f6e646f6e3120301e06035504031317446f63756d656e74205369676e696e67204b6579203332308201333081ec06072a8648ce3d02013081e0020101302c06072a8648ce3d0101022100ffffffff00000001000000000000000000000000ffffffffffffffffffffffff30440420ffffffff00000001000000000000000000000000fffffffffffffffffffffffc04205ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b0441046b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255102010103420004131a1d896c1dc77db755369ef5e04e18e096c93af47f0376d4fda7a3279467a7aeff72af3d6d3ed2cd7e0c8df96a1755b4c7e273ce7be98c96bbdb5647723c14a38201893082018530400603551d11043930378123646f63756d656e742e746563686e6f6c6f677940686d706f2e6773692e676f762e756ba410300e310c300a06035504071303474252302b0603551d1004243022800f32303231303230313030303030305a810f32303231303530343030303030305a300e0603551d0f0101ff04040302078030400603551d1204393037a410300e310c300a060355040713034742528123646f63756d656e742e746563686e6f6c6f677940686d706f2e6773692e676f762e756b3019060767810801010602040e300c02010031071301501302505430670603551d1f0460305e305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f4742522e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f4742522e63726c301f0603551d23041830168014db1d1657c76023089b0139e2613c082134b57ca1301d0603551d0e04160414241401eeffb0d8fe4d7795f04095099ff989324b300a06082a8648ce3d0403020369003066023100807a00c2cecb43217dbc7085ce19e1825a8e779d6817205b4e1cdb9a29126d0db39048db22b4a29aff40121864bc247c023100a84fe4a9e39c283e0737d4a0278d0802ea0f64993157c7b9885ba0edeb2943575c53965e340ee6ecc9277f903491ae3f3181fd3081fa02010130493041310b3009060355040613024742310e300c060355040a1305554b4b50413122302006035504031319436f756e747279205369676e696e6720417574686f726974790204492efae1300b0609608648016503040201a048301506092a864886f70d01090331080606678108010101302f06092a864886f70d0109043122042054ee2228a8ceb8fb50c9c115e0b31592b0fc04c637ac5570e7a3e1ca6ad07864300a06082a8648ce3d0403020447304502200df1170fdd25ef705902a192faab5eeddd1ea0456df09bcc1e3984a5bee1b48e0221009033c37718684ed511c240efa52278d795bc9410a5c2ae9e92b8773346d3d3b6"),
			expCertChainItems: 2,
		},
		{
			// US
			signedDataBytes:   utils.HexToBytes("30820a7306092a864886f70d010702a0820a6430820a60020103310f300d060960864801650304020105003081c20606678108010101a081b70481b43081b1020100300d0609608648016503040201050030819c302502010104203959d386a57e8ce7e582aec8c5651c2003ae7634204503f830573350515256fc302502010204203b03fe8d111c545cf4e556af7364f36731693d5841f539660647190d0420828d302502010b042032dfa16776c6c3cbccd7bbb05c8b4345cc538c62ce630cd11ebcde62a26f029d302502010c0420d9b8686defd4bbaf96520e077c2b35bb98b5add0dc1ea17379fd44b6beb961fda082073f3082073b30820523a00302010202045dcdfde3300d06092a864886f70d01010b05003081a3310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431223020060355040b0c1943657274696669636174696f6e20417574686f72697469657331293027060355040b0c20552e532e204465706172746d656e74206f66205374617465204d525444204341301e170d3231303631303230343033365a170d3336313030323038343634355a308189310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431193017060355040b0c10446f63756d656e74205369676e6572733118301606035504030c0f44532032303231303631303136343130820122300d06092a864886f70d01010105000382010f003082010a0282010100a5a5964e7b8e9d8c623bda63760d1406374026d81f21e34f6b06c6f47774d9df7a0e9d7979ba2c72d4eacc45d1a58a4c5fc20bad8ae23fdc4024c8e53a8acdc2b083ec55b63d44d557e048ed1b843cd2b99c147b350c6fb9b67fd02076bec134c785f4de58a1aa137196d6fb7eefd47a03f25996841345a4daab7754b047dab57e5786d54de5cde5faf553f44de67069f84c2c38e57d0fd13255c814629bafb2c8932ec8e7029d9ec59d640982f89545e30f22036e0bc58e3e8d4ac8e43c3429bdd9bd545ce6ad1045b28d839169060d93af72f59bbfa0687c8a90d12bad51481cc991df9855dd7aa8fa31250b39ab52563b211362f539a47c167ca496fcbd510203010001a382028d30820289300e0603551d0f0101ff040403020780301c0603551d120415301381116d7274646f70734073746174652e676f763015060767810801010602040a300802010031031301503081990603551d1f04819130818e30818ba08188a08185862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5553412e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5553412e63726c862b687474703a2f2f63726c732e706b692e73746174652e676f762f63726c732f55534d52544443412e63726c308201190603551d20048201103082010c30820108060a608648016503020106643081f93081f606082b060105050702023081e9301f1618552e532e204465706172746d656e74206f6620537461746530030201011a81c5546869732070617373706f727420616e6420746865206469676974616c206365727469666963617465206f6e2069747320656d626564646564206368697020617265207468652070726f7065727479206f662074686520555320676f7665726e6d656e742e2020416e7920756e617574686f72697a656420757365206f7220617474656d70746564206368616e6765206f72207472616e736665722069732070726f6869626974656420616e64206d61792062652070756e6973686564206279206c61772e301c0603551d110415301381116d7274646f70734073746174652e676f76302b0603551d1004243022800f32303231303631303230343033365a810f32303231313030353038343634355a301f0603551d23041830168014f18a8bfb6a44a3468334d2d592158158824a4cfb301d0603551d0e04160414bbe9fe4b7cf03921f493096f7cc3e8acbde3a227300d06092a864886f70d01010b050003820201005473c8793fe0dba3bd69864f662cc7277f5ff3181c940714309cdef54896545417b0196599ca534003992ab71f957322257583c13def89954c83d963308b5bfae3598426a70afe74960f18b2085bbae961c209bac961ad3f5542d569191ebe6e352e5483e51c566f949489db849831668e8db2abdfcc2590bcf2b50efe76b9b125b3bf8591cfd6a35d9382a09c67072f5dc40f973a6ddc03f56a423077c086b95bdf629e444188544569c061b5c44183d825297342b9995fda4de15828884f6b767460c785da6c3042b38399210623c75e06bba8c63bf33c9a11ed3805bcc7148bc8313246fc40f55af8ca0ac9307863869ad70a70fd368a7c47b2330e4bfc6d0225279c18240410cec5a4d873dd8e14d4ba80ff58ef93804277dea78b8d331525d26cccf0ffedb6221b9e7aa54438d15a39058bd36857eea6060aa9d3a614f4ce8c217a00af83ee78be646948141d3bd59e5766e337940105da2793b36ace828902a970f78540d8849a48cb43909702afd2edaae82f98d9a9166233944f76d7a92619f48ce4bc085d98209bffbe729d32681e6e6cef92d3b41d9417146f4abef77eba98920cab753c6b88d4d31b1a4d8fc077c2b2615e25fab9f225b0d62024ec6605c69c1ff55009ff131d0f177aa77c6571fe4491bf13ed8c6ff094b157562253d74c7372f63a17e2cc3a8334134608ae9c66cb5e3b85ef4d5494e7276eed318202403082023c0201013081ac3081a3310b300906035504061302555331183016060355040a0c0f552e532e20476f7665726e6d656e74311c301a060355040b0c134465706172746d656e74206f66205374617465310d300b060355040b0c044d52544431223020060355040b0c1943657274696669636174696f6e20417574686f72697469657331293027060355040b0c20552e532e204465706172746d656e74206f66205374617465204d52544420434102045dcdfde3300d06096086480165030402010500a066301506092a864886f70d01090331080606678108010101301c06092a864886f70d010905310f170d3231303931363133343530305a302f06092a864886f70d0109043122042026861d5f7c7699780acaaaa0258e5255217b41a8d9ad797c9716ea755cf0f6cf300d06092a864886f70d0101010500048201003862f39e9140bde1296f4d4a2b007c03f79d8104d931f85e0f1b7ed54ed2c12c2c548bd167b3ca03bf72e82e28b380b0199d30f2bef17543892e2a2c9fa17cfcbd1a2db9900c3052d8c3ab138d870014ecb7efa4a03775f873efb96e995871589981b0a6bf06a2897bc41da92a4d88e3e071cd234aad569e0ebfdcee59f065724f3b7087ec328a6dc17538794b79343a194fb91966f4f615f66c2e5b5605803883a87637323e5e9d10d0497e9184c80a6d7cfad0d77fea773b487b7a44115650b73241f5af1ae7eb7d90882c65febdd9ce183c93b6589f521a948c5e3994bfe09266c95e0bd9dde4b297b2613b6ff75d52087c112aa8291c3d2ad7f3e5a39233"),
			expCertChainItems: 2,
		},
		{
			// FR
			signedDataBytes:   utils.HexToBytes("308208D806092A864886F70D010702A08208C9308208C5020103310F300D06096086480165030402010500308201390606678108010101A082012D0482012930820125020100300B060960864801650304020130820111302502010104201F051BB4DE4D11123032FC134E56DE616379600A5805F24A3177937D685D531130250201020420A1BE4D97F7E189C994B181A3535F7738070FD3B4ADB1930B8C74852E7705506430250201030420E63A42B76DDA40B3D5456E79D7B89818FD0749A994D301C13BAAF255BB942DE4302502010B0420CB3CDD6785B15A2670C6FBBE6886B0E5713DDE17257A484287FE762BE9AA56B1302502010C04204134C2D26F86DA0EB7FB20B09175533B6CC17AAD0F927780CE93EDDC03CBE7BF302502010D04201B07454AE132F3218A2318280F38FED86472FA9461736D53E7CCFB5E2A2AD94A302502010E042090BD82AFE645D8A66FBBF1BC656B9FD548584841C4D583322BE93D4282CF1648A08205913082058D30820375A00302010202121121A518DFA6CEFF481E5299E4F27FC32A77300D06092A864886F70D01010B05003032310B3009060355040613024652310D300B060355040A0C04476F75763114301206035504030C0B435343412D4652414E4345301E170D3137303731383133353631315A170D3237313031383133353631315A3062310B3009060355040613024652310D300B060355040A0C04476F757631183016060355040B0C0F446F63756D656E74205369676E65723110300E06035504030C0748534D2D445332311830160603550405130F32303137303731383133353535353030820122300D06092A864886F70D01010105000382010F003082010A0282010100B4143A881C02F40EA4BCDA99FD9F0905DEBB388E515F250E9C478EAC8AA785498BCA51EB0348A2D81AE4589E919137F08295976AF87566195C023A6F24CF11769096815FB72EFC53D8B08ED20A245369291BA2A2BF75271E6751026C32AC278BAD72F1FF2D1183F30967C638D7A2F5F79A9D05CE35A7F9280C0FC97839461408EB8270773243DD7C53AC7D8976C361B713E3659B2B5E08BFE286C649A5D6BDEC873685E115C379E9B16EA00B8401FA0D89F63F07E585908F91AE0A6292FB44D8CE4180F2390D2A564160F033B2336F4F52F15ADA3D23C3127073A534525F39D4DFB1325BB85F32C8A2379E5D49D642B760D15A4F831D39EA06A2870E642492130203010001A382016B3082016730400603551D20043930373035060A2A817A01811F010101023027302506082B06010505070201161968747470733A2F2F616E74732E676F75762E66722F63736361300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303137303731383133353631315A810F32303137313031383133353631315A30240603551D11041D301B861968747470733A2F2F616E74732E676F75762E66722F6373636130360603551D12042F302D861968747470733A2F2F616E74732E676F75762E66722F63736361A410300E310C300A06035504071303465241302D0603551D1F042630243022A020A01E861C687474703A2F2F616E74732E676F75762E66722F637363615F63726C3019060767810801010602040E300C020100310713015013024952301D0603551D0E04160414638FAC8C6A37001F891ABC14849CFC9C33B79C79301F0603551D230418301680140FCC3251E4E92A50658CAF6A6871BC9E8FC86D59300D06092A864886F70D01010B050003820201002EAEE32DFC4C6ED066494F07CE38859AE36ECC03E35B6E453B74A34895BCEBEAA41C1749E2E537461B6EA425E3BC4EC60EFE8D0FAFCF1824A30E4620D06E030F99625F550F28C7E4E47C057318FC3A30D239FFB244C39A489A45E2FCE59DC8231D4F882F98743D8D55BE48686BE68D80C68A08799690FD75C1067BFB0ED81946B7073EDAF7E80868D21A773FB3FD1DC14E2523E05504200AD8CF88C6AFCA42F7725B8519809C3085440B5B6DF32C51A5EFA2B35F6E2ECB77BD8468C08AA30AACD2D81365869D53B8576372DCB7607CD8F09D1067A6C8CDF3F783C8E67A29571E34E896CAEF7C3C623D0CD2C415F7D9601B61CE26B78A934B6938057440A77378D604D56C9800F0DEC1CC065782C6DF6B525058E06577C0B494EAF0CED8A36C1B42766308BFAF5576315810D2F60CAE0DC4701AB8A816B4E310AB520B088F26B88C2090579FF318E470E4F3A035F65F04871AE2D840D4FC663920ACC8D4944CE6AC3800D6C4AE2143A74E28BC684197719AA77A42AF86F4B0291D7A574B7374C923ECAF0810A8574FC2A4BFD2C0CE30AF2DC69C5CC5AFEEF86A83DF27F3AB83395B4ED456D5597296E6953E13AD364169F3AF1097C4B9F8C182292F1B0548E35ECFA2030A8AA20E239701F4349AAE064F4CDCF4063CA14FBEE9BDF287D76B82DC42C1C36544A6E0EF625A64DC56192F058FDC84D51257168E0F5C8A802C66C14E318201DB308201D702010130483032310B3009060355040613024652310D300B060355040A0C04476F75763114301206035504030C0B435343412D4652414E434502121121A518DFA6CEFF481E5299E4F27FC32A77300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3137303930353230343133335A302F06092A864886F70D01090431220420C408252F859EDE997D5705EC2A35BABCEAE746CFD7CC56A871A16820DBDF3CEF300D06092A864886F70D01010B05000482010023EE15FE1CA02C31A6FADA3373BDE90A44946BAB5B43EF721CCDEC15F8FDEA3663347445142F34C17E0F82FA1C12D00AF597B6427A2A5F9ADBCAC2EC0B3B4F54A74B61F1F6B303276C43644ED4C1BBCC5D2D88CD873216C390BD0DA9079432CD9C00ADAA593A2131C44D4C3EA85901B716E48854DC00F71995CFA7E6A58AFF57E35A6FF258619CAB546E6275B82BCFB420ED0B038D0C32A8A494FDC012BED1ECCD6229B0FEE8936EB82769520D17A8DB55A69A27876ACEF7DD186AEFF425D86E2C0D2BE1DAA111EEACC44CDB966EB82F996F9B7925CE42896EB2597C5CB78D600E7232CA957BADDB25393000DE295547E2B8F2E1749A924290C42795E02BBAA5"),
			expCertChainItems: 2,
		},
		{
			// error case: missing signedInfo
			signedDataBytes:   utils.HexToBytes("308206FB06092A864886F70D010702A08206EC308206e8020103310f300d06096086480165030402010500308201390606678108010101a082012d0482012930820125020100300b060960864801650304020130820111302502010104201f051bb4de4d11123032fc134e56de616379600a5805f24a3177937d685d531130250201020420a1be4d97f7e189c994b181a3535f7738070fd3b4adb1930b8c74852e7705506430250201030420e63a42b76dda40b3d5456e79d7b89818fd0749a994d301c13baaf255bb942de4302502010b0420cb3cdd6785b15a2670c6fbbe6886b0e5713dde17257a484287fe762be9aa56b1302502010c04204134c2d26f86da0eb7fb20b09175533b6cc17aad0f927780ce93eddc03cbe7bf302502010d04201b07454ae132f3218a2318280f38fed86472fa9461736d53e7ccfb5e2a2ad94a302502010e042090bd82afe645d8a66fbbf1bc656b9fd548584841c4d583322be93d4282cf1648a08205913082058d30820375a00302010202121121a518dfa6ceff481e5299e4f27fc32a77300d06092a864886f70d01010b05003032310b3009060355040613024652310d300b060355040a0c04476f75763114301206035504030c0b435343412d4652414e4345301e170d3137303731383133353631315a170d3237313031383133353631315a3062310b3009060355040613024652310d300b060355040a0c04476f757631183016060355040b0c0f446f63756d656e74205369676e65723110300e06035504030c0748534d2d445332311830160603550405130f32303137303731383133353535353030820122300d06092a864886f70d01010105000382010f003082010a0282010100b4143a881c02f40ea4bcda99fd9f0905debb388e515f250e9c478eac8aa785498bca51eb0348a2d81ae4589e919137f08295976af87566195c023a6f24cf11769096815fb72efc53d8b08ed20a245369291ba2a2bf75271e6751026c32ac278bad72f1ff2d1183f30967c638d7a2f5f79a9d05ce35a7f9280c0fc97839461408eb8270773243dd7c53ac7d8976c361b713e3659b2b5e08bfe286c649a5d6bdec873685e115c379e9b16ea00b8401fa0d89f63f07e585908f91ae0a6292fb44d8ce4180f2390d2a564160f033b2336f4f52f15ada3d23c3127073a534525f39d4dfb1325bb85f32c8a2379e5d49d642b760d15a4f831d39ea06a2870e642492130203010001a382016b3082016730400603551d20043930373035060a2a817a01811f010101023027302506082b06010505070201161968747470733a2f2f616e74732e676f75762e66722f63736361300e0603551d0f0101ff040403020780302b0603551d1004243022800f32303137303731383133353631315a810f32303137313031383133353631315a30240603551d11041d301b861968747470733a2f2f616e74732e676f75762e66722f6373636130360603551d12042f302d861968747470733a2f2f616e74732e676f75762e66722f63736361a410300e310c300a06035504071303465241302d0603551d1f042630243022a020a01e861c687474703a2f2f616e74732e676f75762e66722f637363615f63726c3019060767810801010602040e300c020100310713015013024952301d0603551d0e04160414638fac8c6a37001f891abc14849cfc9c33b79c79301f0603551d230418301680140fcc3251e4e92a50658caf6a6871bc9e8fc86d59300d06092a864886f70d01010b050003820201002eaee32dfc4c6ed066494f07ce38859ae36ecc03e35b6e453b74a34895bcebeaa41c1749e2e537461b6ea425e3bc4ec60efe8d0fafcf1824a30e4620d06e030f99625f550f28c7e4e47c057318fc3a30d239ffb244c39a489a45e2fce59dc8231d4f882f98743d8d55be48686be68d80c68a08799690fd75c1067bfb0ed81946b7073edaf7e80868d21a773fb3fd1dc14e2523e05504200ad8cf88c6afca42f7725b8519809c3085440b5b6df32c51a5efa2b35f6e2ecb77bd8468c08aa30aacd2d81365869d53b8576372dcb7607cd8f09d1067a6c8cdf3f783c8e67a29571e34e896caef7c3c623d0cd2c415f7d9601b61ce26b78a934b6938057440a77378d604d56c9800f0dec1cc065782c6df6b525058e06577c0b494eaf0ced8a36c1b42766308bfaf5576315810d2f60cae0dc4701ab8a816b4e310ab520b088f26b88c2090579ff318e470e4f3a035f65f04871ae2d840d4fc663920acc8d4944ce6ac3800d6c4ae2143a74e28bc684197719aa77a42af86f4b0291d7a574b7374c923ecaf0810a8574fc2a4bfd2c0ce30af2dc69c5cc5afeef86a83df27f3ab83395b4ed456d5597296e6953e13ad364169f3af1097c4b9f8c182292f1b0548e35ecfa2030a8aa20e239701f4349aae064f4cdcf4063ca14fbee9bdf287d76b82dc42c1c36544a6e0ef625a64dc56192f058fdc84d51257168e0f5c8a802c66c14e3100"),
			expError:          true,
			expCertChainItems: 0,
			// NB test was modelled on a manually modified version of this data (FR):
			// 308208D806092A864886F70D010702A08208C9308208C5020103310F300D06096086480165030402010500308201390606678108010101A082012D0482012930820125020100300B060960864801650304020130820111302502010104201F051BB4DE4D11123032FC134E56DE616379600A5805F24A3177937D685D531130250201020420A1BE4D97F7E189C994B181A3535F7738070FD3B4ADB1930B8C74852E7705506430250201030420E63A42B76DDA40B3D5456E79D7B89818FD0749A994D301C13BAAF255BB942DE4302502010B0420CB3CDD6785B15A2670C6FBBE6886B0E5713DDE17257A484287FE762BE9AA56B1302502010C04204134C2D26F86DA0EB7FB20B09175533B6CC17AAD0F927780CE93EDDC03CBE7BF302502010D04201B07454AE132F3218A2318280F38FED86472FA9461736D53E7CCFB5E2A2AD94A302502010E042090BD82AFE645D8A66FBBF1BC656B9FD548584841C4D583322BE93D4282CF1648A08205913082058D30820375A00302010202121121A518DFA6CEFF481E5299E4F27FC32A77300D06092A864886F70D01010B05003032310B3009060355040613024652310D300B060355040A0C04476F75763114301206035504030C0B435343412D4652414E4345301E170D3137303731383133353631315A170D3237313031383133353631315A3062310B3009060355040613024652310D300B060355040A0C04476F757631183016060355040B0C0F446F63756D656E74205369676E65723110300E06035504030C0748534D2D445332311830160603550405130F32303137303731383133353535353030820122300D06092A864886F70D01010105000382010F003082010A0282010100B4143A881C02F40EA4BCDA99FD9F0905DEBB388E515F250E9C478EAC8AA785498BCA51EB0348A2D81AE4589E919137F08295976AF87566195C023A6F24CF11769096815FB72EFC53D8B08ED20A245369291BA2A2BF75271E6751026C32AC278BAD72F1FF2D1183F30967C638D7A2F5F79A9D05CE35A7F9280C0FC97839461408EB8270773243DD7C53AC7D8976C361B713E3659B2B5E08BFE286C649A5D6BDEC873685E115C379E9B16EA00B8401FA0D89F63F07E585908F91AE0A6292FB44D8CE4180F2390D2A564160F033B2336F4F52F15ADA3D23C3127073A534525F39D4DFB1325BB85F32C8A2379E5D49D642B760D15A4F831D39EA06A2870E642492130203010001A382016B3082016730400603551D20043930373035060A2A817A01811F010101023027302506082B06010505070201161968747470733A2F2F616E74732E676F75762E66722F63736361300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303137303731383133353631315A810F32303137313031383133353631315A30240603551D11041D301B861968747470733A2F2F616E74732E676F75762E66722F6373636130360603551D12042F302D861968747470733A2F2F616E74732E676F75762E66722F63736361A410300E310C300A06035504071303465241302D0603551D1F042630243022A020A01E861C687474703A2F2F616E74732E676F75762E66722F637363615F63726C3019060767810801010602040E300C020100310713015013024952301D0603551D0E04160414638FAC8C6A37001F891ABC14849CFC9C33B79C79301F0603551D230418301680140FCC3251E4E92A50658CAF6A6871BC9E8FC86D59300D06092A864886F70D01010B050003820201002EAEE32DFC4C6ED066494F07CE38859AE36ECC03E35B6E453B74A34895BCEBEAA41C1749E2E537461B6EA425E3BC4EC60EFE8D0FAFCF1824A30E4620D06E030F99625F550F28C7E4E47C057318FC3A30D239FFB244C39A489A45E2FCE59DC8231D4F882F98743D8D55BE48686BE68D80C68A08799690FD75C1067BFB0ED81946B7073EDAF7E80868D21A773FB3FD1DC14E2523E05504200AD8CF88C6AFCA42F7725B8519809C3085440B5B6DF32C51A5EFA2B35F6E2ECB77BD8468C08AA30AACD2D81365869D53B8576372DCB7607CD8F09D1067A6C8CDF3F783C8E67A29571E34E896CAEF7C3C623D0CD2C415F7D9601B61CE26B78A934B6938057440A77378D604D56C9800F0DEC1CC065782C6DF6B525058E06577C0B494EAF0CED8A36C1B42766308BFAF5576315810D2F60CAE0DC4701AB8A816B4E310AB520B088F26B88C2090579FF318E470E4F3A035F65F04871AE2D840D4FC663920ACC8D4944CE6AC3800D6C4AE2143A74E28BC684197719AA77A42AF86F4B0291D7A574B7374C923ECAF0810A8574FC2A4BFD2C0CE30AF2DC69C5CC5AFEEF86A83DF27F3AB83395B4ED456D5597296E6953E13AD364169F3AF1097C4B9F8C182292F1B0548E35ECFA2030A8AA20E239701F4349AAE064F4CDCF4063CA14FBEE9BDF287D76B82DC42C1C36544A6E0EF625A64DC56192F058FDC84D51257168E0F5C8A802C66C14E318201DB308201D702010130483032310B3009060355040613024652310D300B060355040A0C04476F75763114301206035504030C0B435343412D4652414E434502121121A518DFA6CEFF481E5299E4F27FC32A77300D06096086480165030402010500A066301506092A864886F70D01090331080606678108010101301C06092A864886F70D010905310F170D3137303930353230343133335A302F06092A864886F70D01090431220420C408252F859EDE997D5705EC2A35BABCEAE746CFD7CC56A871A16820DBDF3CEF300D06092A864886F70D01010B05000482010023EE15FE1CA02C31A6FADA3373BDE90A44946BAB5B43EF721CCDEC15F8FDEA3663347445142F34C17E0F82FA1C12D00AF597B6427A2A5F9ADBCAC2EC0B3B4F54A74B61F1F6B303276C43644ED4C1BBCC5D2D88CD873216C390BD0DA9079432CD9C00ADAA593A2131C44D4C3EA85901B716E48854DC00F71995CFA7E6A58AFF57E35A6FF258619CAB546E6275B82BCFB420ED0B038D0C32A8A494FDC012BED1ECCD6229B0FEE8936EB82769520D17A8DB55A69A27876ACEF7DD186AEFF425D86E2C0D2BE1DAA111EEACC44CDB966EB82F996F9B7925CE42896EB2597C5CB78D600E7232CA957BADDB25393000DE295547E2B8F2E1749A924290C42795E02BBAA5
			// * signed-info entry was manually removed, leaving a valid record, but without any signedInfo objects inside it
		},
	}
	for _, tc := range testCases {
		var err error
		var sd *SignedData

		sd, err = ParseSignedData(tc.signedDataBytes)
		if err != nil {
			t.Errorf("Unexpected error: %s", err)
			// TODO - use t.Fatal then no need for 'else'
		} else {
			certChain, err := sd.Verify(cscaCertPool)

			if tc.expError {
				if err == nil {
					t.Errorf("Expected error")
				}
			} else {
				if err != nil {
					t.Errorf("Unexpected error: %s", err)
				}
			}

			if len(certChain) != tc.expCertChainItems {
				t.Errorf("CertChain length incorrect (exp:%d, act:%d)", tc.expCertChainItems, len(certChain))
			}
		}
	}
}
