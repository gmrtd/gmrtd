package cms

import (
	"testing"

	"github.com/gmrtd/gmrtd/utils"
)

/*
* SG
* ski: 32b2241e7442df02964b07bcefa099f82820ec91
* cert: 308206ee308204d6a003020102020456a727af300d06092a864886f70d01010b0500305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341301e170d3136303132363037333130345a170d3331303132363038303130345a305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f727420434130820222300d06092a864886f70d01010105000382020f003082020a0282020100d343042eb4f144e83e31ae7af01870ec3d38b3a48625921796aee3d1d69d123064a8d325f963ee01f12a9cd175478269fdec892c46ad6e329efb0eee468fc054a9f9443ee875195ad2b79b45a34104ea254ddbedde35259c5bb51d59a65d3c852cd975b452a19c5eb93ee7d209019976efa587f0a474763ab79da67c716c09a2f7a5ace2080070b62f5b49db62fbd1ee02b0db84278ef338ba3ab3ca4b9215aee0116082c9d777b11ff37e1a1393d3a0267db2f612500763f4b97d2d0a704aad8b0b272fc503b10fe108a1fa356be0857f14af52f050af2d9b73476033de788a066c436fe767487c97260f1c3f543887bbb074678c55a59a344109430e2829eac7a5e356c0679ef1e4a55451e400cf19a762860ac45b7b786a9f16ef0b952912d4eb2ae0d5245ee377be43b4499785738f59ef629c9613bee13fad0f88933b08698eee0b271cbc7c6a5f78b739433c136fc90a697530af56aab6a7f3f41c3ee5ad7a3c67cc98402f4e67b37f2b3f3f1d900758bf1bae6d29c7c4ae3cdab427eab5e771b3afe59dae57d1d756389ad6cde1721f6d179b10526aa43b98609052e7714f025270afdd178fef12b42ebae39c78ee81599c55209b87c26d12693f9c09123cb56f2806c5df30d30c38875da17e53437218d8fa05101d0cb91d5928a137b65a90138e2f482d25720ae350e86b7f260aaa1f1137c71c31a6b51d194038050203010001a38201b2308201ae300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e00603551d1f0481d83081d5305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3075a073a071a46f306d310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341310d300b06035504030c0443524c31302b0603551d1004243022800f32303136303132363037333130345a810f32303231303831343133303130345a301f0603551d2304183016801432b2241e7442df02964b07bcefa099f82820ec91301d0603551d0e0416041432b2241e7442df02964b07bcefa099f82820ec91300d06092a864886f70d01010b05000382020100947478443af054390a24133fde00ebce292e02c4bb6092f80e97be366c906b83587350abd9445d4e7f344efdfb4033f42025e729d4488f5608daeadfa480db771537c13e7636a63baf9cf94ad10bb754b0a7b8401479006c5e28449e1114a2d2e5741d430a474bce462c28fe44a051f458d2ce8adefa2a66b5d3832b7b654f2701b33d5287c633a790c22259b7e9c6a65425cb456d29ea3ed6b8b5ab1692c51e60ffa62f77b063922128804f61c577e646e06ed479a2914f57b7ea6c7b70b522c14fcf5dd16e79ccfff93e1225b703b46f908d36da820bc5192475ea940b29a5293dec8b34947b610c0b14e47dce0d2447fdad6900028bf07575786c2618247c63b2b7cea340f21d086d661aa2b1bef427ee80b9e8b24dcd8ce1182da5e7349abf4772e464c66095021d14b91bb980cbd14d11f6f19bb89b0070aa34f27a6c622e66d16675505255aeee9be97d0df745184c1601c63b2f9d3ac1ed597b4d44343f0b927968099f857f0486701a9cc1cc3b180f841e4b4a329ce8bed8209d09929458276305dabd6d02251dfc565faa9b2650f038f6a6c6183c71b776b9939a9ce67e89e19de2838cbce6d53da944d5e26c916cdfc5b22553b44a0c12070b82cafade824a3ee693597144c2c3a9ac4bc003939a7b4274c98ae35fed86894e1af805416f33513d09728b4ad924756ee76a318cbadebc0d4b397e929303759b50f7
*
* SG
* ski: 3a4d8de8fe2407a702bb9f7a320313098a2d4a8d
* cert: 3082075c30820510a003020102020458eca0f1304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034301e170d3137303431313038353531365a170d3332303431313039323531365a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203430820222300d06092a864886f70d01010105000382020f003082020a0282020100920cc062319f782cc4d09ce256f369e867f97dc4625de13a0a807960780f6ce4a0d06b960801cf2494601bc56c94c094bf75e02b056d58e35eeab931b7c900e8afe304ec686b403905813a9c10dba4e73072ab6ef0ad3bc33b8ca384de14d6a4fdeadbb7d2e9307028546ac6e130a65e8c03573f53d97181ce4716e348623cc1031c6f33f983a0a750e675066542e7e377cb77df5224003647e2592c391053522af5dba45617a740d84f72b2d103b41666c69bc365c417316d1c84912c6c581a3c07b44f3c7dc7ec81cecb78ef0513f3981eae76a468febbf0d12c18c621d03ce2410afb85413786b405fd4e283c103003db974b1d947b5e9cfb51d74564e7521148b56faa79a09d0eeba8afc4fc57ff9ca3c239e542cdbb848f9e2ca614cf432fc539a1190b99e89ffa09a2f73c14a22a651f84710d4dd36647b66498c79e105f60b2f79aff6a4d44036b2b7f28956a8ad60e62126b7a83a28e4092e8ef352f1feeb7aed7c57405a150ccb92cd4b0298d000362897a7e0c5ba166cfbcb4176a7eb8a3833aff35635700c1bd9114fd39bc2f81add7d3efee7f25d4e83fee2cf0b84a3e7ab7d355b96974ec01c6165ffa1016edd0636014a6119f9315dcf0319bccc5e3b1b83c3bb8e437fb241aa7bbf74f8282009fbd8179ac0291e770cd27c3568c4a0af9e2dee3cdd45ee166585b994cbe99b288f0e720698c894615a218a30203010001a38201b4308201b0300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034310d300b06035504030c0443524c31302b0603551d1004243022800f32303137303431313038353531365a810f32303232313032393134323531365a301f0603551d230418301680143a4d8de8fe2407a702bb9f7a320313098a2d4a8d301d0603551d0e041604143a4d8de8fe2407a702bb9f7a320313098a2d4a8d304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010032004a14d56338d55e82c6c844157acafab31a39731b7a9eeb723c1f483cb3282073642bab5604fc53b2aeb85dcbd04fbb028f52d29c316d843edf57fda88d00254e97d9e055415233f794489aa9a8868c769664c3d4f7c6ca53715f1c4154fb2e721c750f06bf36d464fa157d07305a7f47d986c7eb71194668736971377ea834168802267cc7b33b175830ac016102f8a6c3abc1b44349ecf90b38b339ff47d6589462df9bd3b2b5d4ba8e16f25fa306e436059470bbc97aa52fc7f17ef5dffd6377e5a13cad45d7b79459cb00f5a459cd6dd30a8022bfab01dd49db3b4dd96d7a8c144db2e73ab6dc7b32416f590300533825dd7d321ddbcd086f8feaff64a6cd78a8e32e94b2fa53b44d6d305a3798ceb5f49b650daf24adaddb3c9dc686efdab9236b2062856f0abf4acc577d7f3a5beec29099c266d86af5d3267186ea14c5d486532ef50814452bc348930b0a396c71f1d2f1d718ebc8948a7d91544a8a5bb9a4617a35de2868ddee8ceef18d477cff628b60f1f466b1cffabfbbcf6ceb3b590f0d306a4a382895ce66de9369562817edaaa00c6e17c356a038f2f82ec228a34a43fb6bae542feed6d294a0b21d0801cbdb25416572f1a5832ccdb538ff72eec92ab09f0f38163dd9bc0f7afd5e82cd7812eb71f9a6c82f7d093d68d33cc47805d33e32e4695dd5cc481391d8c66338727a1601fe033745d1906c52bb
*
* SG
* ski: 84cd5d8a477755058d4ec97e0d4992322be1c545
* cert: 3082075c30820510a00302010202045fcd850b304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035301e170d3230313230373030353734315a170d3335313230373031323734315a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203530820222300d06092a864886f70d01010105000382020f003082020a0282020100b687b2fa93ffce2c110051857a65fd68ce3960a260c462af3e9bfa6f269f5ab8965d38cb22ba7f35471ca4b33e7904e183c594d4b9e84c74c04821cf528c3fa83bb6a3f4c0c317e4c95a5acc5339b4c4dd9db8eceb64db29fb88f96525ebde38e48ebe40ffa95b842f16a721e5bae8327d9545e9dc0bd143df441f6f4ed672b1711c6b20e0d266a9866c50eb172ac5dd4530969038d955a7b87bc7656395ddd670c1392672eba4f05e9dc36b563ab3fba1bad9de0ff2df8b1deb562c0ccfe88579d7318e2a6342e6dba73b716c32c830a1f7476b36f80b2dad1f0ce27c9a00610cf4d7f213f35796fc6b26c336fef1db2143dc196c02fde859239dee0bdd459aacd0481ffef9eb1a6d9f52699d570289e3fd2da753195836b2fe51a827ff8ea497059faa496b36831e5554f8f306e835b086e0b7ad30afc1e55d6a15fc1036cf6b54042320747ab7d6d5fc86113937297227758c7cebf21f3827acce909026ceb4ab4d16e065e3bd82dab7ee40abaab58085c96c5f1d19bc16a94b23bf8c0572b7d88b8a4a21a0ae77a231b0bbdaf40d5205e33161a4d8b8722c308d6a565f34f38b50ff84bda8f9ee9f0e584ceac279aa337fbddb9c9b1069a7304955422da53ae35dd72ea2d7827864a698c0980a322b59ba6a4a00dbd115a2f663fafd89413b02f416130875c6bc8e3da4b8bb49c1b6ecfefc1fa2d965fc9e38abd47542030203010001a38201b4308201b0300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035310d300b06035504030c0443524c31302b0603551d1004243022800f32303230313230373030353734315a810f32303236303632353232303630355a301f0603551d2304183016801484cd5d8a477755058d4ec97e0d4992322be1c545301d0603551d0e0416041484cd5d8a477755058d4ec97e0d4992322be1c545304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010061f578df00b83120fba10cc7b2a63a120ee98248d788592b8b495dda3951acdc86597b9da3e0ad4650184261f4d51c283a55b2633ae27c76589f65f107279b8494ff7b2bdb026bb0d3e74fbcf6af66943911f8473d1ef53985adda48ec96bf57654a347b40f6c66d6f479aafdca863a15bb64b3e3b6de6765942d7985dd9dca81a3e11722e3463ddde0cc42104f6b83164189698b5b1f5143530f0dc56d91678a98ab4b1b243a7fb398a12d792d98a0e08d9b493a6720ba69181da3532e15ebb32a24457c9b58f19b2dfeb29ff5184d154d9e4880b2e3c70c44bc06294a52e61255a335dcc649a2d6e70af9d49bc3a5f15ff59332c5b13979fb34903771377308779c3b16c8698538ccfa97cc3588e9397ca89dd9e15ee6f12a0f352c788ab56c040362d2346139853df252fc401c28b87e1f60eaf5e9bb21fc992f0934066a36c8aaf41c43e8a987ab97a3f1bf271d394662058f7f0d2fcfb537e6a2859df4fd904f41c75e31ba6dd2b8c79a662c96e8685c24b9d935bc638ccf56bfc42419f12bfa73b8f5c872bd630ff9623950e1604e0225b9a453fb7785d2b06e94b0feee57bd9bca03d82f094eec4c6ae366a50b32fb6247bd874a24af3ee221d7bcfddda9fd6cae5c8c7a3fa5a6d3808664c3bf700c04be9c0dcfd3f4b4e457127914b34b4c458dd7a94020ef08f43cdd6c3f3c4ed08dd7c137eb2a065f95e49de499d
 */

/*
* MY
* ski: d54dcf907ed448d2f40e059a3932b4660c9ec2db
* cert: 3082066030820494a00302010202083c99dfd4c3f358e8304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3139303732363131303534355a170d3239303732333131303534355a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a0282018100db239b51311a1f69c5b920d49206e21a4124ee424e2321f2f46088cef957980cdfcf1e44433b9cc611f484b7328dea3dfe75874d46dc7659b2a0c866aca5420b32b7db7becccb5f912fc801e00e09e8752164ea64f14fe8fe9cef2ab55c5fc6ebe80c272bf4be881ba5dfd874eef8a357bba2bf62674e24a688b206799b6bf123f96159659250edbd9402d0975355228c2e6670e9bcc40a81b85e157172e8d5a89abd2808664cd30ce4579802a18ae0fe53304e9352733d1ed4c726733d2e91efba5d51ac8f490c81b5419a8b21042da9f61e54cdef133a6e7ac7a59502e1706010b86eda36ac70d00d933b2ae214be0bd2741da0c39457a05952a1ed789d53f7d10c54a95085f38818f9ab8bcdf7c13b39f0efdf3eaba2cdae94f603f07753ab12a792541fa8fef37299af35ca4ab3115b01d9dbd733486aa0de86b88048dc8aa85892e18b3816be3ba4461adab881662049fc0be17ed3a1ece887ca408cd2abd1547cbf5f89cbc923d562660d48df541664b0334edbc3fd59ef9242c6beaf10203010001a38201323082012e301d0603551d0e04160414d54dcf907ed448d2f40e059a3932b4660c9ec2db30120603551d130101ff040830060101ff020100301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303139303732363131303534355a810f32303234303732343131303534355a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038201810043aa8bb4d713ed1ed41d8b935878910df7d5a5918a8f3f9335be154ba93b1f40f0fbcc278dd20bdd37c917f794041a929cba38cd6c19621fa3120d6c22661672232c2f23c43871d2c42c9e691f8f338e4b8587df5aadea8787a4117ff568929361228940dd74d851d819c46db28286ac56bf927e22a103d8985a8366249206807f0ffbdcf8124983f3d12070bf983301536b4cc211b5f3cb41927c2cb39a8e3710491cf37387e6be0cdba99ba0278d4882ae7b5d4b904b0f920cf04d4b9a2f47aebf74735c6a0916cfb23f039d4085f9c75f67c2d1effd1ef4fe70ad6ad20d217de4f953fee9a6cffa5726a3681ceec689fea7d3b809158334f2e6ca084427821cf93031ecdd8f54bf235975731b5bace0b89be42c2b3f13cf569c11ba4a5455ac77a5a8ab7734db792505eed5485f9668d1827375147ee2c13eb685986ba041221aa3a666e22aa7f8b3ed6fe4ec47363fa28a2c3462b10ff15bcedd80f9d7a1dc7639cb03d4af4f21e16abee3733a949741f1d46bd35222156ee2d015c2c534
*
* MY
* ski: 264d30fe7de3c25ca4bd99daabb36b458d29df06
* cert: 3082066030820494a00302010202083e3a14556dc8255b304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232313231353033333835325a170d3332313231323033333835325a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a02820181009ef2b47a698a02d9a466255127741fd72147ff74a3036885fa5c74fbe3404f530ecd9462a85a10511145955cd9dc1dfe41248e565d816c512d8ab8b6cb2589243e66f15071c10aef12a62ae1b54ad3dd476ce176fa17ba830c922e1ab895ba3a8cd13b95566ad371a7866b1d34739ca093b0d269c3501802a87b103928fb2158dc593ce9e1fa5e2e8a21e4739d3714f7da1d5d50192c07dd9bd6c1f2acfb4905f554407d2294627f0df6ad5bfc802d9e428a57adc05bd9e86b7d4aa793570b48455d651cf26114f3fa9c8939dc118d0192a131bc8c1abae9f690f58e37807d200ba33df98dd1477fcb4a445b870c298f5a56579bb55bbf0f083eb637a26c4e89051e46cb23c83b3ab347d033ca666f29d9ffb4e8f2ae6f574fbad79c03e67c9aeaccd5c1e2b6e6fd4902942d56ffb1410abf1d05dc81c23bf93e7fb3d4dec3efcd71e13b4ce715c828c25f57028b168593b509ca080cadcfd2a9aa5a3f2a5f7e7cefc24b5b3aa0d966b2f75513ed60a682908be00daf3c122dd12c68ef8357570203010001a38201323082012e301d0603551d0e04160414264d30fe7de3c25ca4bd99daabb36b458d29df0630120603551d130101ff040830060101ff020100301f0603551d23041830168014264d30fe7de3c25ca4bd99daabb36b458d29df06302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303232313231353033333835325a810f32303237313231343033333835325a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181009eacb46134cdc5621dad365e6baed71a872ca0bd7a4c13f37f089799f35b07459ecded554cb9aa9c8992fec4ba04e82137d5cf066a85384facbdb0a2aaecdca8bbf654e7b705abee88fc78891df03d67aeee9b34b1c8a3ea252bd7c0d955a59319611b868adc212138d01c0cb8f1c428d395bf85b6a8b9b2d8dafd108ed135ae8c9188b47cc506b21c388815f5ea9da7927cba4a007204a4185a751e6a0c60651e55bf0e91783c5d4e9904221c1cf1ccd973008c266a0314954b722c529ca50b6259ccc101ecf3960a44c5930c98b95cbfab2751d1112d816c7f6c8c3616381a977b185e9950dd9eaad555397e7a92b60441e7ad03fa573a7da132ceede922db0063504818140a3031e42f8319b736777474540c42f4eca7ca756642908e57227e062345b512c26f95569256f4e1767eb1588dfffb13323eba40ef5101e9018894bf6ac961e6dadd6decebe10f20267745d53a9765fa82e82b45bd39949af0759bd823abf7574f1f37fc5d9d98d989b7cb133247b014720c304be585c2bf486f
 */

func TestEmptyGenericCertPool(t *testing.T) {
	{
		var certPool GenericCertPool

		countryCerts := certPool.ByIssuerCountry("SG")
		if len(countryCerts) != 0 {
			t.Errorf("0 country certs expected for empty cert-pool")
		}

		skiCerts := certPool.BySKI(utils.HexToBytes("264d30fe7de3c25ca4bd99daabb36b458d29df06"))
		if len(skiCerts) != 0 {
			t.Errorf("0 ski certs expected for empty cert-pool")
		}

		allCerts := certPool.All()
		if len(allCerts) != 0 {
			t.Errorf("0 certs expected for empty cert-pool")
		}
	}
}

func TestGenericCertPool(t *testing.T) {
	/*
	* SG
	* ski: 32b2241e7442df02964b07bcefa099f82820ec91
	* cert: 308206ee308204d6a003020102020456a727af300d06092a864886f70d01010b0500305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341301e170d3136303132363037333130345a170d3331303132363038303130345a305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f727420434130820222300d06092a864886f70d01010105000382020f003082020a0282020100d343042eb4f144e83e31ae7af01870ec3d38b3a48625921796aee3d1d69d123064a8d325f963ee01f12a9cd175478269fdec892c46ad6e329efb0eee468fc054a9f9443ee875195ad2b79b45a34104ea254ddbedde35259c5bb51d59a65d3c852cd975b452a19c5eb93ee7d209019976efa587f0a474763ab79da67c716c09a2f7a5ace2080070b62f5b49db62fbd1ee02b0db84278ef338ba3ab3ca4b9215aee0116082c9d777b11ff37e1a1393d3a0267db2f612500763f4b97d2d0a704aad8b0b272fc503b10fe108a1fa356be0857f14af52f050af2d9b73476033de788a066c436fe767487c97260f1c3f543887bbb074678c55a59a344109430e2829eac7a5e356c0679ef1e4a55451e400cf19a762860ac45b7b786a9f16ef0b952912d4eb2ae0d5245ee377be43b4499785738f59ef629c9613bee13fad0f88933b08698eee0b271cbc7c6a5f78b739433c136fc90a697530af56aab6a7f3f41c3ee5ad7a3c67cc98402f4e67b37f2b3f3f1d900758bf1bae6d29c7c4ae3cdab427eab5e771b3afe59dae57d1d756389ad6cde1721f6d179b10526aa43b98609052e7714f025270afdd178fef12b42ebae39c78ee81599c55209b87c26d12693f9c09123cb56f2806c5df30d30c38875da17e53437218d8fa05101d0cb91d5928a137b65a90138e2f482d25720ae350e86b7f260aaa1f1137c71c31a6b51d194038050203010001a38201b2308201ae300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e00603551d1f0481d83081d5305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3075a073a071a46f306d310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341310d300b06035504030c0443524c31302b0603551d1004243022800f32303136303132363037333130345a810f32303231303831343133303130345a301f0603551d2304183016801432b2241e7442df02964b07bcefa099f82820ec91301d0603551d0e0416041432b2241e7442df02964b07bcefa099f82820ec91300d06092a864886f70d01010b05000382020100947478443af054390a24133fde00ebce292e02c4bb6092f80e97be366c906b83587350abd9445d4e7f344efdfb4033f42025e729d4488f5608daeadfa480db771537c13e7636a63baf9cf94ad10bb754b0a7b8401479006c5e28449e1114a2d2e5741d430a474bce462c28fe44a051f458d2ce8adefa2a66b5d3832b7b654f2701b33d5287c633a790c22259b7e9c6a65425cb456d29ea3ed6b8b5ab1692c51e60ffa62f77b063922128804f61c577e646e06ed479a2914f57b7ea6c7b70b522c14fcf5dd16e79ccfff93e1225b703b46f908d36da820bc5192475ea940b29a5293dec8b34947b610c0b14e47dce0d2447fdad6900028bf07575786c2618247c63b2b7cea340f21d086d661aa2b1bef427ee80b9e8b24dcd8ce1182da5e7349abf4772e464c66095021d14b91bb980cbd14d11f6f19bb89b0070aa34f27a6c622e66d16675505255aeee9be97d0df745184c1601c63b2f9d3ac1ed597b4d44343f0b927968099f857f0486701a9cc1cc3b180f841e4b4a329ce8bed8209d09929458276305dabd6d02251dfc565faa9b2650f038f6a6c6183c71b776b9939a9ce67e89e19de2838cbce6d53da944d5e26c916cdfc5b22553b44a0c12070b82cafade824a3ee693597144c2c3a9ac4bc003939a7b4274c98ae35fed86894e1af805416f33513d09728b4ad924756ee76a318cbadebc0d4b397e929303759b50f7
	*
	* SG
	* ski: 3a4d8de8fe2407a702bb9f7a320313098a2d4a8d
	* cert: 3082075c30820510a003020102020458eca0f1304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034301e170d3137303431313038353531365a170d3332303431313039323531365a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203430820222300d06092a864886f70d01010105000382020f003082020a0282020100920cc062319f782cc4d09ce256f369e867f97dc4625de13a0a807960780f6ce4a0d06b960801cf2494601bc56c94c094bf75e02b056d58e35eeab931b7c900e8afe304ec686b403905813a9c10dba4e73072ab6ef0ad3bc33b8ca384de14d6a4fdeadbb7d2e9307028546ac6e130a65e8c03573f53d97181ce4716e348623cc1031c6f33f983a0a750e675066542e7e377cb77df5224003647e2592c391053522af5dba45617a740d84f72b2d103b41666c69bc365c417316d1c84912c6c581a3c07b44f3c7dc7ec81cecb78ef0513f3981eae76a468febbf0d12c18c621d03ce2410afb85413786b405fd4e283c103003db974b1d947b5e9cfb51d74564e7521148b56faa79a09d0eeba8afc4fc57ff9ca3c239e542cdbb848f9e2ca614cf432fc539a1190b99e89ffa09a2f73c14a22a651f84710d4dd36647b66498c79e105f60b2f79aff6a4d44036b2b7f28956a8ad60e62126b7a83a28e4092e8ef352f1feeb7aed7c57405a150ccb92cd4b0298d000362897a7e0c5ba166cfbcb4176a7eb8a3833aff35635700c1bd9114fd39bc2f81add7d3efee7f25d4e83fee2cf0b84a3e7ab7d355b96974ec01c6165ffa1016edd0636014a6119f9315dcf0319bccc5e3b1b83c3bb8e437fb241aa7bbf74f8282009fbd8179ac0291e770cd27c3568c4a0af9e2dee3cdd45ee166585b994cbe99b288f0e720698c894615a218a30203010001a38201b4308201b0300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034310d300b06035504030c0443524c31302b0603551d1004243022800f32303137303431313038353531365a810f32303232313032393134323531365a301f0603551d230418301680143a4d8de8fe2407a702bb9f7a320313098a2d4a8d301d0603551d0e041604143a4d8de8fe2407a702bb9f7a320313098a2d4a8d304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010032004a14d56338d55e82c6c844157acafab31a39731b7a9eeb723c1f483cb3282073642bab5604fc53b2aeb85dcbd04fbb028f52d29c316d843edf57fda88d00254e97d9e055415233f794489aa9a8868c769664c3d4f7c6ca53715f1c4154fb2e721c750f06bf36d464fa157d07305a7f47d986c7eb71194668736971377ea834168802267cc7b33b175830ac016102f8a6c3abc1b44349ecf90b38b339ff47d6589462df9bd3b2b5d4ba8e16f25fa306e436059470bbc97aa52fc7f17ef5dffd6377e5a13cad45d7b79459cb00f5a459cd6dd30a8022bfab01dd49db3b4dd96d7a8c144db2e73ab6dc7b32416f590300533825dd7d321ddbcd086f8feaff64a6cd78a8e32e94b2fa53b44d6d305a3798ceb5f49b650daf24adaddb3c9dc686efdab9236b2062856f0abf4acc577d7f3a5beec29099c266d86af5d3267186ea14c5d486532ef50814452bc348930b0a396c71f1d2f1d718ebc8948a7d91544a8a5bb9a4617a35de2868ddee8ceef18d477cff628b60f1f466b1cffabfbbcf6ceb3b590f0d306a4a382895ce66de9369562817edaaa00c6e17c356a038f2f82ec228a34a43fb6bae542feed6d294a0b21d0801cbdb25416572f1a5832ccdb538ff72eec92ab09f0f38163dd9bc0f7afd5e82cd7812eb71f9a6c82f7d093d68d33cc47805d33e32e4695dd5cc481391d8c66338727a1601fe033745d1906c52bb
	*
	* SG
	* ski: 84cd5d8a477755058d4ec97e0d4992322be1c545
	* cert: 3082075c30820510a00302010202045fcd850b304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035301e170d3230313230373030353734315a170d3335313230373031323734315a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203530820222300d06092a864886f70d01010105000382020f003082020a0282020100b687b2fa93ffce2c110051857a65fd68ce3960a260c462af3e9bfa6f269f5ab8965d38cb22ba7f35471ca4b33e7904e183c594d4b9e84c74c04821cf528c3fa83bb6a3f4c0c317e4c95a5acc5339b4c4dd9db8eceb64db29fb88f96525ebde38e48ebe40ffa95b842f16a721e5bae8327d9545e9dc0bd143df441f6f4ed672b1711c6b20e0d266a9866c50eb172ac5dd4530969038d955a7b87bc7656395ddd670c1392672eba4f05e9dc36b563ab3fba1bad9de0ff2df8b1deb562c0ccfe88579d7318e2a6342e6dba73b716c32c830a1f7476b36f80b2dad1f0ce27c9a00610cf4d7f213f35796fc6b26c336fef1db2143dc196c02fde859239dee0bdd459aacd0481ffef9eb1a6d9f52699d570289e3fd2da753195836b2fe51a827ff8ea497059faa496b36831e5554f8f306e835b086e0b7ad30afc1e55d6a15fc1036cf6b54042320747ab7d6d5fc86113937297227758c7cebf21f3827acce909026ceb4ab4d16e065e3bd82dab7ee40abaab58085c96c5f1d19bc16a94b23bf8c0572b7d88b8a4a21a0ae77a231b0bbdaf40d5205e33161a4d8b8722c308d6a565f34f38b50ff84bda8f9ee9f0e584ceac279aa337fbddb9c9b1069a7304955422da53ae35dd72ea2d7827864a698c0980a322b59ba6a4a00dbd115a2f663fafd89413b02f416130875c6bc8e3da4b8bb49c1b6ecfefc1fa2d965fc9e38abd47542030203010001a38201b4308201b0300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035310d300b06035504030c0443524c31302b0603551d1004243022800f32303230313230373030353734315a810f32303236303632353232303630355a301f0603551d2304183016801484cd5d8a477755058d4ec97e0d4992322be1c545301d0603551d0e0416041484cd5d8a477755058d4ec97e0d4992322be1c545304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010061f578df00b83120fba10cc7b2a63a120ee98248d788592b8b495dda3951acdc86597b9da3e0ad4650184261f4d51c283a55b2633ae27c76589f65f107279b8494ff7b2bdb026bb0d3e74fbcf6af66943911f8473d1ef53985adda48ec96bf57654a347b40f6c66d6f479aafdca863a15bb64b3e3b6de6765942d7985dd9dca81a3e11722e3463ddde0cc42104f6b83164189698b5b1f5143530f0dc56d91678a98ab4b1b243a7fb398a12d792d98a0e08d9b493a6720ba69181da3532e15ebb32a24457c9b58f19b2dfeb29ff5184d154d9e4880b2e3c70c44bc06294a52e61255a335dcc649a2d6e70af9d49bc3a5f15ff59332c5b13979fb34903771377308779c3b16c8698538ccfa97cc3588e9397ca89dd9e15ee6f12a0f352c788ab56c040362d2346139853df252fc401c28b87e1f60eaf5e9bb21fc992f0934066a36c8aaf41c43e8a987ab97a3f1bf271d394662058f7f0d2fcfb537e6a2859df4fd904f41c75e31ba6dd2b8c79a662c96e8685c24b9d935bc638ccf56bfc42419f12bfa73b8f5c872bd630ff9623950e1604e0225b9a453fb7785d2b06e94b0feee57bd9bca03d82f094eec4c6ae366a50b32fb6247bd874a24af3ee221d7bcfddda9fd6cae5c8c7a3fa5a6d3808664c3bf700c04be9c0dcfd3f4b4e457127914b34b4c458dd7a94020ef08f43cdd6c3f3c4ed08dd7c137eb2a065f95e49de499d
	 */

	/*
	 * MY
	 * ski: d54dcf907ed448d2f40e059a3932b4660c9ec2db
	 * cert: 3082066030820494a00302010202083c99dfd4c3f358e8304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3139303732363131303534355a170d3239303732333131303534355a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a0282018100db239b51311a1f69c5b920d49206e21a4124ee424e2321f2f46088cef957980cdfcf1e44433b9cc611f484b7328dea3dfe75874d46dc7659b2a0c866aca5420b32b7db7becccb5f912fc801e00e09e8752164ea64f14fe8fe9cef2ab55c5fc6ebe80c272bf4be881ba5dfd874eef8a357bba2bf62674e24a688b206799b6bf123f96159659250edbd9402d0975355228c2e6670e9bcc40a81b85e157172e8d5a89abd2808664cd30ce4579802a18ae0fe53304e9352733d1ed4c726733d2e91efba5d51ac8f490c81b5419a8b21042da9f61e54cdef133a6e7ac7a59502e1706010b86eda36ac70d00d933b2ae214be0bd2741da0c39457a05952a1ed789d53f7d10c54a95085f38818f9ab8bcdf7c13b39f0efdf3eaba2cdae94f603f07753ab12a792541fa8fef37299af35ca4ab3115b01d9dbd733486aa0de86b88048dc8aa85892e18b3816be3ba4461adab881662049fc0be17ed3a1ece887ca408cd2abd1547cbf5f89cbc923d562660d48df541664b0334edbc3fd59ef9242c6beaf10203010001a38201323082012e301d0603551d0e04160414d54dcf907ed448d2f40e059a3932b4660c9ec2db30120603551d130101ff040830060101ff020100301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303139303732363131303534355a810f32303234303732343131303534355a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038201810043aa8bb4d713ed1ed41d8b935878910df7d5a5918a8f3f9335be154ba93b1f40f0fbcc278dd20bdd37c917f794041a929cba38cd6c19621fa3120d6c22661672232c2f23c43871d2c42c9e691f8f338e4b8587df5aadea8787a4117ff568929361228940dd74d851d819c46db28286ac56bf927e22a103d8985a8366249206807f0ffbdcf8124983f3d12070bf983301536b4cc211b5f3cb41927c2cb39a8e3710491cf37387e6be0cdba99ba0278d4882ae7b5d4b904b0f920cf04d4b9a2f47aebf74735c6a0916cfb23f039d4085f9c75f67c2d1effd1ef4fe70ad6ad20d217de4f953fee9a6cffa5726a3681ceec689fea7d3b809158334f2e6ca084427821cf93031ecdd8f54bf235975731b5bace0b89be42c2b3f13cf569c11ba4a5455ac77a5a8ab7734db792505eed5485f9668d1827375147ee2c13eb685986ba041221aa3a666e22aa7f8b3ed6fe4ec47363fa28a2c3462b10ff15bcedd80f9d7a1dc7639cb03d4af4f21e16abee3733a949741f1d46bd35222156ee2d015c2c534
	 *
	 * MY
	 * ski: 264d30fe7de3c25ca4bd99daabb36b458d29df06
	 * cert: 3082066030820494a00302010202083e3a14556dc8255b304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232313231353033333835325a170d3332313231323033333835325a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a02820181009ef2b47a698a02d9a466255127741fd72147ff74a3036885fa5c74fbe3404f530ecd9462a85a10511145955cd9dc1dfe41248e565d816c512d8ab8b6cb2589243e66f15071c10aef12a62ae1b54ad3dd476ce176fa17ba830c922e1ab895ba3a8cd13b95566ad371a7866b1d34739ca093b0d269c3501802a87b103928fb2158dc593ce9e1fa5e2e8a21e4739d3714f7da1d5d50192c07dd9bd6c1f2acfb4905f554407d2294627f0df6ad5bfc802d9e428a57adc05bd9e86b7d4aa793570b48455d651cf26114f3fa9c8939dc118d0192a131bc8c1abae9f690f58e37807d200ba33df98dd1477fcb4a445b870c298f5a56579bb55bbf0f083eb637a26c4e89051e46cb23c83b3ab347d033ca666f29d9ffb4e8f2ae6f574fbad79c03e67c9aeaccd5c1e2b6e6fd4902942d56ffb1410abf1d05dc81c23bf93e7fb3d4dec3efcd71e13b4ce715c828c25f57028b168593b509ca080cadcfd2a9aa5a3f2a5f7e7cefc24b5b3aa0d966b2f75513ed60a682908be00daf3c122dd12c68ef8357570203010001a38201323082012e301d0603551d0e04160414264d30fe7de3c25ca4bd99daabb36b458d29df0630120603551d130101ff040830060101ff020100301f0603551d23041830168014264d30fe7de3c25ca4bd99daabb36b458d29df06302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303232313231353033333835325a810f32303237313231343033333835325a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181009eacb46134cdc5621dad365e6baed71a872ca0bd7a4c13f37f089799f35b07459ecded554cb9aa9c8992fec4ba04e82137d5cf066a85384facbdb0a2aaecdca8bbf654e7b705abee88fc78891df03d67aeee9b34b1c8a3ea252bd7c0d955a59319611b868adc212138d01c0cb8f1c428d395bf85b6a8b9b2d8dafd108ed135ae8c9188b47cc506b21c388815f5ea9da7927cba4a007204a4185a751e6a0c60651e55bf0e91783c5d4e9904221c1cf1ccd973008c266a0314954b722c529ca50b6259ccc101ecf3960a44c5930c98b95cbfab2751d1112d816c7f6c8c3616381a977b185e9950dd9eaad555397e7a92b60441e7ad03fa573a7da132ceede922db0063504818140a3031e42f8319b736777474540c42f4eca7ca756642908e57227e062345b512c26f95569256f4e1767eb1588dfffb13323eba40ef5101e9018894bf6ac961e6dadd6decebe10f20267745d53a9765fa82e82b45bd39949af0759bd823abf7574f1f37fc5d9d98d989b7cb133247b014720c304be585c2bf486f
	 */

	// NB this is the concatenation of the above 5 certs (SG:3, MY:2)
	rawCertBytes := utils.HexToBytes("308206ee308204d6a003020102020456a727af300d06092a864886f70d01010b0500305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341301e170d3136303132363037333130345a170d3331303132363038303130345a305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f727420434130820222300d06092a864886f70d01010105000382020f003082020a0282020100d343042eb4f144e83e31ae7af01870ec3d38b3a48625921796aee3d1d69d123064a8d325f963ee01f12a9cd175478269fdec892c46ad6e329efb0eee468fc054a9f9443ee875195ad2b79b45a34104ea254ddbedde35259c5bb51d59a65d3c852cd975b452a19c5eb93ee7d209019976efa587f0a474763ab79da67c716c09a2f7a5ace2080070b62f5b49db62fbd1ee02b0db84278ef338ba3ab3ca4b9215aee0116082c9d777b11ff37e1a1393d3a0267db2f612500763f4b97d2d0a704aad8b0b272fc503b10fe108a1fa356be0857f14af52f050af2d9b73476033de788a066c436fe767487c97260f1c3f543887bbb074678c55a59a344109430e2829eac7a5e356c0679ef1e4a55451e400cf19a762860ac45b7b786a9f16ef0b952912d4eb2ae0d5245ee377be43b4499785738f59ef629c9613bee13fad0f88933b08698eee0b271cbc7c6a5f78b739433c136fc90a697530af56aab6a7f3f41c3ee5ad7a3c67cc98402f4e67b37f2b3f3f1d900758bf1bae6d29c7c4ae3cdab427eab5e771b3afe59dae57d1d756389ad6cde1721f6d179b10526aa43b98609052e7714f025270afdd178fef12b42ebae39c78ee81599c55209b87c26d12693f9c09123cb56f2806c5df30d30c38875da17e53437218d8fa05101d0cb91d5928a137b65a90138e2f482d25720ae350e86b7f260aaa1f1137c71c31a6b51d194038050203010001a38201b2308201ae300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e00603551d1f0481d83081d5305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3075a073a071a46f306d310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341310d300b06035504030c0443524c31302b0603551d1004243022800f32303136303132363037333130345a810f32303231303831343133303130345a301f0603551d2304183016801432b2241e7442df02964b07bcefa099f82820ec91301d0603551d0e0416041432b2241e7442df02964b07bcefa099f82820ec91300d06092a864886f70d01010b05000382020100947478443af054390a24133fde00ebce292e02c4bb6092f80e97be366c906b83587350abd9445d4e7f344efdfb4033f42025e729d4488f5608daeadfa480db771537c13e7636a63baf9cf94ad10bb754b0a7b8401479006c5e28449e1114a2d2e5741d430a474bce462c28fe44a051f458d2ce8adefa2a66b5d3832b7b654f2701b33d5287c633a790c22259b7e9c6a65425cb456d29ea3ed6b8b5ab1692c51e60ffa62f77b063922128804f61c577e646e06ed479a2914f57b7ea6c7b70b522c14fcf5dd16e79ccfff93e1225b703b46f908d36da820bc5192475ea940b29a5293dec8b34947b610c0b14e47dce0d2447fdad6900028bf07575786c2618247c63b2b7cea340f21d086d661aa2b1bef427ee80b9e8b24dcd8ce1182da5e7349abf4772e464c66095021d14b91bb980cbd14d11f6f19bb89b0070aa34f27a6c622e66d16675505255aeee9be97d0df745184c1601c63b2f9d3ac1ed597b4d44343f0b927968099f857f0486701a9cc1cc3b180f841e4b4a329ce8bed8209d09929458276305dabd6d02251dfc565faa9b2650f038f6a6c6183c71b776b9939a9ce67e89e19de2838cbce6d53da944d5e26c916cdfc5b22553b44a0c12070b82cafade824a3ee693597144c2c3a9ac4bc003939a7b4274c98ae35fed86894e1af805416f33513d09728b4ad924756ee76a318cbadebc0d4b397e929303759b50f73082075c30820510a003020102020458eca0f1304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034301e170d3137303431313038353531365a170d3332303431313039323531365a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203430820222300d06092a864886f70d01010105000382020f003082020a0282020100920cc062319f782cc4d09ce256f369e867f97dc4625de13a0a807960780f6ce4a0d06b960801cf2494601bc56c94c094bf75e02b056d58e35eeab931b7c900e8afe304ec686b403905813a9c10dba4e73072ab6ef0ad3bc33b8ca384de14d6a4fdeadbb7d2e9307028546ac6e130a65e8c03573f53d97181ce4716e348623cc1031c6f33f983a0a750e675066542e7e377cb77df5224003647e2592c391053522af5dba45617a740d84f72b2d103b41666c69bc365c417316d1c84912c6c581a3c07b44f3c7dc7ec81cecb78ef0513f3981eae76a468febbf0d12c18c621d03ce2410afb85413786b405fd4e283c103003db974b1d947b5e9cfb51d74564e7521148b56faa79a09d0eeba8afc4fc57ff9ca3c239e542cdbb848f9e2ca614cf432fc539a1190b99e89ffa09a2f73c14a22a651f84710d4dd36647b66498c79e105f60b2f79aff6a4d44036b2b7f28956a8ad60e62126b7a83a28e4092e8ef352f1feeb7aed7c57405a150ccb92cd4b0298d000362897a7e0c5ba166cfbcb4176a7eb8a3833aff35635700c1bd9114fd39bc2f81add7d3efee7f25d4e83fee2cf0b84a3e7ab7d355b96974ec01c6165ffa1016edd0636014a6119f9315dcf0319bccc5e3b1b83c3bb8e437fb241aa7bbf74f8282009fbd8179ac0291e770cd27c3568c4a0af9e2dee3cdd45ee166585b994cbe99b288f0e720698c894615a218a30203010001a38201b4308201b0300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412034310d300b06035504030c0443524c31302b0603551d1004243022800f32303137303431313038353531365a810f32303232313032393134323531365a301f0603551d230418301680143a4d8de8fe2407a702bb9f7a320313098a2d4a8d301d0603551d0e041604143a4d8de8fe2407a702bb9f7a320313098a2d4a8d304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010032004a14d56338d55e82c6c844157acafab31a39731b7a9eeb723c1f483cb3282073642bab5604fc53b2aeb85dcbd04fbb028f52d29c316d843edf57fda88d00254e97d9e055415233f794489aa9a8868c769664c3d4f7c6ca53715f1c4154fb2e721c750f06bf36d464fa157d07305a7f47d986c7eb71194668736971377ea834168802267cc7b33b175830ac016102f8a6c3abc1b44349ecf90b38b339ff47d6589462df9bd3b2b5d4ba8e16f25fa306e436059470bbc97aa52fc7f17ef5dffd6377e5a13cad45d7b79459cb00f5a459cd6dd30a8022bfab01dd49db3b4dd96d7a8c144db2e73ab6dc7b32416f590300533825dd7d321ddbcd086f8feaff64a6cd78a8e32e94b2fa53b44d6d305a3798ceb5f49b650daf24adaddb3c9dc686efdab9236b2062856f0abf4acc577d7f3a5beec29099c266d86af5d3267186ea14c5d486532ef50814452bc348930b0a396c71f1d2f1d718ebc8948a7d91544a8a5bb9a4617a35de2868ddee8ceef18d477cff628b60f1f466b1cffabfbbcf6ceb3b590f0d306a4a382895ce66de9369562817edaaa00c6e17c356a038f2f82ec228a34a43fb6bae542feed6d294a0b21d0801cbdb25416572f1a5832ccdb538ff72eec92ab09f0f38163dd9bc0f7afd5e82cd7812eb71f9a6c82f7d093d68d33cc47805d33e32e4695dd5cc481391d8c66338727a1601fe033745d1906c52bb3082075c30820510a00302010202045fcd850b304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035301e170d3230313230373030353734315a170d3335313230373031323734315a3060310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f7274204341203530820222300d06092a864886f70d01010105000382020f003082020a0282020100b687b2fa93ffce2c110051857a65fd68ce3960a260c462af3e9bfa6f269f5ab8965d38cb22ba7f35471ca4b33e7904e183c594d4b9e84c74c04821cf528c3fa83bb6a3f4c0c317e4c95a5acc5339b4c4dd9db8eceb64db29fb88f96525ebde38e48ebe40ffa95b842f16a721e5bae8327d9545e9dc0bd143df441f6f4ed672b1711c6b20e0d266a9866c50eb172ac5dd4530969038d955a7b87bc7656395ddd670c1392672eba4f05e9dc36b563ab3fba1bad9de0ff2df8b1deb562c0ccfe88579d7318e2a6342e6dba73b716c32c830a1f7476b36f80b2dad1f0ce27c9a00610cf4d7f213f35796fc6b26c336fef1db2143dc196c02fde859239dee0bdd459aacd0481ffef9eb1a6d9f52699d570289e3fd2da753195836b2fe51a827ff8ea497059faa496b36831e5554f8f306e835b086e0b7ad30afc1e55d6a15fc1036cf6b54042320747ab7d6d5fc86113937297227758c7cebf21f3827acce909026ceb4ab4d16e065e3bd82dab7ee40abaab58085c96c5f1d19bc16a94b23bf8c0572b7d88b8a4a21a0ae77a231b0bbdaf40d5205e33161a4d8b8722c308d6a565f34f38b50ff84bda8f9ee9f0e584ceac279aa337fbddb9c9b1069a7304955422da53ae35dd72ea2d7827864a698c0980a322b59ba6a4a00dbd115a2f663fafd89413b02f416130875c6bc8e3da4b8bb49c1b6ecfefc1fa2d965fc9e38abd47542030203010001a38201b4308201b0300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e20603551d1f0481da3081d7305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3077a075a073a471306f310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c034943413120301e06035504030c1753696e6761706f72652050617373706f72742043412035310d300b06035504030c0443524c31302b0603551d1004243022800f32303230313230373030353734315a810f32303236303632353232303630355a301f0603551d2304183016801484cd5d8a477755058d4ec97e0d4992322be1c545301d0603551d0e0416041484cd5d8a477755058d4ec97e0d4992322be1c545304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038202010061f578df00b83120fba10cc7b2a63a120ee98248d788592b8b495dda3951acdc86597b9da3e0ad4650184261f4d51c283a55b2633ae27c76589f65f107279b8494ff7b2bdb026bb0d3e74fbcf6af66943911f8473d1ef53985adda48ec96bf57654a347b40f6c66d6f479aafdca863a15bb64b3e3b6de6765942d7985dd9dca81a3e11722e3463ddde0cc42104f6b83164189698b5b1f5143530f0dc56d91678a98ab4b1b243a7fb398a12d792d98a0e08d9b493a6720ba69181da3532e15ebb32a24457c9b58f19b2dfeb29ff5184d154d9e4880b2e3c70c44bc06294a52e61255a335dcc649a2d6e70af9d49bc3a5f15ff59332c5b13979fb34903771377308779c3b16c8698538ccfa97cc3588e9397ca89dd9e15ee6f12a0f352c788ab56c040362d2346139853df252fc401c28b87e1f60eaf5e9bb21fc992f0934066a36c8aaf41c43e8a987ab97a3f1bf271d394662058f7f0d2fcfb537e6a2859df4fd904f41c75e31ba6dd2b8c79a662c96e8685c24b9d935bc638ccf56bfc42419f12bfa73b8f5c872bd630ff9623950e1604e0225b9a453fb7785d2b06e94b0feee57bd9bca03d82f094eec4c6ae366a50b32fb6247bd874a24af3ee221d7bcfddda9fd6cae5c8c7a3fa5a6d3808664c3bf700c04be9c0dcfd3f4b4e457127914b34b4c458dd7a94020ef08f43cdd6c3f3c4ed08dd7c137eb2a065f95e49de499d3082066030820494a00302010202083c99dfd4c3f358e8304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3139303732363131303534355a170d3239303732333131303534355a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a0282018100db239b51311a1f69c5b920d49206e21a4124ee424e2321f2f46088cef957980cdfcf1e44433b9cc611f484b7328dea3dfe75874d46dc7659b2a0c866aca5420b32b7db7becccb5f912fc801e00e09e8752164ea64f14fe8fe9cef2ab55c5fc6ebe80c272bf4be881ba5dfd874eef8a357bba2bf62674e24a688b206799b6bf123f96159659250edbd9402d0975355228c2e6670e9bcc40a81b85e157172e8d5a89abd2808664cd30ce4579802a18ae0fe53304e9352733d1ed4c726733d2e91efba5d51ac8f490c81b5419a8b21042da9f61e54cdef133a6e7ac7a59502e1706010b86eda36ac70d00d933b2ae214be0bd2741da0c39457a05952a1ed789d53f7d10c54a95085f38818f9ab8bcdf7c13b39f0efdf3eaba2cdae94f603f07753ab12a792541fa8fef37299af35ca4ab3115b01d9dbd733486aa0de86b88048dc8aa85892e18b3816be3ba4461adab881662049fc0be17ed3a1ece887ca408cd2abd1547cbf5f89cbc923d562660d48df541664b0334edbc3fd59ef9242c6beaf10203010001a38201323082012e301d0603551d0e04160414d54dcf907ed448d2f40e059a3932b4660c9ec2db30120603551d130101ff040830060101ff020100301f0603551d23041830168014d54dcf907ed448d2f40e059a3932b4660c9ec2db302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303139303732363131303534355a810f32303234303732343131303534355a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a203020120038201810043aa8bb4d713ed1ed41d8b935878910df7d5a5918a8f3f9335be154ba93b1f40f0fbcc278dd20bdd37c917f794041a929cba38cd6c19621fa3120d6c22661672232c2f23c43871d2c42c9e691f8f338e4b8587df5aadea8787a4117ff568929361228940dd74d851d819c46db28286ac56bf927e22a103d8985a8366249206807f0ffbdcf8124983f3d12070bf983301536b4cc211b5f3cb41927c2cb39a8e3710491cf37387e6be0cdba99ba0278d4882ae7b5d4b904b0f920cf04d4b9a2f47aebf74735c6a0916cfb23f039d4085f9c75f67c2d1effd1ef4fe70ad6ad20d217de4f953fee9a6cffa5726a3681ceec689fea7d3b809158334f2e6ca084427821cf93031ecdd8f54bf235975731b5bace0b89be42c2b3f13cf569c11ba4a5455ac77a5a8ab7734db792505eed5485f9668d1827375147ee2c13eb685986ba041221aa3a666e22aa7f8b3ed6fe4ec47363fa28a2c3462b10ff15bcedd80f9d7a1dc7639cb03d4af4f21e16abee3733a949741f1d46bd35222156ee2d015c2c5343082066030820494a00302010202083e3a14556dc8255b304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a2030201203081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572301e170d3232313231353033333835325a170d3332313231323033333835325a3081a0310b3009060355040613024d59310b300906035504080c0257503112301006035504070c0950757472616a61796131233021060355040a0c1a4a61626174616e20496d6967726573656e204d616c617973696131293027060355040b0c20426168616769616e204b6573656c616d6174616e2064616e20506173706f72743120301e06035504030c174d616c617973696120436f756e747279205369676e6572308201a2300d06092a864886f70d01010105000382018f003082018a02820181009ef2b47a698a02d9a466255127741fd72147ff74a3036885fa5c74fbe3404f530ecd9462a85a10511145955cd9dc1dfe41248e565d816c512d8ab8b6cb2589243e66f15071c10aef12a62ae1b54ad3dd476ce176fa17ba830c922e1ab895ba3a8cd13b95566ad371a7866b1d34739ca093b0d269c3501802a87b103928fb2158dc593ce9e1fa5e2e8a21e4739d3714f7da1d5d50192c07dd9bd6c1f2acfb4905f554407d2294627f0df6ad5bfc802d9e428a57adc05bd9e86b7d4aa793570b48455d651cf26114f3fa9c8939dc118d0192a131bc8c1abae9f690f58e37807d200ba33df98dd1477fcb4a445b870c298f5a56579bb55bbf0f083eb637a26c4e89051e46cb23c83b3ab347d033ca666f29d9ffb4e8f2ae6f574fbad79c03e67c9aeaccd5c1e2b6e6fd4902942d56ffb1410abf1d05dc81c23bf93e7fb3d4dec3efcd71e13b4ce715c828c25f57028b168593b509ca080cadcfd2a9aa5a3f2a5f7e7cefc24b5b3aa0d966b2f75513ed60a682908be00daf3c122dd12c68ef8357570203010001a38201323082012e301d0603551d0e04160414264d30fe7de3c25ca4bd99daabb36b458d29df0630120603551d130101ff040830060101ff020100301f0603551d23041830168014264d30fe7de3c25ca4bd99daabb36b458d29df06302e0603551d120427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953302b0603551d1004243022800f32303232313231353033333835325a810f32303237313231343033333835325a303b0603551d1f043430323030a02ea02c862a687474703a2f2f7777772e696d692e676f762e6d792f696d616765732f7064662f636163726c2e63726c300e0603551d0f0101ff040403020106302e0603551d110427302581116a696d706b6940696d692e676f762e6d79a410300e310c300a06035504070c034d5953304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003820181009eacb46134cdc5621dad365e6baed71a872ca0bd7a4c13f37f089799f35b07459ecded554cb9aa9c8992fec4ba04e82137d5cf066a85384facbdb0a2aaecdca8bbf654e7b705abee88fc78891df03d67aeee9b34b1c8a3ea252bd7c0d955a59319611b868adc212138d01c0cb8f1c428d395bf85b6a8b9b2d8dafd108ed135ae8c9188b47cc506b21c388815f5ea9da7927cba4a007204a4185a751e6a0c60651e55bf0e91783c5d4e9904221c1cf1ccd973008c266a0314954b722c529ca50b6259ccc101ecf3960a44c5930c98b95cbfab2751d1112d816c7f6c8c3616381a977b185e9950dd9eaad555397e7a92b60441e7ad03fa573a7da132ceede922db0063504818140a3031e42f8319b736777474540c42f4eca7ca756642908e57227e062345b512c26f95569256f4e1767eb1588dfffb13323eba40ef5101e9018894bf6ac961e6dadd6decebe10f20267745d53a9765fa82e82b45bd39949af0759bd823abf7574f1f37fc5d9d98d989b7cb133247b014720c304be585c2bf486f")

	var certPool GenericCertPool

	// expect success
	err := certPool.Add(rawCertBytes)
	if err != nil {
		t.Errorf("unexpected error: %s", err)
	}

	// expect 5 certs
	if certPool.Count() != 5 {
		t.Errorf("expected 5 certs")
	}

	// expect 3 SG certs
	sgCerts := certPool.ByIssuerCountry("SG")
	if len(sgCerts) != 3 {
		t.Errorf("expected 3 certs for SG")
	}

	// expect 1 cert to match ski
	sgSkiCert := certPool.BySKI(utils.HexToBytes("84cd5d8a477755058d4ec97e0d4992322be1c545"))
	if len(sgSkiCert) != 1 {
		t.Errorf("expected 1 cert for ski")
	}

	// try adding the SG certs back to the cert-pool
	// so expect 8 certs (i.e. 5+3)
	certPool.AddCerts(sgCerts)
	// NB this works so long as we don't try to de-dupe the certs (which we don't currently)
	if certPool.Count() != 8 {
		t.Errorf("expected 8 certs (got:%01d)", certPool.Count())
	}
}

func TestGenericCertPoolBadCertBytes(t *testing.T) {
	var certPool GenericCertPool

	// NB modified valid cert and gave it an invalid length... e.g. 308206ee -> 308206ef (indicates 1 byte longer than actual)
	var badCertBytes []byte = utils.HexToBytes("308206ef308204d6a003020102020456a727af300d06092a864886f70d01010b0500305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341301e170d3136303132363037333130345a170d3331303132363038303130345a305e310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f727420434130820222300d06092a864886f70d01010105000382020f003082020a0282020100d343042eb4f144e83e31ae7af01870ec3d38b3a48625921796aee3d1d69d123064a8d325f963ee01f12a9cd175478269fdec892c46ad6e329efb0eee468fc054a9f9443ee875195ad2b79b45a34104ea254ddbedde35259c5bb51d59a65d3c852cd975b452a19c5eb93ee7d209019976efa587f0a474763ab79da67c716c09a2f7a5ace2080070b62f5b49db62fbd1ee02b0db84278ef338ba3ab3ca4b9215aee0116082c9d777b11ff37e1a1393d3a0267db2f612500763f4b97d2d0a704aad8b0b272fc503b10fe108a1fa356be0857f14af52f050af2d9b73476033de788a066c436fe767487c97260f1c3f543887bbb074678c55a59a344109430e2829eac7a5e356c0679ef1e4a55451e400cf19a762860ac45b7b786a9f16ef0b952912d4eb2ae0d5245ee377be43b4499785738f59ef629c9613bee13fad0f88933b08698eee0b271cbc7c6a5f78b739433c136fc90a697530af56aab6a7f3f41c3ee5ad7a3c67cc98402f4e67b37f2b3f3f1d900758bf1bae6d29c7c4ae3cdab427eab5e771b3afe59dae57d1d756389ad6cde1721f6d179b10526aa43b98609052e7714f025270afdd178fef12b42ebae39c78ee81599c55209b87c26d12693f9c09123cb56f2806c5df30d30c38875da17e53437218d8fa05101d0cb91d5928a137b65a90138e2f482d25720ae350e86b7f260aaa1f1137c71c31a6b51d194038050203010001a38201b2308201ae300e0603551d0f0101ff04040302010630120603551d130101ff040830060101ff020100301b0603551d1104143012a410300e310c300a06035504070c03534750301b0603551d1204143012a410300e310c300a06035504070c035347503081e00603551d1f0481d83081d5305ca05aa058862a68747470733a2f2f706b64646f776e6c6f6164312e6963616f2e696e742f43524c732f5347502e63726c862a68747470733a2f2f706b64646f776e6c6f6164322e6963616f2e696e742f43524c732f5347502e63726c3075a073a071a46f306d310b30090603550406130253473121301f060355040a0c184d696e6973747279206f6620486f6d652041666661697273310c300a060355040b0c03494341311e301c06035504030c1553696e6761706f72652050617373706f7274204341310d300b06035504030c0443524c31302b0603551d1004243022800f32303136303132363037333130345a810f32303231303831343133303130345a301f0603551d2304183016801432b2241e7442df02964b07bcefa099f82820ec91301d0603551d0e0416041432b2241e7442df02964b07bcefa099f82820ec91300d06092a864886f70d01010b05000382020100947478443af054390a24133fde00ebce292e02c4bb6092f80e97be366c906b83587350abd9445d4e7f344efdfb4033f42025e729d4488f5608daeadfa480db771537c13e7636a63baf9cf94ad10bb754b0a7b8401479006c5e28449e1114a2d2e5741d430a474bce462c28fe44a051f458d2ce8adefa2a66b5d3832b7b654f2701b33d5287c633a790c22259b7e9c6a65425cb456d29ea3ed6b8b5ab1692c51e60ffa62f77b063922128804f61c577e646e06ed479a2914f57b7ea6c7b70b522c14fcf5dd16e79ccfff93e1225b703b46f908d36da820bc5192475ea940b29a5293dec8b34947b610c0b14e47dce0d2447fdad6900028bf07575786c2618247c63b2b7cea340f21d086d661aa2b1bef427ee80b9e8b24dcd8ce1182da5e7349abf4772e464c66095021d14b91bb980cbd14d11f6f19bb89b0070aa34f27a6c622e66d16675505255aeee9be97d0df745184c1601c63b2f9d3ac1ed597b4d44343f0b927968099f857f0486701a9cc1cc3b180f841e4b4a329ce8bed8209d09929458276305dabd6d02251dfc565faa9b2650f038f6a6c6183c71b776b9939a9ce67e89e19de2838cbce6d53da944d5e26c916cdfc5b22553b44a0c12070b82cafade824a3ee693597144c2c3a9ac4bc003939a7b4274c98ae35fed86894e1af805416f33513d09728b4ad924756ee76a318cbadebc0d4b397e929303759b50f7")

	err := certPool.Add(badCertBytes)
	if err == nil {
		t.Fatalf("expected error")
	}
}
