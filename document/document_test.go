package document

import (
	"reflect"
	"strings"
	"testing"

	"github.com/gmrtd/gmrtd/oid"
	"github.com/gmrtd/gmrtd/utils"
)

func TestChipAuthStatusString(t *testing.T) {
	testCases := []struct {
		chipAuthStatus ChipAuthStatus
		expStr         string
	}{
		{
			chipAuthStatus: CHIP_AUTH_STATUS_NONE,
			expStr:         "n/a",
		},
		{
			chipAuthStatus: CHIP_AUTH_STATUS_PACE_CAM,
			expStr:         "PACE-CAM",
		},
		{
			chipAuthStatus: CHIP_AUTH_STATUS_CA,
			expStr:         "Chip Authentication",
		},
		{
			chipAuthStatus: CHIP_AUTH_STATUS_AA,
			expStr:         "Active Authentication",
		},
	}
	for _, tc := range testCases {
		actStr := tc.chipAuthStatus.String()

		if actStr != tc.expStr {
			t.Errorf("ChipAuthStatus string() differs to expected (Exp:%s, Act:%s)", tc.expStr, actStr)
		}
	}
}

func TestLdsUnicodeVersion(t *testing.T) {
	testCases := []struct {
		comBytes          []byte
		sodBytes          []byte
		expLdsVersion     string
		expUnicodeVersion string
	}{
		{
			// tests the Lds/Unicode version when only the document is empty (i.e no EF.COM or EF.SOD)
			comBytes:          []byte{},
			sodBytes:          []byte{},
			expLdsVersion:     "",
			expUnicodeVersion: "",
		},
		{
			// tests the Lds/Unicode version when both EF.SOD and EF.COM are present
			// modified from EF.COM test (9303-p10) (LdsVer:1234, UnicodeVer:654321)
			// SG SOD test data (LdsVer:0108, UnicodeVer:040000)
			comBytes:          utils.HexToBytes("60145F0104313233345F36063635343332315C026175"),
			sodBytes:          utils.HexToBytes("778209C5308209C106092A864886F70D010702A08209B2308209AE020103310D300B0609608648016503040201308201210606678108010101A0820115048201113082010D020101300B06096086480165030402013081EA30250201010420B8531D522AF781EBBA2F78465B5BEAB1FCCE2861DD947316A217A0F31F06598330250201020420D2FC98EFFEAAC17D42987C48F310315086FC920054F900002DF114A79FF2774B30250201030420883155F3A1EA7948BF4A416625C767ED1F4ED2EAED731F143CC8A22CEABC0CB13025020104042010500F4BC7437F061D4CE735AC0C4F35CF71ADB7C5112AAF9B2CCB2C9BD20C3A302502010D0420ADED95A855D5C0AC69599F46C4C464AD2AAB053798AEBE74C69472FF2FFBB0B4302502010E04209CDA75E7B4F6168E6586CCD175C0AAB3E90F47A68D68E922122937414A90622D300E1304303130381306303430303030A08206603082065C30820410A00302010202045FCDC27C304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A2030201203060310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F72742043412035301E170D3232303632373032333934315A170D3332313132373135313232355A305D310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C03494341311D301B06035504030C1453472044534331302032303232303632372D303130820122300D06092A864886F70D01010105000382010F003082010A0282010100A695EF6E7174AA7428B351D0106D1B31D0CBC40E2D2FEFFA6F6DEF30220648C124856C14006C2B961CFF1D81776E3704A00E0BB243CB72F1776B7F6EB917F5A9450C2D1CBB0574ADD7BB8D75FAE7746D6C622CC0A5314BB5812D680077BD45DDF49F58CF7D5D9294CC8045219C8280F8DDDE95B529C9F4AAAE45150252B5C691C46B78FF58DF1F2D7ACE90E14E0920B6E4524E87E596E232F6B80D0BCBBECA94EDB552E4EAAACA21AE6AE56C0F961836C90E198AED563100B49E1BB93497592B2CE6A61A494CF76219B96FA52675A4FA39C6249FC07665564BEC456CDB9217A6FBFA9AF2E043968B51E551CF70861E5BFA5493F3FFE40FF937CF5B55E50135E70203010001A38201B7308201B3300E0603551D0F0101FF0404030207803015060767810801010602040A30080201003103130150301B0603551D1204143012A410300E310C300A06035504070C03534750301B0603551D1104143012A410300E310C300A06035504070C035347503081E20603551D1F0481DA3081D7305CA05AA058862A68747470733A2F2F706B64646F776E6C6F6164312E6963616F2E696E742F43524C732F5347502E63726C862A68747470733A2F2F706B64646F776E6C6F6164322E6963616F2E696E742F43524C732F5347502E63726C3077A075A073A471306F310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F72742043412035310D300B06035504030C0443524C31302B0603551D1004243022800F32303232303632373032333934315A810F32303232313132373135313232355A301F0603551D2304183016801484CD5D8A477755058D4EC97E0D4992322BE1C545301D0603551D0E04160414A91A62A686DF680A934C0B68032BFAAA100638A6304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A203020120038202010027186E71CB7F33B78FD28565EB886A8224BAB30752BDE7C53257360C872DE2E89318C14F0BBCBE8B34D08463F504C5AD11E5603B71F3D075B00FBED8FB16E9C5F9E95221783F9463C67F78CC3BD80D6EB8B523DE1C7EAD4C88F4CE3B799A2F60BDC11919FF9A68698686072740F7AB6B60F4958E29C6D7113BA25FEC02A1852783068847476DC313889D5DF2255097067EDC02E97EECBC2B42C8B3072171540320745994C42BF7F3E67E47DC20859C2BA02E722B22568E26BC8429480EC1C95B1F02A14BEA48CC51961AC8DDD35702CA814530D4C8125762655125D67EA6B38570D779EBFD6C3C53636CB65B92F4AE27632C7EB15588A537E1619BD3125F7F80CB80E53DE0C998AFDCF02D07D1FC6DE140C462A9C868742BD8FB256CF2F231A3DB45D54C407D262B4365A5A84CA4243327A31A792F56AE9376C56FC84E63FFC079E85EEC6B866465EED66D95520448D74B09F20E450F4B6B116E85A2BC9C0DEAF6DC0063841E49E8C17478E67F28DB7451D97AF0B82996094808B14A2AD0523D75ECDEC9B1E44FDD44D821591439B13ED851AE532FE70447E6504F455FB9D5F7E4FDA0736D6C3F5895C6A474CDEF2A2213A698E101FFA89D6325C37E0FBABAE6DBA6064FA33479C7C2055C2B245A609A57DE4B254A4ECA9DA97ECB288510F94BE8DCC76520874E76930FFD61AFAD808374C916E3A08B1F2EF6BE8070816109743182020F3082020B02010130683060310B30090603550406130253473121301F060355040A0C184D696E6973747279206F6620486F6D652041666661697273310C300A060355040B0C034943413120301E06035504030C1753696E6761706F72652050617373706F7274204341203502045FCDC27C300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D01090431220420F990482CF40E723640E3B80910805150E5F5E461FC94C147FB47524D0055445D304106092A864886F70D01010A3034A00F300D06096086480165030402010500A11C301A06092A864886F70D010108300D06096086480165030402010500A2030201200482010038D6B5B0DBDCB5CBE3C196613EF5A7311BF391AEA6DED3AACC763AF849AE8D166FA627658F051B18FC119E430B9E1578BF6A9ED5CD6978701FB81D26735D623D835233EA8613E0A96226E048A02BCD776742BB5CB4D97008608B140DF58F15E0900FBE433C0A370F99D77D057F19FEF490297FBD525AF0D8D0F4AC64DB54489009D68FABD416237B2C90C7E98402FF04DAA6CAD7D08933A78D26D2FE111643F1B530DE43DF71AE701EF960B273DF6B0B9A664AA01ED4D601A2C2192185E1E8729C386A89DDB47101DDE606DEEFD8F6815D598601FB6943DA2BB5B044FA034C770DF2529D6379A6D5189328E3C04936833E7BBE9E65DEA4CE103D8494EFADB04F"),
			expLdsVersion:     "0108",
			expUnicodeVersion: "040000",
		},
		{
			// tests the Lds/Unicode version when only EF.COM is present (i.e. no EF.SOD)
			// modified from EF.COM test (9303-p10) (LdsVer:1234, UnicodeVer:654321)
			comBytes:          utils.HexToBytes("60145F0104313233345F36063635343332315C026175"),
			sodBytes:          []byte{},
			expLdsVersion:     "1234",
			expUnicodeVersion: "654321",
		},
	}
	for _, tc := range testCases {
		var doc Document

		if len(tc.comBytes) > 0 {
			var err error
			doc.Mf.Lds1.Com, err = NewCOM(tc.comBytes)
			if err != nil {
				t.Errorf("Unexpected error: %s", err)
			}
		}

		if len(tc.sodBytes) > 0 {
			var err error
			doc.Mf.Lds1.Sod, err = NewSOD(tc.sodBytes)
			if err != nil {
				t.Errorf("Unexpected error: %s", err)
			}
		}

		{
			ldsVersion := doc.LdsVersion()
			if ldsVersion != tc.expLdsVersion {
				t.Errorf("Incorrect LdsVersion (Exp:%s, Act:%s)", tc.expLdsVersion, ldsVersion)
			}
		}

		{
			unicodeVersion := doc.UnicodeVersion()
			if unicodeVersion != tc.expUnicodeVersion {
				t.Errorf("Incorrect UnicodeVersion (Exp:%s, Act:%s)", tc.expUnicodeVersion, unicodeVersion)
			}
		}

		// verify that we can generate JSON without any error
		{
			tmpJson := doc.IndentedJson()
			if len(tmpJson) <= 0 {
				t.Errorf("Expected some JSON data for the Document")
			}
		}
	}
}

func TestNewDgInvalid(t *testing.T) {
	var doc Document

	// NB DG 17 is not supported
	err := doc.NewDG(17, []byte{0, 1, 2, 3, 4, 5, 6, 7, 8})

	if err == nil {
		t.Errorf("Error expected")
	}

}

func TestParseDateYYYYMMDD(t *testing.T) {
	testCases := []struct {
		act []byte
		exp string
	}{
		{
			act: []byte{0x20, 0x25, 0x03, 0x08},
			exp: "20250308",
		},
		{
			act: []byte{'2', '0', '2', '4', '0', '2', '2', '9'},
			exp: "20240229",
		},
	}

	for _, tc := range testCases {
		tmpDate := parseDateYYYYMMDD(tc.act)

		if strings.Compare(tmpDate, tc.exp) != 0 {
			t.Errorf("Unexpected value (Exp:%s, Act:%s)", tc.exp, tmpDate)
		}
	}
}

func TestParseDateYYYYMMDDHHMISS(t *testing.T) {
	testCases := []struct {
		act []byte
		exp string
	}{
		{
			act: []byte{0x20, 0x25, 0x03, 0x08, 0x19, 0x23, 0x59},
			exp: "20250308192359",
		},
		{
			act: []byte{'2', '0', '2', '4', '0', '2', '2', '9', '1', '0', '2', '4', '1', '3'},
			exp: "20240229102413",
		},
	}

	for _, tc := range testCases {
		tmpDatetime := parseDatetimeYYYYMMDDHHMISS(tc.act)

		if strings.Compare(tmpDatetime, tc.exp) != 0 {
			t.Errorf("Unexpected value (Exp:%s, Act:%s)", tc.exp, tmpDatetime)
		}
	}
}

func TestDgHashesNoDGs(t *testing.T) {
	var sod []byte = utils.HexToBytes("778207853082078106092A864886F70D010702A08207723082076E020103310D300B0609608648016503040201306E0606678108010101A06404623060020100300B0609608648016503040201304E30250201010420CA34A2808CA60C6671EC66F4E1229ADF0474BF1A7E099A05946B999438D511AD302502010204205F03553723906ACBE6B68B52F639F73B9F9E3C3135BC87E6E3D511C922AC7D20A08204F8308204F4308202DCA0030201020204492EBA13300D06092A864886F70D01010B05003041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479301E170D3131303830313132353535335A170D3232313230313031323535335A304F310B3009060355040613026762310D300B060355040A1304756B7073310F300D060355040B13066C6F6E646F6E3120301E06035504031317446F63756D656E74205369676E696E67204B657920333530820122300D06092A864886F70D01010105000382010F003082010A0282010100CE65C9D95D8FADB3C2AEABAB99220F96B5880F69AE651B3A7A378E293099B343BD1CB58FD28F0FD2F0166EA05273ECA9A3BE315397A7C6951C3FD09DCFF864C5F4B763F89851C8F9632E63D819C9EC905B90DA9D78FE0376F7218FE4B51EE88C66ECED44F4F98FEDFDBDD920484DA7AEE39E199196895DDC2C58ECF16B72D6E84770DE10793434C42FE01B8E7FC5DB7C38D7ACDEC5C1476CF1E69152E9D31CAEC122AF71280078AE054509F1CFEFC1340797FDAFCEAE5B4CBA8EDC7AB391DE69649CF9A33CA2596718E887C948EEA60BD99AA0E80C88FF94FA6FB78EEFAE98F4EC2CACC201D7EED96126292A23C4F9452D5EFF66333CC6DBE3E2EEDC3EC360DF0203010001A381E53081E2302B0603551D1004243022800F32303131303830313133323535335A810F32303131313130333133323535335A300E0603551D0F0101FF04040302078030630603551D1F045C305A3058A056A054A4523050310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479310D300B0603550403130443524C34301F0603551D230418301680144531A5B73BCF8BB27C7FAC88C74B4505F6C936B3301D0603551D0E0416041467B8149943C5F8C949BC846A34DBE7E05D241404300D06092A864886F70D01010B050003820201005BFB66391196171815A26AE99FD1653B7F6C9FFB751BBD69ADEF0B4182C043C4726FD826C8011BF12DA9374A79963613672C84289671EC31D53CA73E23E0A119F884B5D5836CE1F9DD03787624ABBDFEF475F16D5BFFFD719DE0B0FD1C0FE9D0E8064C6F77372CBBB00E1E43715A157EFB5F3D97E60A5018B6F07E7C735067FC73480B393D8945D09ED79F3D9C3F6299B7F2A2FC5829ABCE927C23010FE74788AF2AC7D38A08075C4559E256ECF8CB62BC27316FB477A79653A836EC03032CFA2FDF009EE6C9B5A102C91C381C0B941952A22AF5DAF9552A8A7F70D1F5847C8D3762CC7A2C0B44CC12A74C6CB410985641979B4CAD092A199A7371716592B9BC0A8691B60D830E13E749B31FFE120E0E2C98E2DE1C745ED16D3D2DF7205DDDC34C1B06413C28C9DC11C1F03F3E0A20321D8ACC13183EE003CE36DCA354E8053145F6055451C3F6A2A8E40998C5EF40609E431894C524CA9A7523B8B3BD667BD09F1F9E0EAC7602E1B8758F82EE61DA953E9B188ADF5A382D23EE4137F50B0A7AE8833AF55D5F0DD9E6E5D71B2A2543FBFAA2F7902D8E1BD656B6654264E108792E70C68227CE7F58C5C866D5CCFD3572941F21CFC2AA85EAEC84B4C6988C75BEC1711F11149356DC40119F4B023154BCED5B581FD71FEC2BC106D737E8D1F9704C5686A182C0148CA90B93CA17DD2797FBA2619F69D3F8474BC9D9493A33F45A318201EC308201E802010130493041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F726974790204492EBA13300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D010904312204206A2DFFE58D6A59A5AAE942C2BAF9A585B4B20E63C4B7ED0CE4B497FFC7F80992303D06092A864886F70D01010A3030A00D300B0609608648016503040201A11A301806092A864886F70D010108300B0609608648016503040201A203020120048201007465E8179610CC7D48D7F2AB0A88FD939E5CAB0D7226874F5647AA1A97911CF61DED88DA44D1AEC330C7045E3B5DFB7A79F19698C12D659BC37B8E98375D130ADEC2BD6688A57C996D9FC2DC8E0E2594BFA3E43E4FD7E63A7895435182D566F749C39FB4E948658E58769F871E665FA92C4C620DF2940DA028C72F2B05B4FA35E16201BD912AB7F6E4C07116E6086724C2009C2C29C2B83050546EE29CB162B975EF2A9718CDEC2737518D282CBA5B11A95707EA3DC915047A8906181B3E4FE823EA34A5C1BF7A93D5510EA8A7A355385C344E76647EF73AFF9270CC678D6DBAD06088C950E2BFC2DF382E48D765ACC6E4207E09457011AC72EBB4DBABB81611")

	var err error
	var doc Document

	doc.Mf.Lds1.Sod, err = NewSOD(sod)
	if err != nil {
		t.Fatalf("Unexpected error: %s", err)
	}

	hashes, err := doc.DgHashes()
	if err != nil {
		t.Fatalf("Unexpected error: %s", err)
	}

	if len(hashes) != 0 {
		t.Errorf("Expected 0 hashes for document with no DGs")
	}
}

func TestDgHashesMixAndMatchDGs(t *testing.T) {
	// NB DGs are mix-and-match from other UTs, but this shouldn't matter for the purpose of this test
	var sod []byte = utils.HexToBytes("778207853082078106092A864886F70D010702A08207723082076E020103310D300B0609608648016503040201306E0606678108010101A06404623060020100300B0609608648016503040201304E30250201010420CA34A2808CA60C6671EC66F4E1229ADF0474BF1A7E099A05946B999438D511AD302502010204205F03553723906ACBE6B68B52F639F73B9F9E3C3135BC87E6E3D511C922AC7D20A08204F8308204F4308202DCA0030201020204492EBA13300D06092A864886F70D01010B05003041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479301E170D3131303830313132353535335A170D3232313230313031323535335A304F310B3009060355040613026762310D300B060355040A1304756B7073310F300D060355040B13066C6F6E646F6E3120301E06035504031317446F63756D656E74205369676E696E67204B657920333530820122300D06092A864886F70D01010105000382010F003082010A0282010100CE65C9D95D8FADB3C2AEABAB99220F96B5880F69AE651B3A7A378E293099B343BD1CB58FD28F0FD2F0166EA05273ECA9A3BE315397A7C6951C3FD09DCFF864C5F4B763F89851C8F9632E63D819C9EC905B90DA9D78FE0376F7218FE4B51EE88C66ECED44F4F98FEDFDBDD920484DA7AEE39E199196895DDC2C58ECF16B72D6E84770DE10793434C42FE01B8E7FC5DB7C38D7ACDEC5C1476CF1E69152E9D31CAEC122AF71280078AE054509F1CFEFC1340797FDAFCEAE5B4CBA8EDC7AB391DE69649CF9A33CA2596718E887C948EEA60BD99AA0E80C88FF94FA6FB78EEFAE98F4EC2CACC201D7EED96126292A23C4F9452D5EFF66333CC6DBE3E2EEDC3EC360DF0203010001A381E53081E2302B0603551D1004243022800F32303131303830313133323535335A810F32303131313130333133323535335A300E0603551D0F0101FF04040302078030630603551D1F045C305A3058A056A054A4523050310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479310D300B0603550403130443524C34301F0603551D230418301680144531A5B73BCF8BB27C7FAC88C74B4505F6C936B3301D0603551D0E0416041467B8149943C5F8C949BC846A34DBE7E05D241404300D06092A864886F70D01010B050003820201005BFB66391196171815A26AE99FD1653B7F6C9FFB751BBD69ADEF0B4182C043C4726FD826C8011BF12DA9374A79963613672C84289671EC31D53CA73E23E0A119F884B5D5836CE1F9DD03787624ABBDFEF475F16D5BFFFD719DE0B0FD1C0FE9D0E8064C6F77372CBBB00E1E43715A157EFB5F3D97E60A5018B6F07E7C735067FC73480B393D8945D09ED79F3D9C3F6299B7F2A2FC5829ABCE927C23010FE74788AF2AC7D38A08075C4559E256ECF8CB62BC27316FB477A79653A836EC03032CFA2FDF009EE6C9B5A102C91C381C0B941952A22AF5DAF9552A8A7F70D1F5847C8D3762CC7A2C0B44CC12A74C6CB410985641979B4CAD092A199A7371716592B9BC0A8691B60D830E13E749B31FFE120E0E2C98E2DE1C745ED16D3D2DF7205DDDC34C1B06413C28C9DC11C1F03F3E0A20321D8ACC13183EE003CE36DCA354E8053145F6055451C3F6A2A8E40998C5EF40609E431894C524CA9A7523B8B3BD667BD09F1F9E0EAC7602E1B8758F82EE61DA953E9B188ADF5A382D23EE4137F50B0A7AE8833AF55D5F0DD9E6E5D71B2A2543FBFAA2F7902D8E1BD656B6654264E108792E70C68227CE7F58C5C866D5CCFD3572941F21CFC2AA85EAEC84B4C6988C75BEC1711F11149356DC40119F4B023154BCED5B581FD71FEC2BC106D737E8D1F9704C5686A182C0148CA90B93CA17DD2797FBA2619F69D3F8474BC9D9493A33F45A318201EC308201E802010130493041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F726974790204492EBA13300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D010904312204206A2DFFE58D6A59A5AAE942C2BAF9A585B4B20E63C4B7ED0CE4B497FFC7F80992303D06092A864886F70D01010A3030A00D300B0609608648016503040201A11A301806092A864886F70D010108300B0609608648016503040201A203020120048201007465E8179610CC7D48D7F2AB0A88FD939E5CAB0D7226874F5647AA1A97911CF61DED88DA44D1AEC330C7045E3B5DFB7A79F19698C12D659BC37B8E98375D130ADEC2BD6688A57C996D9FC2DC8E0E2594BFA3E43E4FD7E63A7895435182D566F749C39FB4E948658E58769F871E665FA92C4C620DF2940DA028C72F2B05B4FA35E16201BD912AB7F6E4C07116E6086724C2009C2C29C2B83050546EE29CB162B975EF2A9718CDEC2737518D282CBA5B11A95707EA3DC915047A8906181B3E4FE823EA34A5C1BF7A93D5510EA8A7A355385C344E76647EF73AFF9270CC678D6DBAD06088C950E2BFC2DF382E48D765ACC6E4207E09457011AC72EBB4DBABB81611")

	dgArr := []struct {
		dg   int
		data []byte
	}{
		{
			dg:   1,
			data: utils.HexToBytes("614B5F1F48493C55544F4552494B53534F4E3C3C414E4E413C4D415249413C3C3C3C3C3C3C3C3C3C3C4432333134353839303755544F3734303831323246313230343135393C3C3C3C3C3C3C36"),
		},
		{
			dg:   2,
			data: utils.HexToBytes("758214397f618214340201017f6082142ca10c8002010187020101880200085f2e82141946414300303130000000141900010000140b00000000000000000000000000000000020100940046000000000000ffd8ffe000104a46494600010201004800480000ffe100e84578696600004d4d002a000000080006011200030000000100010000011a00050000000100000056011b0005000000010000005e012800030000000100020000021300030000000100010000876900040000000100000066000000000000009000000001000000900000000100089000000700000004303232319101000700000004010203009286000700000012000000cca00000070000000430313030a00100030000000100010000a00200040000000100000094a00300040000000100000046a4060003000000010000000000000000415343494900000053637265656e73686f740000ffe20d144943435f50524f46494c4500010100000d046170706c021000006d6e74725247422058595a2007e800010001001100310009616373704150504c000000004150504c000000000000000000000000000000000000f6d6000100000000d32d6170706c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000116465736300000150000000626473636d000001b4000001e063707274000003940000002377747074000003b8000000147258595a000003cc000000146758595a000003e0000000146258595a000003f40000001472545243000004080000080c6161726700000c14000000207663677400000c34000000306e64696e00000c640000003e6d6d6f6400000ca4000000287663677000000ccc0000003862545243000004080000080c67545243000004080000080c6161626700000c14000000206161676700000c1400000020646573630000000000000008446973706c61790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006d6c756300000000000000260000000c6872485200000008000001d86b6f4b5200000008000001d86e624e4f00000008000001d86964000000000008000001d86875485500000008000001d86373435a00000008000001d86461444b00000008000001d86e6c4e4c00000008000001d86669464900000008000001d86974495400000008000001d86573455300000008000001d8726f524f00000008000001d86672434100000008000001d86172000000000008000001d8756b554100000008000001d86865494c00000008000001d87a68545700000008000001d87669564e00000008000001d8736b534b00000008000001d87a68434e00000008000001d87275525500000008000001d8656e474200000008000001d86672465200000008000001d86d73000000000008000001d86869494e00000008000001d87468544800000008000001d86361455300000008000001d8656e415500000008000001d86573584c00000008000001d86465444500000008000001d8656e555300000008000001d87074425200000008000001d8706c504c00000008000001d8656c475200000008000001d87376534500000008000001d87472545200000008000001d87074505400000008000001d86a614a5000000008000001d80069004d006100637465787400000000436f70797269676874204170706c6520496e632e2c2032303234000058595a20000000000000f31600010000000116ca58595a2000000000000082ca00003cb7fffffffe58595a200000000000004c4a0000b4df00000aeb58595a2000000000000027c200000e6b0000c84463757276000000000000040000000005000a000f00140019001e00230028002d00320036003b00400045004a004f00540059005e00630068006d00720077007c00810086008b00900095009a009f00a300a800ad00b200b700bc00c100c600cb00d000d500db00e000e500eb00f000f600fb01010107010d01130119011f0125012b01320138013e0145014c0152015901600167016e0175017c0183018b0192019a01a101a901b101b901c101c901d101d901e101e901f201fa0203020c0214021d0226022f02380241024b0254025d02670271027a0284028e029802a202ac02b602c102cb02d502e002eb02f50300030b03160321032d03380343034f035a03660372037e038a039603a203ae03ba03c703d303e003ec03f9040604130420042d043b0448045504630471047e048c049a04a804b604c404d304e104f004fe050d051c052b053a05490558056705770586059605a605b505c505d505e505f6060606160627063706480659066a067b068c069d06af06c006d106e306f507070719072b073d074f076107740786079907ac07bf07d207e507f8080b081f08320846085a086e0882089608aa08be08d208e708fb09100925093a094f09640979098f09a409ba09cf09e509fb0a110a270a3d0a540a6a0a810a980aae0ac50adc0af30b0b0b220b390b510b690b800b980bb00bc80be10bf90c120c2a0c430c5c0c750c8e0ca70cc00cd90cf30d0d0d260d400d5a0d740d8e0da90dc30dde0df80e130e2e0e490e640e7f0e9b0eb60ed20eee0f090f250f410f5e0f7a0f960fb30fcf0fec1009102610431061107e109b10b910d710f511131131114f116d118c11aa11c911e81207122612451264128412a312c312e31303132313431363138313a413c513e5140614271449146a148b14ad14ce14f01512153415561578159b15bd15e0160316261649166c168f16b216d616fa171d17411765178917ae17d217f7181b18401865188a18af18d518fa19201945196b199119b719dd1a041a2a1a511a771a9e1ac51aec1b141b3b1b631b8a1bb21bda1c021c2a1c521c7b1ca31ccc1cf51d1e1d471d701d991dc31dec1e161e401e6a1e941ebe1ee91f131f3e1f691f941fbf1fea20152041206c209820c420f0211c2148217521a121ce21fb22272255228222af22dd230a23382366239423c223f0241f244d247c24ab24da250925382568259725c725f726272657268726b726e827182749277a27ab27dc280d283f287128a228d429062938296b299d29d02a022a352a682a9b2acf2b022b362b692b9d2bd12c052c392c6e2ca22cd72d0c2d412d762dab2de12e162e4c2e822eb72eee2f242f5a2f912fc72ffe3035306c30a430db3112314a318231ba31f2322a3263329b32d4330d3346337f33b833f1342b3465349e34d83513354d358735c235fd3637367236ae36e937243760379c37d738143850388c38c839053942397f39bc39f93a363a743ab23aef3b2d3b6b3baa3be83c273c653ca43ce33d223d613da13de03e203e603ea03ee03f213f613fa23fe24023406440a640e74129416a41ac41ee4230427242b542f7433a437d43c044034447448a44ce45124555459a45de4622466746ab46f04735477b47c04805484b489148d7491d496349a949f04a374a7d4ac44b0c4b534b9a4be24c2a4c724cba4d024d4a4d934ddc4e254e6e4eb74f004f494f934fdd5027507150bb51065150519b51e65231527c52c75313535f53aa53f65442548f54db5528557555c2560f565c56a956f75744579257e0582f587d58cb591a596959b85a075a565aa65af55b455b955be55c355c865cd65d275d785dc95e1a5e6c5ebd5f0f5f615fb36005605760aa60fc614f61a261f56249629c62f06343639763eb6440649464e9653d659265e7663d669266e8673d679367e9683f689668ec6943699a69f16a486a9f6af76b4f6ba76bff6c576caf6d086d606db96e126e6b6ec46f1e6f786fd1702b708670e0713a719571f0724b72a67301735d73b87414747074cc7528758575e1763e769b76f8775677b37811786e78cc792a798979e77a467aa57b047b637bc27c217c817ce17d417da17e017e627ec27f237f847fe5804780a8810a816b81cd8230829282f4835783ba841d848084e3854785ab860e867286d7873b879f8804886988ce8933899989fe8a648aca8b308b968bfc8c638cca8d318d988dff8e668ece8f368f9e9006906e90d6913f91a89211927a92e3934d93b69420948a94f4955f95c99634969f970a977597e0984c98b89924999099fc9a689ad59b429baf9c1c9c899cf79d649dd29e409eae9f1d9f8b9ffaa069a0d8a147a1b6a226a296a306a376a3e6a456a4c7a538a5a9a61aa68ba6fda76ea7e0a852a8c4a937a9a9aa1caa8fab02ab75abe9ac5cacd0ad44adb8ae2daea1af16af8bb000b075b0eab160b1d6b24bb2c2b338b3aeb425b49cb513b58ab601b679b6f0b768b7e0b859b8d1b94ab9c2ba3bbab5bb2ebba7bc21bc9bbd15bd8fbe0abe84beffbf7abff5c070c0ecc167c1e3c25fc2dbc358c3d4c451c4cec54bc5c8c646c6c3c741c7bfc83dc8bcc93ac9b9ca38cab7cb36cbb6cc35ccb5cd35cdb5ce36ceb6cf37cfb8d039d0bad13cd1bed23fd2c1d344d3c6d449d4cbd54ed5d1d655d6d8d75cd7e0d864d8e8d96cd9f1da76dafbdb80dc05dc8add10dd96de1cdea2df29dfafe036e0bde144e1cce253e2dbe363e3ebe473e4fce584e60de696e71fe7a9e832e8bce946e9d0ea5beae5eb70ebfbec86ed11ed9cee28eeb4ef40efccf058f0e5f172f1fff28cf319f3a7f434f4c2f550f5def66df6fbf78af819f8a8f938f9c7fa57fae7fb77fc07fc98fd29fdbafe4bfedcff6dffff706172610000000000030000000266660000f2a700000d59000013d000000a5b7663677400000000000000010001000000000000000100000001000000000000000100000001000000000000000100006e64696e00000000000000360000ae4000005140000043c00000b0c00000268000000d80000050000000544000023333000233330002333300000000000000006d6d6f6400000000000006100000ae1f50e5a070d478cfdd000000000000000000000000000000007663677000000000000300000002666600030000000266660003000000026666000000023333340000000002333334000000000233333400ffc00011080046009403012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffdb0043001c1c1c1c1c1c301c1c3044303030445c444444445c745c5c5c5c5c748c7474747474748c8c8c8c8c8c8c8ca8a8a8a8a8a8c4c4c4c4c4dcdcdcdcdcdcdcdcdcdcffdb00430122242438343860343460e69c809ce6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6ffdd0004000affda000c03010002110311003f00e928a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a00ffd0e928a28a0028a4240193c01598dac5886c6e247a8071401a9512cf0bb98d1d59875008c8c551b2bd9ef1cb795b61c1c313c920d7385a686f66ba879f2a439fa126803b6a89e786260b23aa93d0120669a97313db8b907e4c6ecd71f3c92dcdc25db8c2c8f85fa291fe3401dabba46a5e460aa3b9e0541f6db3ff009ec9ff007d0aabac7fc83e4ff80ff3155acb4cb29ad239248f2ccb92727fc6803691d241ba360c3d41cd41f6db3ff9ec9ff7d0ac258bec1ab2436ec76498c8fae7f975ab977a658c76d2c891e195490727ae3eb401a1f6db3ff9ec9ff7d0a95a7851048eea15ba12460d61699a7d9dc5a09664dcc49e7247f234fd6d163b28a3418556000f600d006b0bdb33c0993fefa1561595c6e52083dc565269360f12931f240e727fc6b3668a4d1a759a062d0b9c153fcbfc2803a8a2914860197907914b40051451401fffd1e928a28a00a3a9a48f632ac7c9c76f4cf354aceef4f4d3d51d946170ca7a93df8ef9ab7aab05b1932db32303dfdbf1ac4b78ee846ae2ca3718e091c9f7393fd28034743575b462dc2b312bf4c0a834d4592f2f11c65589047e26af58df8b976b778fca9107ddf6aafa6c52c77b72ee8ca198e09180793d280330db5e24a74b5cf94cdbb38edfe7f5ab5ab46909b48a31855240ff00c76ba4ac3d5e196596dcc68cc158e7009c74a00b3ac7fc83e4ff0080ff003159d6b06aed6c860991508e01eb8ffbe6b4f554792c5d2352cc71c0193d454d60ac96712b82085e41e0d0062e9a025fbc77809b8ecc4e7f2fc2b6efbfe3ce6ff71bf95666a30ca97d05dc28cd8e1b6827a1f6f635a978acf692aa824942001f4a00a5a2ff00c782ff00bc7f9d43af7fc7aa7fbe3f91ab3a44724564a92295393c118350eb714b2db22c4a5c87ce1467b1a00d587fd527fba3f95646bcca2d154f52e31f91a62ea37ca8116cdf2063273fe14c4b3bcbf9d67bf1b117a27f9fd68036ed815b6895ba845cfe553514500145145007ffd2e928a28a00a77f69f6db730e7690720fb8aa49fdb51a88f113638dc7fc8fe55b345006658d8c90caf7572c1a57e0e3a015a745140051451400514514005145140051451400514514005145140051451401ffd3e928a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a00ffd9"),
		},
		{
			dg:   7,
			data: utils.HexToBytes("678213f30201015f438213ebffd8ffe000104a46494600010201004800480000ffe100e84578696600004d4d002a000000080006011200030000000100010000011a00050000000100000056011b0005000000010000005e012800030000000100020000021300030000000100010000876900040000000100000066000000000000009000000001000000900000000100089000000700000004303232319101000700000004010203009286000700000012000000cca00000070000000430313030a00100030000000100010000a00200040000000100000094a00300040000000100000046a4060003000000010000000000000000415343494900000053637265656e73686f740000ffe20d144943435f50524f46494c4500010100000d046170706c021000006d6e74725247422058595a2007e800010001001100310009616373704150504c000000004150504c000000000000000000000000000000000000f6d6000100000000d32d6170706c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000116465736300000150000000626473636d000001b4000001e063707274000003940000002377747074000003b8000000147258595a000003cc000000146758595a000003e0000000146258595a000003f40000001472545243000004080000080c6161726700000c14000000207663677400000c34000000306e64696e00000c640000003e6d6d6f6400000ca4000000287663677000000ccc0000003862545243000004080000080c67545243000004080000080c6161626700000c14000000206161676700000c1400000020646573630000000000000008446973706c61790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006d6c756300000000000000260000000c6872485200000008000001d86b6f4b5200000008000001d86e624e4f00000008000001d86964000000000008000001d86875485500000008000001d86373435a00000008000001d86461444b00000008000001d86e6c4e4c00000008000001d86669464900000008000001d86974495400000008000001d86573455300000008000001d8726f524f00000008000001d86672434100000008000001d86172000000000008000001d8756b554100000008000001d86865494c00000008000001d87a68545700000008000001d87669564e00000008000001d8736b534b00000008000001d87a68434e00000008000001d87275525500000008000001d8656e474200000008000001d86672465200000008000001d86d73000000000008000001d86869494e00000008000001d87468544800000008000001d86361455300000008000001d8656e415500000008000001d86573584c00000008000001d86465444500000008000001d8656e555300000008000001d87074425200000008000001d8706c504c00000008000001d8656c475200000008000001d87376534500000008000001d87472545200000008000001d87074505400000008000001d86a614a5000000008000001d80069004d006100637465787400000000436f70797269676874204170706c6520496e632e2c2032303234000058595a20000000000000f31600010000000116ca58595a2000000000000082ca00003cb7fffffffe58595a200000000000004c4a0000b4df00000aeb58595a2000000000000027c200000e6b0000c84463757276000000000000040000000005000a000f00140019001e00230028002d00320036003b00400045004a004f00540059005e00630068006d00720077007c00810086008b00900095009a009f00a300a800ad00b200b700bc00c100c600cb00d000d500db00e000e500eb00f000f600fb01010107010d01130119011f0125012b01320138013e0145014c0152015901600167016e0175017c0183018b0192019a01a101a901b101b901c101c901d101d901e101e901f201fa0203020c0214021d0226022f02380241024b0254025d02670271027a0284028e029802a202ac02b602c102cb02d502e002eb02f50300030b03160321032d03380343034f035a03660372037e038a039603a203ae03ba03c703d303e003ec03f9040604130420042d043b0448045504630471047e048c049a04a804b604c404d304e104f004fe050d051c052b053a05490558056705770586059605a605b505c505d505e505f6060606160627063706480659066a067b068c069d06af06c006d106e306f507070719072b073d074f076107740786079907ac07bf07d207e507f8080b081f08320846085a086e0882089608aa08be08d208e708fb09100925093a094f09640979098f09a409ba09cf09e509fb0a110a270a3d0a540a6a0a810a980aae0ac50adc0af30b0b0b220b390b510b690b800b980bb00bc80be10bf90c120c2a0c430c5c0c750c8e0ca70cc00cd90cf30d0d0d260d400d5a0d740d8e0da90dc30dde0df80e130e2e0e490e640e7f0e9b0eb60ed20eee0f090f250f410f5e0f7a0f960fb30fcf0fec1009102610431061107e109b10b910d710f511131131114f116d118c11aa11c911e81207122612451264128412a312c312e31303132313431363138313a413c513e5140614271449146a148b14ad14ce14f01512153415561578159b15bd15e0160316261649166c168f16b216d616fa171d17411765178917ae17d217f7181b18401865188a18af18d518fa19201945196b199119b719dd1a041a2a1a511a771a9e1ac51aec1b141b3b1b631b8a1bb21bda1c021c2a1c521c7b1ca31ccc1cf51d1e1d471d701d991dc31dec1e161e401e6a1e941ebe1ee91f131f3e1f691f941fbf1fea20152041206c209820c420f0211c2148217521a121ce21fb22272255228222af22dd230a23382366239423c223f0241f244d247c24ab24da250925382568259725c725f726272657268726b726e827182749277a27ab27dc280d283f287128a228d429062938296b299d29d02a022a352a682a9b2acf2b022b362b692b9d2bd12c052c392c6e2ca22cd72d0c2d412d762dab2de12e162e4c2e822eb72eee2f242f5a2f912fc72ffe3035306c30a430db3112314a318231ba31f2322a3263329b32d4330d3346337f33b833f1342b3465349e34d83513354d358735c235fd3637367236ae36e937243760379c37d738143850388c38c839053942397f39bc39f93a363a743ab23aef3b2d3b6b3baa3be83c273c653ca43ce33d223d613da13de03e203e603ea03ee03f213f613fa23fe24023406440a640e74129416a41ac41ee4230427242b542f7433a437d43c044034447448a44ce45124555459a45de4622466746ab46f04735477b47c04805484b489148d7491d496349a949f04a374a7d4ac44b0c4b534b9a4be24c2a4c724cba4d024d4a4d934ddc4e254e6e4eb74f004f494f934fdd5027507150bb51065150519b51e65231527c52c75313535f53aa53f65442548f54db5528557555c2560f565c56a956f75744579257e0582f587d58cb591a596959b85a075a565aa65af55b455b955be55c355c865cd65d275d785dc95e1a5e6c5ebd5f0f5f615fb36005605760aa60fc614f61a261f56249629c62f06343639763eb6440649464e9653d659265e7663d669266e8673d679367e9683f689668ec6943699a69f16a486a9f6af76b4f6ba76bff6c576caf6d086d606db96e126e6b6ec46f1e6f786fd1702b708670e0713a719571f0724b72a67301735d73b87414747074cc7528758575e1763e769b76f8775677b37811786e78cc792a798979e77a467aa57b047b637bc27c217c817ce17d417da17e017e627ec27f237f847fe5804780a8810a816b81cd8230829282f4835783ba841d848084e3854785ab860e867286d7873b879f8804886988ce8933899989fe8a648aca8b308b968bfc8c638cca8d318d988dff8e668ece8f368f9e9006906e90d6913f91a89211927a92e3934d93b69420948a94f4955f95c99634969f970a977597e0984c98b89924999099fc9a689ad59b429baf9c1c9c899cf79d649dd29e409eae9f1d9f8b9ffaa069a0d8a147a1b6a226a296a306a376a3e6a456a4c7a538a5a9a61aa68ba6fda76ea7e0a852a8c4a937a9a9aa1caa8fab02ab75abe9ac5cacd0ad44adb8ae2daea1af16af8bb000b075b0eab160b1d6b24bb2c2b338b3aeb425b49cb513b58ab601b679b6f0b768b7e0b859b8d1b94ab9c2ba3bbab5bb2ebba7bc21bc9bbd15bd8fbe0abe84beffbf7abff5c070c0ecc167c1e3c25fc2dbc358c3d4c451c4cec54bc5c8c646c6c3c741c7bfc83dc8bcc93ac9b9ca38cab7cb36cbb6cc35ccb5cd35cdb5ce36ceb6cf37cfb8d039d0bad13cd1bed23fd2c1d344d3c6d449d4cbd54ed5d1d655d6d8d75cd7e0d864d8e8d96cd9f1da76dafbdb80dc05dc8add10dd96de1cdea2df29dfafe036e0bde144e1cce253e2dbe363e3ebe473e4fce584e60de696e71fe7a9e832e8bce946e9d0ea5beae5eb70ebfbec86ed11ed9cee28eeb4ef40efccf058f0e5f172f1fff28cf319f3a7f434f4c2f550f5def66df6fbf78af819f8a8f938f9c7fa57fae7fb77fc07fc98fd29fdbafe4bfedcff6dffff706172610000000000030000000266660000f2a700000d59000013d000000a5b7663677400000000000000010001000000000000000100000001000000000000000100000001000000000000000100006e64696e00000000000000360000ae4000005140000043c00000b0c00000268000000d80000050000000544000023333000233330002333300000000000000006d6d6f6400000000000006100000ae1f50e5a070d478cfdd000000000000000000000000000000007663677000000000000300000002666600030000000266660003000000026666000000023333340000000002333334000000000233333400ffc00011080046009403012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffdb0043001c1c1c1c1c1c301c1c3044303030445c444444445c745c5c5c5c5c748c7474747474748c8c8c8c8c8c8c8ca8a8a8a8a8a8c4c4c4c4c4dcdcdcdcdcdcdcdcdcdcffdb00430122242438343860343460e69c809ce6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6e6ffdd0004000affda000c03010002110311003f00e928a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a00ffd0e928a28a0028a4240193c01598dac5886c6e247a8071401a9512cf0bb98d1d59875008c8c551b2bd9ef1cb795b61c1c313c920d7385a686f66ba879f2a439fa126803b6a89e786260b23aa93d0120669a97313db8b907e4c6ecd71f3c92dcdc25db8c2c8f85fa291fe3401dabba46a5e460aa3b9e0541f6db3ff009ec9ff007d0aabac7fc83e4ff80ff3155acb4cb29ad239248f2ccb92727fc6803691d241ba360c3d41cd41f6db3ff9ec9ff7d0ac258bec1ab2436ec76498c8fae7f975ab977a658c76d2c891e195490727ae3eb401a1f6db3ff9ec9ff7d0a95a7851048eea15ba12460d61699a7d9dc5a09664dcc49e7247f234fd6d163b28a3418556000f600d006b0bdb33c0993fefa1561595c6e52083dc565269360f12931f240e727fc6b3668a4d1a759a062d0b9c153fcbfc2803a8a2914860197907914b40051451401fffd1e928a28a00a3a9a48f632ac7c9c76f4cf354aceef4f4d3d51d946170ca7a93df8ef9ab7aab05b1932db32303dfdbf1ac4b78ee846ae2ca3718e091c9f7393fd28034743575b462dc2b312bf4c0a834d4592f2f11c65589047e26af58df8b976b778fca9107ddf6aafa6c52c77b72ee8ca198e09180793d280330db5e24a74b5cf94cdbb38edfe7f5ab5ab46909b48a31855240ff00c76ba4ac3d5e196596dcc68cc158e7009c74a00b3ac7fc83e4ff0080ff003159d6b06aed6c860991508e01eb8ffbe6b4f554792c5d2352cc71c0193d454d60ac96712b82085e41e0d0062e9a025fbc77809b8ecc4e7f2fc2b6efbfe3ce6ff71bf95666a30ca97d05dc28cd8e1b6827a1f6f635a978acf692aa824942001f4a00a5a2ff00c782ff00bc7f9d43af7fc7aa7fbe3f91ab3a44724564a92295393c118350eb714b2db22c4a5c87ce1467b1a00d587fd527fba3f95646bcca2d154f52e31f91a62ea37ca8116cdf2063273fe14c4b3bcbf9d67bf1b117a27f9fd68036ed815b6895ba845cfe553514500145145007ffd2e928a28a00a77f69f6db730e7690720fb8aa49fdb51a88f113638dc7fc8fe55b345006658d8c90caf7572c1a57e0e3a015a745140051451400514514005145140051451400514514005145140051451401ffd3e928a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a0028a28a00ffd9"),
		},
		{
			dg:   11,
			data: utils.HexToBytes("6B605C0A5F0E5F115F425F125F135F0E0D534D4954483C3C4A4F484E3C4A5F110A414E59544F574E3C4D4E5F4217313233204D41504C452052443C414E59544F574E3C4D4E5F120B31363132353535313231325F130C54524156454C3C4147454E54"),
		},
		{
			dg:   12,
			data: utils.HexToBytes("6C3E5C045F195F265F192A4A414B41525441202D20414D42415353414445204445204652414E434520454E20494E444F4E455349455F26083230313730393035"),
		},
		{
			dg:   13,
			data: utils.HexToBytes("6D0A01234567890123456789"),
		},
		{
			dg:   14,
			data: utils.HexToBytes("6e82021431820210308201c4060904007f000702020102308201b53082014d06072a8648ce3d020130820140020101303c06072a8648ce3d01010231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53306404307bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826043004a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c110461041d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c53150231008cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565020101036200047777b5202c812ea334f4295b6ae711f70cc77ca43a53560569603cb92fb55c084d714bcf291f3c4dbb8ead1278fca88c3d6adebd71f9e2de90cb0450f8ab7cdcba5af6752eb3c57ea7d5f126e21c10cedd0fcb6d7ff2f57a713306e59882b51d300f060a04007f00070202030204020101300d060804007f00070202020201013012060a04007f000702020402040201020201103012060a04007f00070202040604020102020110"),
		},
		{
			dg:   15,
			data: utils.HexToBytes("6F8201023081FF300D06092A864886F70D01010105000381ED003081E90281E100BB8F93F4DC95E205CDA17C6927AB1E365B13065D03CD12E0FCE95D96840529453202F56CC4C13F77CD062930C8BC89A2873B257045C286E601CF3C09323A53103314902804AA10A314628CE222206A8866946A36B442041BB54AC81E6855DD1D6E16101833D65A191C20AC8B33B8A1A32920F46043F8031CF2BC17417030865FC5BE5A39DEE423BCBA3CA8177168EB23CFE01BA43EC87711B1CFFF85DB46F300DD8AE317B50D543B573E119E23AF7070D0B2FED6A3B2313A5EC02A531AAED1741F4390D1013E2A0F081EAC5DC8B0A1B2C6BDB1206F08D30E3643E1E5BDF536110203010001"),
		},
		{
			dg:   16,
			data: utils.HexToBytes("7081A2020102A14C5F500832303032303130315F5110534D4954483C3C434841524C45533C525F520B31393532353535313231325F531D313233204D41504C452052443C414E59544F574E3C4D4E3C3535313030A24F5F500832303032303331355F510D42524F574E3C3C4D4152593C4A5F520B31343135353535313231325F5323343920524544574F4F44204C4E3C4F4345414E20425245455A453C43413C3934303030"),
		},
	}

	var expHashes map[int][]byte = make(map[int][]byte)
	expHashes[1] = utils.HexToBytes("ceaecfd1454a0e6dcd187c25c3712d36a239edbcd2c8ead07b49cf441bda4b92")
	expHashes[2] = utils.HexToBytes("4ec0d892e967ec09a5474a1635db1ef826512859ade9d5df0ca5bc0bab1f8c39")
	expHashes[7] = utils.HexToBytes("67743642589a10869decec013ed23710a27217aec55def82736ca9af83cc5195")
	expHashes[11] = utils.HexToBytes("5521e3c33ba977dedf74e6f64f553f146ea4623659aa8604d5ce55055a9980d4")
	expHashes[12] = utils.HexToBytes("4134c2d26f86da0eb7fb20b09175533b6cc17aad0f927780ce93eddc03cbe7bf")
	expHashes[13] = utils.HexToBytes("066bbf37837578494f81a1accda00d49c1ac550b70899453677c68fc6bb22eab")
	expHashes[14] = utils.HexToBytes("3f9191bd4b002986bc0197b4c4d2cffd7ef34fe14e32495b793d7b00b6e44141")
	expHashes[15] = utils.HexToBytes("a5ed6c2a093e548a30f0bef91ac4c07d12e5733df252af1e24fced0ece56bf99")
	expHashes[16] = utils.HexToBytes("f7bd3a16a6432e8a99f7989dd5950574c68c52445450c4412e25d4ee788dc07d")

	var err error
	var doc Document

	doc.Mf.Lds1.Sod, err = NewSOD(sod)
	if err != nil {
		t.Fatalf("Unexpected error: %s", err)
	}

	// setups the DGs
	for i := range dgArr {
		err = doc.NewDG(dgArr[i].dg, dgArr[i].data)
		if err != nil {
			t.Fatalf("NewDG unexpected error (dg:%1d): %s", dgArr[i].dg, err)
		}
	}

	hashes, err := doc.DgHashes()
	if err != nil {
		t.Fatalf("Unexpected error: %s", err)
	}

	// compare against the expected hashes
	if !reflect.DeepEqual(hashes, expHashes) {
		t.Errorf("Hashes differ to expected")
	}
}

func TestDgHashesErrorDG1ButNoSOD(t *testing.T) {
	// NB DgHashes needs the SOD to determine the hash-alg, so DG1 alone should trigger an error
	var dg1 []byte = utils.HexToBytes("614B5F1F48493C55544F4552494B53534F4E3C3C414E4E413C4D415249413C3C3C3C3C3C3C3C3C3C3C4432333134353839303755544F3734303831323246313230343135393C3C3C3C3C3C3C36")

	var err error
	var doc Document

	err = doc.NewDG(1, dg1)
	if err != nil {
		t.Fatalf("Unexpected error: %s", err)
	}

	_, err = doc.DgHashes()
	if err == nil {
		t.Fatalf("Expected error")
	}
}

// based on an expired UK passport
func TestVerify(t *testing.T) {
	var com []byte = utils.HexToBytes("60145F0104303130375F36063034303030305C026175")
	var sod []byte = utils.HexToBytes("778207853082078106092A864886F70D010702A08207723082076E020103310D300B0609608648016503040201306E0606678108010101A06404623060020100300B0609608648016503040201304E30250201010420CA34A2808CA60C6671EC66F4E1229ADF0474BF1A7E099A05946B999438D511AD302502010204205F03553723906ACBE6B68B52F639F73B9F9E3C3135BC87E6E3D511C922AC7D20A08204F8308204F4308202DCA0030201020204492EBA13300D06092A864886F70D01010B05003041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479301E170D3131303830313132353535335A170D3232313230313031323535335A304F310B3009060355040613026762310D300B060355040A1304756B7073310F300D060355040B13066C6F6E646F6E3120301E06035504031317446F63756D656E74205369676E696E67204B657920333530820122300D06092A864886F70D01010105000382010F003082010A0282010100CE65C9D95D8FADB3C2AEABAB99220F96B5880F69AE651B3A7A378E293099B343BD1CB58FD28F0FD2F0166EA05273ECA9A3BE315397A7C6951C3FD09DCFF864C5F4B763F89851C8F9632E63D819C9EC905B90DA9D78FE0376F7218FE4B51EE88C66ECED44F4F98FEDFDBDD920484DA7AEE39E199196895DDC2C58ECF16B72D6E84770DE10793434C42FE01B8E7FC5DB7C38D7ACDEC5C1476CF1E69152E9D31CAEC122AF71280078AE054509F1CFEFC1340797FDAFCEAE5B4CBA8EDC7AB391DE69649CF9A33CA2596718E887C948EEA60BD99AA0E80C88FF94FA6FB78EEFAE98F4EC2CACC201D7EED96126292A23C4F9452D5EFF66333CC6DBE3E2EEDC3EC360DF0203010001A381E53081E2302B0603551D1004243022800F32303131303830313133323535335A810F32303131313130333133323535335A300E0603551D0F0101FF04040302078030630603551D1F045C305A3058A056A054A4523050310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479310D300B0603550403130443524C34301F0603551D230418301680144531A5B73BCF8BB27C7FAC88C74B4505F6C936B3301D0603551D0E0416041467B8149943C5F8C949BC846A34DBE7E05D241404300D06092A864886F70D01010B050003820201005BFB66391196171815A26AE99FD1653B7F6C9FFB751BBD69ADEF0B4182C043C4726FD826C8011BF12DA9374A79963613672C84289671EC31D53CA73E23E0A119F884B5D5836CE1F9DD03787624ABBDFEF475F16D5BFFFD719DE0B0FD1C0FE9D0E8064C6F77372CBBB00E1E43715A157EFB5F3D97E60A5018B6F07E7C735067FC73480B393D8945D09ED79F3D9C3F6299B7F2A2FC5829ABCE927C23010FE74788AF2AC7D38A08075C4559E256ECF8CB62BC27316FB477A79653A836EC03032CFA2FDF009EE6C9B5A102C91C381C0B941952A22AF5DAF9552A8A7F70D1F5847C8D3762CC7A2C0B44CC12A74C6CB410985641979B4CAD092A199A7371716592B9BC0A8691B60D830E13E749B31FFE120E0E2C98E2DE1C745ED16D3D2DF7205DDDC34C1B06413C28C9DC11C1F03F3E0A20321D8ACC13183EE003CE36DCA354E8053145F6055451C3F6A2A8E40998C5EF40609E431894C524CA9A7523B8B3BD667BD09F1F9E0EAC7602E1B8758F82EE61DA953E9B188ADF5A382D23EE4137F50B0A7AE8833AF55D5F0DD9E6E5D71B2A2543FBFAA2F7902D8E1BD656B6654264E108792E70C68227CE7F58C5C866D5CCFD3572941F21CFC2AA85EAEC84B4C6988C75BEC1711F11149356DC40119F4B023154BCED5B581FD71FEC2BC106D737E8D1F9704C5686A182C0148CA90B93CA17DD2797FBA2619F69D3F8474BC9D9493A33F45A318201EC308201E802010130493041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F726974790204492EBA13300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D010904312204206A2DFFE58D6A59A5AAE942C2BAF9A585B4B20E63C4B7ED0CE4B497FFC7F80992303D06092A864886F70D01010A3030A00D300B0609608648016503040201A11A301806092A864886F70D010108300B0609608648016503040201A203020120048201007465E8179610CC7D48D7F2AB0A88FD939E5CAB0D7226874F5647AA1A97911CF61DED88DA44D1AEC330C7045E3B5DFB7A79F19698C12D659BC37B8E98375D130ADEC2BD6688A57C996D9FC2DC8E0E2594BFA3E43E4FD7E63A7895435182D566F749C39FB4E948658E58769F871E665FA92C4C620DF2940DA028C72F2B05B4FA35E16201BD912AB7F6E4C07116E6086724C2009C2C29C2B83050546EE29CB162B975EF2A9718CDEC2737518D282CBA5B11A95707EA3DC915047A8906181B3E4FE823EA34A5C1BF7A93D5510EA8A7A355385C344E76647EF73AFF9270CC678D6DBAD06088C950E2BFC2DF382E48D765ACC6E4207E09457011AC72EBB4DBABB81611")
	var dg1 []byte = utils.HexToBytes("615B5F1F58503C47425253414E444552534F4E3C3C4F534341523C434841524C45533C4544574152443C3C3C3C3C3C3C3C30393932353036393236474252373830343035364D323230373137393C3C3C3C3C3C3C3C3C3C3C3C3C3C3032")
	var dg2 []byte = utils.HexToBytes("758243197F618243140201017F6082430CA1188002010181010283072011101711383887020101880200085F2E8242ED4641430030313000000042ED0001000042DF0002000000000000000002000100000001C100E900E3000001C2009000E300000000018001E0010300000000FFD8FFE000104A46494600010101012C012C0000FFC401A20000010501010101010100000000000000000102030405060708090A0B100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FA0100030101010101010101010000000000000102030405060708090A0B1100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDB0084010302020302020303030304030304050805050404050A070706080C0A0C0C0B0A0B0B0D0E12100D0E110E0B0B1016101113141515150C0F1718161418121415140203040405040509050509140D0B0D1414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414FFC000110801E0018003012101021102031102FFDA000C03010002110311003F00FD21438A378A68076EA334C028DD400ECD337D003F7D47BBDEA90067DE8FC6A406F1EF466801DBAA496EBCCA480877D3F77BD301727D6A4FC6800CD36801B914DFC6801BBA8A4004D426900714DA005A4E9400B4CA006EEE319A2801BD692801BB45338A00652EFA6022D3A801F4CA603B14FA00B8AD475A00751B8D003E994006EF7A334C06E69D48029864A401E652F983DAA80679B45201FBE8F329812F9B4F2D540377519A802234BBA801A5851E65201A5EA3DF9A402D266801D9A280194EC53021A280129BBE900950D002E68C5003C0C5068017A5255012D3E8026A5FC6801D9A766801F4DA004A5551B6A808569FC7AD480D56A4229201946E156806E682D5200AD5266A9002B54DBA980C32537CDA80137FBD47BE8017349BE900B9A8E9012EFA6E680199A7EFA003752F994C083753E80194DE948066692800A7F4A004CD25003A9B5404B520A009B349E6D201A29777BD004BE653734C05DD4DDD400DA4CD0030362A6DC28021CD2500328A0075279B400BBA9FE75500DF3734DF36A403CC1EB4DF3C531879C28F36A441BFDE937D201D9A3F8A8013CDA634E47414002C921ED53D00378A7500434C2D400DA2801F4A68023A5C5003F3495403AA65A901FBA91714D00E26A3A100FDD52D301334DA00299400CA75004746FA006EEA697A004F3A9A6551400CFB467BD34EA102F0D228C7BD2032FF00E12AB14765F397FEFAAC6D4FE2AE89A5FDFB95A48B8AB8B6DF13F419A0C8BF8F3F5ACF6F8C1A1472E0DDC58EFF003D01CA5BD3BE29E857FBF6DEC5FF007DD74B67AAC57F18789F2BF5A5721AB1723BA561C74A7F9A28403FCCA93753023A7F1ED400FA766801B9C51400C34CA006D14007FC0A9DF8D0014AA28017029140F5AA01CB535480CA2818FA29800A7A9A620351AB9A009299400C2D4864A6045BAA3DF400C32D4667A404267C0DD5C9F8B3E25E99E1BE269D030FF6AA4373CCBC79FB45DAF87ED6DE7B6B9439ECA6BC6FC41FB533B191A266E7D1AB36754299E6B7FF00B426B2262CB76DCFFB66B97D4BE2C6ADAB4987BB623DD8D34EC77C22BB1523F8A7A8592384B973FF00023543FE136BE933BA7979FF006CD32B950B6BE3FBFB7DDE5DDCA9FF000335DF68FF00B45F8AB46B5118D42423EB59C8CE508F63D67C17FB68EA16DE5C3A9C3E647DDEBE80F08FED09E19F14441FED8B037F758D61CCD1E73A4CF44B0F13D96A1FF1EF7514FF00435A315E86EF5D4998B562659AA5AB01FE6526FA601E653B753012999A4014DA403A9680199A7E68012A5C01D2A804CD3B7D0049498A918FCD250082937550876734CCD002EFA8CC9400DCD333548088BD4064A0085E4ACAD53584D3ADA4998F0A2B360785FC43FDA7ADB4385E0B3E5FD6BE44F881F18351F12DD3B34AE47FBE6923B6148E02EFC517774A16591DD57B6EAA6F78D27F11FCEB36761179724B4B1D8CD9EF48D516BFB2AE0AEE0871EF51C91CDD36E6A98898DA17898EDE6A9B330CA9E959812417D26CC64A0F635AD63AADDDB9DD15C3C7F46C51A7513D4F42F06FC7BD6FC2527EEEF1DFFDF735F517C3BFDAB34FD4345FF4DC35E7FB551B1C1381EF1E16F175A6BBA724EB3C7B88F5AE8EDEED65E41CD6CA57388977D4DBAB640479A995A980DCD454807D275A403E9E2801314A4500329BBEA807D3A802C536818EA4CD4811EFA938A043334B560356A3AA023CD34B52195CB5427EB480C3F10F89EC3C3968D3DDCBB462BE52F8C7FB4DC70A4B6BA73E73D706A0DE8C2E7CB5AE78B25D5DF7966693D735CC34B233B0FE1F5A83D4264D31A41B939AD9B7D0711E580A96558B0BA608FAAD58FB3AFF007699A9D158C2B7A9E4051C559FF846AD7FE792D65729229C9E1B04BE00AC77F0AACDBF81F954858A4FE1BF27AA0FCAA8C9A63FF0AE00AD8CAC65DCC27CDCE38ABF63AA3C0F95DCBF4353621A3D03C2BF1D75EF0D201F6A90C6BFC3E69AFACFE06FED1F178C654B6BE6589FA7CCD51CA714E9F63E8CB6BD8EE13706DC0D5ACD7523CF1F4FCD0019A6F1400B45500AAD4EA403B348698094CA404B9A55A404F9A8EA863771F5A6835202D26FA041BA8592B4401BAA2DF4C06D445A90D15259EB035DF1341A344649A4551FEFE2A40F8FFF0068DF8E7FDA886D74F970071F29AF95B52BD9B549896CE4D49E9D15645AD3B4F6F2B88CD6E68BE09BCBF2DFB9C8FA562CEC89DA69DF0D0DAAE5C714FD4BC3F159C59ED8ACEE6B639C788CD2E476A89597D2AD81ABA2A35BB97E79F4AD694B46A37AED35816456F72DFBE90FDCE954377CDDE824747B2E6E02E0B56D3F8660B84C18C2FE145C4919777F0E1B3B921DC3FDDAE4B51F0CBD8194C9195C7402B7B9324729796CFF00F3CCA55EF0DF8A2EBC2FA82CB14ACB8FEEB628723068FB27E0A7ED4B05EAC76FADC9B147F166BE9DF0EF8DAC3C4C37D8BF9917AD34F53C79C7959D179952A9AD8CC334CCD004949BAA805A7EEA4803752E698094DCD201DC53F229013D37341432928286D14C90A65301B9A299244C6AB3CD505A31754D522D3A369647DA83D6BE27FDA23E2B4B7DA9496F6572C211FDC7AE98DB919D3463DCF9A6E6F65BB9B2F23B9FF68D5DB1D06E2E678FCBCB570DCF5123D77C19F0E2E6EBFD6257B3685E02874E8F98D7FEF9AE36CDE264F88562D3F7EE4E3DAB84D6847788F8A51607017D69341BBCAC806A6B3D18705F9F5AD1B11D069B69BA5C81815B7AB691F6B51818ACCD0C8D4F4BFB35918A2E4D52FEC97117FB551711B1E19D1E1818BC899FA8AE9ECEDA3BA2CE50ED1D2A8A3B2D1B4AF350EF40777A8AC2F15FC3C4B91958C7FDF34EE23C5FC5BE0BB8B6DFFBAC7E15E5FA8E88F1B3706BA118B4686938B288B19F630E801AFA83E05FED01078634F582F594D6A79F56173EAAF06FC4683C5D12BC3F76BBC57A699E63133522D682169D400DA7D00145003A9B4C072D3B245004D4DDBEF48A0A66681B1D4DA684465E9A0D3016A276A092032565DDDE2DBE598FCB52688F96FF00683F8D5369F3369DA7CA833D79CD7C93AE6A32EAB72CD2734E6F9558F5211B11E97A07DAE6DB8EB5EDDF0DFE1AB9C3CD1FE62B8EA3B1D713DDF42D02DA0403CB0A7D856DCD65B62F979AE63589E7FE31B4B636EC1939AF2C9E15DCC02714A25A332EF4BFB4458D9F954D67A36C8FCBF2FE6A7724DFD3343D981E47E95B834862BFBC5C540CE7AEB4D98EED9013EE6A28B47707732B13E86A4B3A4D3343FB475876D7436FA447047B7CBFD2AC4741A4DA85C6548AD5B8B3F3AA912719E24F09C176AD9507F0AF08F1CF824E985DD63F97E9571641E4BA96998635059DFF00D91C738C5761C8CFABBF677F8A315A42B1CF7857FD9CD7D85E1DF11C3AB5BAB062D9A8A679153737F7D3B7574190EDD4E56A00753B3400ECD275A0028A6807E697AD080B35152286D474C05CE28A450C34CA648D26A032500549241EB8AF01FDA03E2DC3E1DB07B1D3AF4FDA7D51B06A0EBA11BC8F8BF5ABF935195E69A4695FFBCE726B2E1B0327099663594D9E99EE3F0B3E19F9C04D751E7FDE15F41E87E1F8608FE55007B0AE0BB363A25D3A185785AAB2D8903E594FD28089C96BFA235DEEDF8AE0E6F09F9ACCAAA40F5A46A87C3E11FE009F8D69DBF83BC93F2C7B8FAE29324DDD3F45D8D868D47E15B4DE1D8254F9A21F95242332F3C3007DD8FF004AA27C2A7FE798FCA99712E69DE1BF2FA8AD53A3F7DA2908B22D76F418A9FCA1569819BA8D90916BCFBC49A025F44E922E7EB490CF9E3C6FE0E7D39A511A71ED5E6B7360609F0F5DC99CD346B7853C49368777BE2E1D6BEA8F82FF001F352D52E121BED461B71E9B69B38A7147D63E1ED65350B557F3BCDFC6B7924DD5BA3CC92B0FCD3B753249339A76EA00753B34006FA334006FA15A802E522D0505464500474DA0B1951E71410465AAABB50070BF113C730F857479A4DE826C715F0778E7C4537883579A790E771EB58F53D1C323916C4DB862BD33E18780BFB5A613CD1FCBEE2B96B3D0F40FA5BC35A1A5944140E2BB1B7B454F6AE72CB5E5533ECF54894559B4B8E5FBC80FE159ADE1E41FC03F2A92D135B787107F07E957134150DC2E29016FFE11C8FD17F2AB034A45A988C6369C87B0AA4FA5AFA0AB1A235B454EC2A2317B540CACD1E2A364A57029C833581AB5907E702A91679CF8BBC3697B0B7C83F2AF9D3C67A0C9617477475D74DEA652473221025CE066B77C3FA87D96E848AC5707B5741C4CFB4BE047C4AD3EE2CD609AF0F99EE6BE8BB4B88E6843A3EEFA56913CBAAACCB74559812A9A7802801F4B400DC0F5A5A0029EA2802D1A4DF4C63BCC1ED5097A4319519A0B19BAA377A00A8D362B3F55D462B2B292476DB814107C5DF1C7C7A75CD5A4B74998C2BE8D5E237F2FBD607B5495A26BF84F44FB7C8A190B9AFA6FC01A0AD858A8D807E15E65495D9D48F4CB18822D692BD31938AB3E566A85614459ED538B353DA9058536FB7A54B0C63D2A1964C63155CC5599A9048954DE9DC0AE45557A432ABAD57734C0CF96B3EE003EF5480E6F528062BC93E26786D6780C8A9D3DAB544A3C2AE2DFC89C8C5322F93EED7A07233D23E13F89134CD623DDC735F7C7C3FD62CF50D2E2F20B1E3F8AB589E7575A1DAD15479C494F56A0076FA6EFA0076FA14D00494F8CD0059351D3431D4C7A43199A675A0B21A81CD005195B15E4DF1AFC629A3683222485643E86820F8B35595EF2E646EBF5ACB363E6119CD739EF4763D7FE17787C12AC53F4AF7ED3605B68C2815E4FDA3489D14002D4CBCB56A8D0BD1D5A8E9968B6AA29F8A96090EDE293A5494499A660566522BCE0566CB408809AAC6828AAE6A9BD2028CB59F2D5C40C9BA8F39E2B8CF125A89ED654615A88F9CBC53A5B595FBFA572CF2F97D0D7A08E391B3A35D7957B0C8BF2FD2BEEDF807ADC179A24799B2FF5ADE27056D8F7047F973537E3547963777BD49BA800152500369D40120A7AD005CA65580668CEEA91901A5A4510B9AA2ED41452B89000C7D2BE44F8F9E2B5BBD5CDB21F905265535791E21249F33568695686EE4FBB9AE596C7B47BF7C3ED2FECB6CBC57A4DA257986B03514D5857AB2CB51BD5C56A46A89D66A9777BD49487E296900A2A434892B39AA52A8A00A32D553C532CAEF545CD64328CB59EF568A2AC9581AAD989B35641E33F127C26D27EF5571F4AF1BBEB310F6AF463B1CD510DB3631D7D45FB34F89630E2091B06BAA1B9E754F84FB02CAE37C19CD5A592ACF205A97340053F3400B9A72D004AB522D005CA6530194940D11669690CAC6A94A682CE6FC4F7EF67A54E5073EB5F0DFC44BA6B9D76E3E62DCF7A966D43E23944B732E32793D6BB9F0758FDAAF0281F20AE2ABB1EB1EF9E1FB5114036815D2DBD702378976135663A0B2D4756E334CB44F4E8EA0B45CC53282095453F697A099104B0567CB1D0519EF55CD245A2A9355E5A819973D517AB4595DEB2EE6AD199CAF8A6C05C591C807EB5F3C7886C56DEF5D5D30B5DB4F630A9B1CDDD7EE64FDD735E95F09BC40DA4EB50638E6BAE279D23EF2F076A9FDA3A546DBB3C574CAD5A9E31329A77E34C078A92801A2A44A00996AC281401629954511669B93522436985A8195DDAB3DDA828F3FF008B5AEB693E1A9CC7C123AD7C41AA5E49757B348DF364F7A523B70E52FB408ABD63E1BD8651588AE0AA7A47B76971048AB4D78AE136896A3AB2A71416588CD5B8B8A6345C8EA68EA0B2E2A914EF27DAA8C996A380559F2576FDDA0928DD458AC87FA522919737DEAAEFF729148A2F55257AC4D0CB90D5635A1A15DEA84C956498DA8C3BC63A8AF1FF00883E1FFDEF981463E95B459933C86FE3369755A5E1BD59AD3518993D6BBD1C0CFBD7E0D6AC6FB4187E95EA8AC2BA8F0A5B8FCD58A090CD4B400EA7A5004D52A9A00B14DAA286E6A367A91221325425A8195DCD5191F14148F06FDA0FC43B74DFB386C57CACF703CB634A477E1F62AD81FB65D04C57BFF812DF6C31E38AF2E6CF44F53B15ABEB8AE6358132D590F9A114588CD5A56A48A897A1356E1029165E55A5271548C593C72F7FD2A392F6506842239AE55D319ACB7916A108CF930DDAA99E98A66B133A5FAD66CEC7D6B134467B3D42C6B4342AB9AA6ED542285D7DDAF3EF1AC5E65B9ADA262CF0EF135A6DE83158FA63F9528AF4A270B3ED7FD9EB5879B458FE6AF7C88E5739AE83C196E5C56A7EFA091EAD526EA0072B548AD40132B548A68027CD3A98C6D40690C88D4268115A46C565DDB7CA69968F94BF685D4546A5E4EE6C9F7AF08D588823DB9ACE7B9E9D1D89BC248B2EA230735F42F830AAA0AF3AA1D7D0F47B62455C4AE53689610D594E29144EA6AD467148D117217CD5C85AA8A34A3A46E69183230FE5B70694FDDA0465995876A8B70F4A432090E2B3A69B6D4B3546748F9ACFB9ACCE8466134B40CACFCD53952AA264CCCB93F25723E2584491575A32678D78B2C3E57C0AE062DCB3F53C5775267233E9AFD9BBC662DA7FB1487F3AFAE34F9BCC8856BF68F0AAFC468AD3C56C664C9535021DB6A4C5003D69F8A605EA66EA0686E6A2A43226AAE5E8115667AC6D4A4DB6D29CD345A3E29F8D7AA35DF8A9C97DDB4F7AF1ED7EF0CD20018D653DCF5696C74BE02876C809EBEB5EFDE129D7E5AF3EA1D3D0F49B47F96AE426B94DA25B5E2A7CD4144D1E2AC29A66889D1F6D5EB796A8A2DADC7B9A5DFF00ED1A93019E5FFB46AC73B7AD02284A1AA949BC50345295D87FCB4AA0E33D4D448D514A44DBFC55426FF7B35074233C9A696268450C355256A118B322E7AD73DAD46192BB51933CB7C589F785799CF108F7702BAE072C8F40F8317262F10C58C8AFBCFC332EFD3A327938ADFED1E1D7F88DD8DEA7535B989353D4D0224DD4F140134753014C09F269B400C3501269010926AB3D005696B9CD7D88D2E6DAC47CB41AC4F84BE24DE6FF0012DC6E39F9BBD79C4FFBCB9E6B391EC44ED7C273885862BDCFC198655AF3666E7A3D9BD6AC75CE6A8B2AD528AC8D0B5B6AC475450F44AD08E3AA289735328A440EA7938A0C8A4F30A85BE6ED402294D1E6B3678CD266C8AED1E6B3E584541B99F2C550E0D02644F5465AA466654ED9AC0D64FEE8D6E883CB7C4DCEEAF3A9712B3576D23924779F072EE2B4F13C3E62EE5F7AFBA7C3B2C6F66AD19E315D0B73C4C47C66EAB55856AD8E72C034F4A0092A5DD40122D4DBA802D134CCD3022DD5135202026A16614014676F96B8AF1CEA1F61D02E5D9B1F2D06B13E07F196A5F6BD52E24EBF357268DBA7159C8F651D9680FE5CC8A3BD7D03E03B57FB38622BCD99B9E876AB8AD18CD739A22CAD59AC51A1694D5986AD1658502AEAD31120E6A5DAF40884BB0ED4E1740AFDC341915DBDA2A6B3385FBA280453DADEB514F1285A0D0CE7ACD7ACD1AA2ABA2D5363B6A86522F54E638A689329EB33524125B3715AA20F1BF166E82720F4AF3E3C495DB48E491D8F81D92CF5381C1FE2AFB7FE1F5FC771A4438F4ADFA9E2E23E23B68C0A9B8AE8398996A64A009734FA00916A4A00B46A3AA01950935205573550B1F5A60539A4AF2BF8D17496BE0EBA25C86C7AD389BD3DCF82F58BB26593DCD51B225A5E6B367B27A17816CBEDDA921EA057D3BE1AB6486D1405C579723437D38AB30564685ACFBD5A492B13544D0C86ADACD4C65985C55EDF4103E39855B57A00873BA9993EB4086B49B3A55496E3DE8122A19EAA49739EF49165196426B3DDE81A2A96AAC6A8B2ACAB59B3C9480A06AADC2FC86B4449E45F1013649C0AF30BFF0095F8E2BB291C9237FC26DFE97073DC57DBFF000BC05D0E0CFA56FD4F2313B9E84AD56375749C65853526EA009334BBFDE80258DEAC0A00B2D5164D500DDD503D4814DEA16A680A2E2BC6FE3C5BB5D6926219C1EC2846F4FE23E23F155B0B4D43CAC639AAB6BE5919DBD2A19EBA3D0FE140FB46A3C7AD7D41A5AF970A0AF2E65970B54F6F25666E5E575EE69DF6A44EF581AC49ADEF10F7AB493034C658596AE8B8F7A0CC68B8DBDEAEC37A36D0031AE8F6E29CB78050042F702B3A7B8CD02456373549EF13D6922CAD25FA2FF15655EEB70C3DE81C4C393C570E71BA9F6FE2286438DC2ACB2F1BA89FF885655DD49253AAD70F8F5AA24F38F88766BE56FAF18BA39635DB48E691D5FC3FB6FB4EB36C98C8CD7DCFE0CB516FA4C207A574753C7C46E75B15581CD749C8595A9A801681401638AB10D005A35155811542F50053350D03212AA416F415E57E3CD5E2984CBF62FB40F7ACEA4B951D7868F348F8AFE27C118D6E59238DA3AE52C7918A4D9EBF2D8F56F8350AFF00688E057D27070A0D70CF7044B51C97F1DBF1589667CBAFFF00B46B39FC4DCE37FEB59B378889E2CF25BEF9FCEB5ACBC6711C7EF2A0B37A0F1244FF00C757E1D617FE7AD320B42FD4FF0015588EEB3DE9903FED5513DDFBD202B7F687BD675D6ADB7BD228C8B9F10048CFCD5C7EA5E34961FB95A8D1CECDF106E9BBD655F78CAE4F5F9AB248A22B3D46E2E79D84D684125C0E761A066B43ABCDFC4315A71EA7BFAB67EB5080B71C892D0D183D4035B191C07C43847D809C5782DCCD1F9A7AD75D33999E9BF05AD629F5D49A6C6C1EB5F575878D21B68BCBB38F70F535B4A563CF749CE6741A178B05FCBB24F96BAC8DF3574A5CC615A9FB364CAD532B5749C83A963A00B35610D00597A8B75680464D57739ACC0AAE6AB96A06882E7FE3CE5FA5793DE84B9328EB5C7883D7C02F799E13F16FC18928370B18C8F6AF185D3046C7E4A884AE7AB50F50F833678BBCE3BD7D068BB52B3A9B9CC8AF24D85AE7AF2E72D58A2915BC8F37A529D0C3F61526A8A52E80C735CA6AB69A85837EE777E06A6C6B7B9145E35BBB7187C8AB96BE33BE9BA4C7F3A56B81D8E8FE2B9A48BE6663F535D159F8A8F7A119B3A1B1D545DD58924DAB52499535CEDE86B02FF513F354A2CC29AE094E4D723AA9F7AE808985F60DFF00C6056D699A25B7FCB460FF008D4EC59D559E9D691AFCA1455C5B78BD054EE415A7B28CFA551783CBE952CA2EE9F2638EF5ADD6ACC4E53C6D6BE6696FC6EAF9C7544F2EEDD51475AEA81833D63E106932CF10664D95EEB6C16D2DB1D3158D47A9D34A3D49345D533AA28CF15ED364FBA1435BE1B76799984392C5A56AB0B5E91E38EA55A00B02AC474016DCD57FC6B40226A8CF1598154E2A120559442DF342C3DABC4AEEF3FB3F5C9A17FB8C78AF3F13F09EDE5BACD999E2BD23FB5AD19546735E19E2CF0BFF0064B74DBF4AE681EAD4D8E8BE1041B25AF6E3F769B38D19178D8EF58C577B52432CC67CAA867D7EDEC87CCE2A0B4644BE3784FDC8CFE26B0EEBC676CD90C62CFD68E566BB1C8EA7E24B6965F9510FD2A8C1E2D86D4FCF0155F5029F258499D9685E2BB29FEEB0AEA2CF51B79FEEBE2B3343B3D05F18C1AE8A44678AB2462CCC30E2B90D7EF23B0DC58D328F3DD67C70916769D95C35CF8A352D50EDB71B13FBCF5AA35B68363BA8ED06EBFD5A427D2326B56CBC77A24042ECBBF2FF00BFCD6BECCE794EC75169E24D1EEE3CDB6A922BFF00749ABC9ABDEDA26F599674ACDC6CCA56346C35C4BEFAD5DFF5950CD113DB455AAB4893275E8BCDB175DB9E2BC0A4D10CDE23119403E7F4AEAA471BDCFA07C27A2A691A7A85C568EA176CABB075AE77B9E9C1136909B6E23F5AF70D19F759A735D385F88E2CD97B913495B15614E6BD43E5896A45A404CB5325005C6E6A0AD0061AAEF598155AA37AD01118FB8DF4AF0DF16DB799E21E17BD79D8AF84F772CFE23278E4DC98E95E53F15ADFF75E6015CD0DCF464CB7F096C9041BF6D7A6CA4D3673A32EE12B31F11D245187AE6B6F676C5A3E4D79FDCF881E693CB8E33777EDD8FDD14234D88757D075382C1AEAF2E194FF0076335C533699A5B6FD412693E95E82A6717B42F0B6D3EE5927B50E233D8D76573E1009A72CF1C795C77150E25C25A98969A28B79B745F27FB2BC57456134D137A57987A4CF5FF87D742F22F9B93EF5E911DB26DFBB599CECC8D45123CE1715E17F112FA496EDA34CD06B13CF4E97B8666FC8D6AE87E1DFED397E6F9221FC35B4371CDF2C4C1F11E9D0DA6A8C3C81F2F6DB5847C5D36A971F628F468A141FC41715EA23C993B9D9782BC290DF5E306897FEF9AD0D7345BCF0CCBBED246962FEE1358558D91AD397BC59F0D5D34CFB98794DFDDAEEEC06EAF3D9E82376D6D87F747E55398C7A0A81146E62CA3715E43756B8F1AA8C77AEAA671BDCF61B66105A8A80A17393CD62F73D183B1A7A5A7FA5257B4E8FFF001E51D74617E239336F822694753257AA8F9526A9969013475616802D1AAE6B50236A809A802B3542681A0C7CB5E4BE24871AD935C788F84F5F00ED5198E99127B5705F136D7CED3F8CF5AE586E7AD236FE1EE9CB6BA4A6148AEB7CBDD4998A2AC96BBAB2EFECC8AC1337B1CBDF697E7562E9BE195B3BBF3234F9B3D715A0CE9352D1FF00B534C31903762BCBEF748B5B69BCAD4B4F91E35EE16BD284B43C86AC68687E1D5D76F238ECACCC36CA7AB2D7A7EA36315BE97E420CF158D491A535EF1C52F869256CC513E7DAB5A7D15638388C2B7D2BCC5B9EC4CEABE1DC5E5D7A95BBD33231F5A3B55ABC535EB0FB46AB97ACCB814BFE115DDFBE7859C569689A58B46F9A3FD2B707EF15FC51E031AABFDA2D71BC76AE54E83AB79DE5C7A4C6BFF4D15066BD58B523C6E5677DE17F0E0D0EC8BC8035C3526A9A5A4F92DCB7A572D69DCDE8475302CF49549B3B6BB7D12C55BA8AE091DE7402154EC2AB3C75080A137D2BCE350D067FF84B239C2FCB5D31DCC1A3D0E345718ED56974F6F2F3512DCE88A34F43B3DF74B5EB363FBB840AEBC2AD59E7E672BA48BB0B558539AF44F9E26DD52AD004C956236A605D26A1DC0D6804150919A802AB542681A23CD70FE36D3D639BCC1C66B9EAFC277E15DAA1C05EDC4917DDAA777690EB51A87191EF5E72DCFA0A86F585BC76F088D5768F415731ED41821DE57B552BAB70F5CE6E634FA7FF00B23F2ACE6B5F26B542162BC117DEE69F25DE9B77FEBE1CFF00BC2B48CCCA54C9A0D42C2C5710C5B47A28C5665D6AFE6FDD5E2B19CCD6952D49F4ABE78CFDD1F5A92E3FD2CD44761B7A9ADE19845B9F9463E95DEC27E5A3A8CC0D6E5EBCD79CEA7179D397F4A945C0920BC9445B3350195CF35A908D0B1D4641D541ABBFDAC707F742929CBA10E998926AB72EDF736AFB51F7CD17051B12DA59FB5751A5DB6D5AC8A2FECFA553B8711D1103325ACED4DD225DC00DDEB5B2339189A6EAD717375B141AF44B63B6CC07EB599D9256373C2F68279B2178AEEFA57A9865B9F378D95E4598EAC2715D8796581522500585AB094C0B0D515680424D439A0081A998A008AB91F1A2938CF22B196C7761BF888F3ABCB6CE6A8D844FE763B578E7D4D4F84E863AB0A052671A2C019A6FD9C7A5606A529ECEB32E34F0CB5B40462BE90FD6A91B397BA505A1BF667F4C5462CB26A4DAE695B59E2B5A2D3028A83345FD220DB27CB5D65BFDDAA259CD6B9CEEAE57ECB9CE466A11A22B3D9ECE718A6FD9F7A6475AD1104B1591E9D29FF607A631FF00D945FAD588B4551D852332E41A6EDFE1AD5862D9DAB1E80125665C60D319972FD6B075D7658F8AD63B13D49BC210471379CFF7ABBF8EDFCD5CE2889BD69599DE68BA7C5A7D9AF1CD68D7B34D591F1D51DD93466AC8AD8C8B3522D004C9CD4F1E69817735055015DEA134011D368023C573DE328B3086C566F6674D276A88E06E1145B31AA3A7A29476EF5E29F573F84BB18A956933089652AC815CC58D922DD5993438AD6005628B559E15AA0297D9B754B0E98A7AAD22AE5E8B4F55EC2ADF9402548C769A986E2BA15E22A684CE5B5B35930A0A8450D68F776A6C5662A80B0B6953F938ED56664C200D4F5879A8605E8E25A460056320336E1CEDEB59AD2D58D142735977B1F98BCD6B1D88FB44FA0DB664C57A768502CF2A8ECB554FE21635F2C2E75F5257B6B43E489216AB4AD5404818FAD4EA6802746AB51BD5016CD474015CD4645302BD140C84D66EBB6DF69B07AC8E88EE7976B2C6287159BA5DCE2164CF35E23DCFACDE91A56EDF2D4CAD4E472D32DC75663AE766E5951556684376A98925436DED5035967B56C03FFB2C54C2DB62F4A4319B46EA6BF34D1459D3E11BAB631FB8A453394D5C0ACB8D684225F2C54F6F052117E3B71E82A7FB16FED4CC80596DED52FD9805E82B02889B8AA8F2D234336E4D65CA71D2B724A6EF556E1830C574182F88D6D12C9600CFBB9AF45F0A43B6D4C87A9EF5AD25EF1CF8E97BA742AD52E6BD33E7096335321AA0274A9D6801EA6ADA715622E9A8B752190EEA8B34C08E9940D0C359FAA4AC34D9B1591D31DCF2992517CCE8D5872C0F6573F2FDDAF1D9F531F86C6DDBFDCAB718A5339605A8C558AE667492C2D52E2B1244F24533C9AE80176014C968198D7373B2961CC9548B356DA2DB5A0F2AF935259CB6A3CD65E71548822FB562B62CBE6A9066B5BC75647CB41891926A2793158145479AAA39A46A66DC9ACAAE820AAF5141666E65AE8305F11BB6506EBA58BB57A858C4B6F00450063D2BA68EE79F8F7B1712A6AEF3C41C95623AA026A9680254A9D5AAC468B5454C64069B8A40368C50C084AD57BCB6F3ACE55F6A92933CADB4BF22E9FEB4B358C4579C1AF227F11F5707745087157969331896A3A9AB8CE9448B530E6A1816401E947979AD008DE315467A00E5E5632DDE3B56F59A285A66ACD3878A98D3445CC0D4547F74564F9548B322EE368DB35D2694BBE3A45CCD841B6AD05DD52CE6229005EF59F2126914537AAAED41651979EB59B21AD9195CA2F255ED2186D6AEA472F53ACF0BE9DF6897CD2335DD20C575D1478F8A95E44EA2A4C5741C4491D4EB5404B52AD004B1F35328AD09342A2341447511A401450C08CD363F9810690D1E7FE22B36B4BD6E30A6B0E4C9AF2EAFC47D1E165CD4CCEE9572D9F3593291A09526715CA6E8746D5652A4B265E6AC5302BC959D70DF2D0062A4299DD5A56F8A0D59A76ABBBAD6808A1DBCB55232666DF584722FCAC0D73B38F28E2A0B45494248BC806AF6952014CA66BE6A7DD52CC8AF72DF2D547FBB40D145EAAB7E741655905635D1DB5AC4E633F756A69703374AEB898753D47C39A7FD8AC013D6B6A3AF462AC8F02A3BC8996A5E29990EA9D6A80929C9401612A5AD1125F7A4A650CA6E0500478A7E28115E9B40CAB7BA5DBEA6B8940CD70FADE86DA5F1D57D6B8EB42E8F43095395D8E526186A96D4E2B89EC7A68D48B9A9AB94EA4316AF426B334275A928115A49477AC7BDB8F978AA198CD75E527355E3F15DA799E57DA177FD6B5B1B1BD65ADAC8BF7EAD3EA3F2FF00ACA48CCAE9AA47CFCF5CCEAFAF44ADCCAA959168AF6DAA47731FEEDB70AD6D218E7AD53133A54FBB4A5AA0C8AF34950B73523293D5535404371C2F4AE6AF65F9AB689CE578C6EC6066BD17C27E196D8B2DC0C7B57A1496A70D59F2A3B60368C0E05491D75A3C427A5A60489566980FA72D501614D4C2A8934CAD458A650946C14011ED1E9494086102A1A0644D515D5B41A8C3B265C9AC98E2ECCF2AF1169ADA7DF15E8B5421FAD79B23DBA6CD4B73EF567AD711E8C4704CD5E8A309598C752E7341454B902B02E0F5AA434606A52F626BCFB50F0F86B8F3A09769F6AD8E989BDA55D5DC5D64CFE35B5F6E93FBD49193336F35636EAD863F9D71D2DBC9AA5D7997770C17FBA1B8AC4B89D669B34302AC502D761A566A99133A682A475A8322A533152328CF50D50146E65AE7E61992B789CACB9A241E76A31A01919AF618176285ED5E9D1F86E78F8864FB2A4ADD1C04B9CD2D302C2D4D8AA4048AB4AB4C09EA48F35649B34CC5201B8A6D301951500464D42682888D47480E2FE20DB8F96502B8B46C579F551EA619FBA5B865F7AD38BE6AF3CF56059C559AC91414D1262828AB3CB5957216B5B16735AB41BB9AE46E22AD0D60C2294C2BCD0FAC76CF35229EC51BC9A49FA54305A313CF348133A4D342C4DD2BAFD3A61489674366FF002F5AB5BAB36625492A124D41A10482AB96154230B529F6F4AC8C9AE889CB33A7F00D97DA752DF8C85AF51C57AB4FE13C4AFF0010FA728AB3947D3F14C0923AB34809375256849616ACAE2A8835F14CA0B1B515002546680186A3C50515DC54140189E2D83ED1A4938E95E64A95C158F430DF096B18AD0B53F2579A7AD12FA0A9EA22581E2AA49701283430EEB506F32A95D5CB1AD4B32EE5FCCE2B28DA0638DB5445C8A5D2EB9C9B4F7FB4D246B2D8E860D2F30F4A896C8C4FD3F1A9324CB70E3D2B4EDA761482E741697C516B5ADEE3CCACD88959455623150522B3FDDACBB8971D2A901897B2551AE848E699E99F0EAD3C9D3DA62BD6BAEEB5EB43E13C0ABF112D3AA8C47D3EA9012A0A9971520498A72AD68892C28A936D5106E1151D51A0CA88D210DA8E88811BD454C08EAB1A4510DD4492D84A8406E3BD791CBFBBBA65EC0D7257D8ECC30E6983F4AB36EC7D6BC967B10D8D4B77A9B7E2A4D063CB8AC1BABC3249C1AB02AB0F3B9A808A0A29884C8DC2D4FF00D9F4012FF65F98A6B04E8AFE69C8CD666E8DA834BDB6BC8AACF643D05067620FB301D854904554432E2F15A16775B3BD2649AE92065A8A7359019B293EB5953C98AB45191746A3B788DCDC2A2FAD7443739EA3D0F6AD16CC596951C5D2AF28AF60F025B9252D51048A29F4807A9A9A802415253449354C8B5441B9509AA3423A08A4223A655202034CA40444D438CD24508916F18AF27F13DAFD8356718C57356D8E8C31970B55C85ABC767B90D8D485E9FE7835268579E5F97AD60393BF35680990EDEF51E450315AF2D2CFAB8ACF9BC5107F0549D34E9DC817C52DD856845AF4047CCABF9541BF214AE7C5614600E2AA7FC24B17F17140B949A1D72CA5EE2ADA491B72B548E4993000F7A8D25C3E3354646CDBCFEF534AF58019F3CB5913B0AB434635CBD6F780F4B37BA9EE6E40F5AE9A7B9C95FE13D88285ED5246A2BD83C125F2299E5814C05C0A752024C54CAB4012E2A55514D123B6D585C55106EE2A222B52866DA8E900BB0542569904456A1A9288B150E28450899DD5E7FF00121145DA90066B9AA6C74D0F88E3233566392BCA67B312EC32B7AD5CAC4D0AF78008AB0C5C01D69A2A266EA7E20834F53BB27E95CB4FF105A54C5AD9CCC7DEA4DD2B9817773AFEA1F7136FD6A9B43E29B6FBAAAF4CF4E3627875DD6ED7FD7D8E7FDD1567FE1302BC1B59FF002A8362A5CEBDA95D8FF43B2727DEB2DF4CF145D365EE3CBF61522B22C43A67882CB9F3779AD8B0F156B360365CD917FF0076B4396A24D1D8E8BE2417BC3C6F19FF006AB61C53479F289A56396EB56657A93233A592B2EE27AA408CA9396EB5E91F0D228C46CDFC55D94BE238315F09E838A92302BD23C6252D50628285A9714C072D4F4C91F522AD04120A9B26981D1E0557DB5A884C544568290CD94CA0822A88AD2190F9751ECA11A11579EFC47FF5CA6B96A6C7550F88E1A392AD2B5796CF6225E89F6D5B592B0340B8DB5832A21ED481147FB122B96CBA2B0F71561F43B61F76351F4148EB8B2BB68FB7A533EC47D2A8E98B17CB5FEE0FC4533EC36CDD634FFBE6A0EB1BE446A301547E1519B612374A05CD60FECE5DD53A58C4BFC2BF955DCE3E61C74F8B3B820FCAAC151BA99CD291AD6A4795D2A09E61C8CD49CC653B93D4D675D1CD341132E56C735A5E14F1C0D2B5510B4B8CF6CD75D3DCE5ABAA3DD74FBB5BEB757439CD5FDB5E99E2125263340C4DBED52EDA6048A0548055123956A65A081EB52D007446995B811EDA4614808314DDBC5201BB47A5458A04426A3C500539592119738AF3AF1F5FDBDDC8163E715C93D8F430FF0011C28F96AC6EAF34F4C9A1B8C9ABBE78AC4BB90CB79EF5591B7541712E2A8F4A52291D45691AB3E4BFF2FB568599B2EB6B9C79349FDAF0775ACCEA57620D5D19BFD5D5C8AF73FF002CEA4CE6C9D466A658D2A8E4639E6155257CD23364F05D154C6E350BCBEF5BC8E6B94DE4159B3CD52B7293326F25C2F5AF30F12EA73E9BE218254CE335D7133E87D61F09B586BED1A2F318938EF5E8A2BBA078F57E224C0A4AD0C89714FC502116A55A640FC0A9280245607B54AAB408E9B02A2C5740C63AD37152808CC751D201856A2C502207AA72CBE506341271DAD6AB25D3EC5C85AE235FB6114B9DE49AE297C27A143E239A958D3E2949AF3CF52401B6F7A9D6EAA4089A6CD5AB7945606F12E79EA693767BD23A115E5002F5AC7B99A35E885A99A99337DB6EFF00D441B0FB8AA8744D67AED5A93AA2EC5BB48AF60FF5D6DBAB7A0C74DB8A48CA65A54F9699F8551C8C85E754ED9A8CCE0D4A3329198A9E0D466E76F5AE891CA412CDF2E6B3E49B7D34067DCF2B5E63E34B836DAA421978CD74C47D0FA3FE106AD1DBE990F9AD84AF6C82E21B84DD0BAC83D8D76C0F1EB7C44FF9515A98A24C53A810F58EA5514103B1526DA00545A954D023AA9462A0AE810DA8AA7601734DDA3D280213F4A80C4DE94C45391913BFEB5CDEB7A9A28E1B1594868E5FCF0C4BF615C2EA9AD4777AD490039AE697C2CEDA5B99EFDEAAF9A56BCE3D990EF329AB718A0C877995345305A948D513872C78ABAA3DEB2358B1F1D979DD4D5B1A740BFC03F2A474224FB1AFF74538AC7FDCFD29A2EE57FB3A9F4A4FB245E8290AE47E4A8ACFB838CD6473B3327900E959DF693EB5A980FDC3D6ABB480F7ADBA9910B495489354C6318835E6BF1342EE42073EB550DCD65B1EA5F0C6F3ED3E19DBDF15A1E0FF0088F75E1AF143E9F7733790E7E5DCD5E83D0F1A5F11EF9A5788A0BC8F3BB39ADC8DD5BA1A2E73B2C2D48AB5A923A9DFC3D29923B15381400B5262981D3B0F7AACD222F7ADC82BBDEC29D5C5537D6ACFFE7A564D8119D7B4F4EB3FEB55EEBC71A45B0FDCEFB96F4149C80C47F16EA1719F2E35813FDBACBBAF15DD2039BB66FF00778A2E320B49AE2E937C8CD8FAD56D6E3CC19EA6B26CB89917E069DA1BBC9C1C75AF0CD2F5533F8CA6F98ED6F7ACE5FC367552DCEDDC0AA338AF311ED95C3EDEB4C638E95460279E6A647CD0688BD0CF5A303D66544BD13D59F33DEB33AA23FCDF7AAFE7FCDD6A91A11996A06B8D952220373591737B527348CD7BA53DEB2FED40B75AD5188E37069735AA33203364E29C78A6CB895247DB5E4FF146F0A347CF7A70DCD6A6C77FF073C516DF65F21C54DF13B4393CD4D46CC1CA775AF46A6C7892F88EC7E1778F7FB4EC44724D89D3FBC6BD874EF17416A9BEE27C0F735999C91D2687E2DD3B5BF9609C16F7ADE539AD918120152ECAB10FC549B6801FB2A5DB4D00C4D4E79BD6A19EE1BFBC7F3A9720465481E6EE6B99F125FC5A1AFCCDFBCF4A82EC70E7C413EA17184CE3D335DEE81646183CC93EF5691D84C4BEBCDFBB9AA3676BF6962F29C20A448B7BE2FB088FD96D8F23B9A83FB4CDEBAAE334B94A39CF8AFA87D8F48740C471DABE77D0356FF8A9C67A56753F84CEBC39EC2AE248FAD559ABC947B4517A80C86ACCC4CD316E8C74C1173ED3B7A56C5A5C03C6683435216A5321F5AC4D50798597AD22FD6A91771CEE0567DC927BD2633366B82BDEB2269EAD239999D25C0F9B9ACE8DC3FDD34211794FBD0F31E82ACC858E3A98D666E8CDB9E33CD78E7C5993118C75ABA7B8E7B16BE15DD4DF68E8F5F40E90D1EA11182E70D9ECDCD7B0CF06A1E7DE37F0B5C7C3ED48EA5A6332DB9E4A83C53B4FF1EC9E218C7EF3A7519AE79C6C11D4EEFC2D7F303BA36646FF0064E2BDD7C27AFDFDC443ED51923FBC6B586C73CCEC2DEEA3718CF3EF57855903B02A4C5500E156768F4A093CE754F8E5E17D3E3FF45125D7D2A1D3FE2FF86F5380CAF71F67FF0065EB95B2A2651FDA07C2B14EF16D7FFAE9DAB80F10F8BD3C59A93CD0DC2BC5ECD5973DCD4D9F075879B743EE9FF8157A54AC628F68FD2BBF68985CCF6B166EC6B17C5F793E99A798ADC9C9EBB2A411E52D7F2FDA3BE6BD1BE1FDBDDCF279F313B3DEAAFD0A6AC729F1AEFC08B66EAF9D60BFF235B52BFDEAC2B7C077E18F71D16F96E2CD4FB55C939AF1E27B48A657AD51949AD112C67229DB049DA92334461D92AF594F8E7354686FDAEA887A8AB91DD427A9ACCB13CE8C77A60930D42190CFA80AA0D785BAD30B98F7F79E9594F37BD5224A171CFCAB4FB7B611F6AD1104CDF2D4917CD59108B18A6D666C8C7BF97EF5792F8DD45EDF8523728EC6B6A7B84F63D5FE1069F6BB933021C8FEE5773A8698DA6EA5BD571167B57AF23E7E7B9B7E25F0CC7AF786CA1C3E56BE57FB25D7837C572DB303E56EE9DAA5FBD11D267D27F0FB4AFED2B28EE14715ED5A5CDE45A71F9528BD0C5EE6BA426E9438F93E95A76979B3897F5AD0C51AF07D91D7264E68DA07707F1AA2872A54F8A083E79BEF837A85B47958831F415C4EB5F0F6E6D95BCDB4917F0AF5F968CBA1C9ED1C4F2EF1F5A4DA5D9948C30CFA0C579DD96A9AC69120F2AE278BFDD635E655C16BEE9EB52A91713D1FC39E22F10A279D1DFDCC7FF036AEC34EF8D3E23D1A4C7DB7ED9FF5D06EA8AD85A9D08691D4E9FF001B7C4BA832AA5BC0589EC95ED1A45997F0F196ED14DC4ABFC43A563CB286E73DACCF3FFF00857723DF79DE627944F4AF45B4B3874EB311C6303DAA56E6D23E7BF8D379BEF5973C0AF0CC01779CF22AEBF43BF07F09EC1E14B9DD64B83DABAA0F5F3B091ECA2322AACAA0F6AD9124263A9303D2AD1046D1541FEAFA531A162D4997F84D5E4BE0F48D958B2B7A297FB44D3302ABDD8AAF3DD9ED4C0C59AE1CB74CD45E5B1E4D0682EC5F4E69E062A8C850B9A9A20ABDAB12CB3B055290E291AA39FD72E0431B5798EA2C6E6EFA66BA60655763DAFE105BE5938E95EBDA86991EA109535EBCFA1F3F2DCC3B7D5DB4BCC0FF00328F5AF2CF897A259DFDDFDB608D564A5021687A37C19D409D30C2457A8D8CCD835CD4F61CF73ABD359A586AE35A12B5A182294B6B32AE4123F1ACF9AFA4B3FBF2BFFDF5549899D668776D7B63E664BD6A56EC9460DC5C11CD67DC79779F7BE7FAD1CD25B1CF65D4F0EF8B9E18D3F58BD1026D8B1FDD18AE260F85B69C795891BFDB19AEEA15F99EA6893840ECDBE1BE9BA5787FCDBED404071D02D795CF1017A6DF4CD93267FE3E1D6B59E223CE4C39D9EBBF0E3E1CED10DD35C03EDB6BD9B56DB069612B8313F1951BDF531F4BB3FB455ED56E6D34AB72D7370910C74AF3E3B9D333E53F89BE20B1D5352B8F2AE95F9F5AF3DB3D2F75ADD5C673B456B88E877E13E13AFF00879A8F9F6839AF44B63BABE663A33DB44A633B6A22057522884D056A9180F00544D003DAA8922F280E2988314D0EE4D81F5A6ECCF7A448CF2B3D695F0B4C0A040F415181BE80B8EF2BE6A97C8F6A451218947F08A7EC03A01506A5739F4AA573F74D2344717E20BA331F2C75AE59AD1BEDDC0E95D748E7AC7BBFC25B3017A57AB6DAF567D0F9F7B98BA9F8365BEDD343C9C74AF32F12E83712830F944C9EF5988B3F0D2FEE345D63EC33AEDDDDCD7BAC517D97976509EB9AC7606749A0F88B4145313EA0335BB15FE9F7BFF1EF7224A0CC98DAF995E73E3733C4AEA99DF4E2CCE479BE87F143C47E1894C32C8CF066BD7FC27F10A1D7D37C775B9FFE79B574CC29BBA3A49A0DCA6B33CB10C4E40C9AD2E7358F28D43C2FAC78835679C5BED19FE215D5693F0DD2D143DCCFF37A0ACA2EC75FD939DF8AD65B3439076AF06D1CFF00A6A2F6A74F59EA691EA7D4BF0FEDBCBD1E32462B47C553636440D6B89F8D9CD02FF879156DCBE0578B7C5EBD92EA6B9C31207BD73D08F317367C87E329248E662320EEED5DB785D566F075C334C5A523D6AB1B1E5A88F4B0DF0A26F87B75E57CBFED57B169D30E2BE667F133DE86C69641A84C5ED5B440AC529B8AA33184D02AD1991B8A62C46AD122AAE29CDF2D3626572C6A2CEEA81A0F24D46898A404DE5549E5D41A8839348CC0506840F2D606ADA87969C5234397402779256ED5434CC4B316233935DD4D6879F55EA7D0BF0C74FF0026CB7EDEB5DF141E82BD16788F734F4F3B3A5725F1121812DBED089B64F51D6B040780F8EB5CBAB183ED56B33C53AFF183CD5AF84DE2BF12FC40D492D2E356B8F27FDA24D743B365A8E87D37A5F82B4DB11FBC5F35BD5866B6E2820B4FF551AC5FEE0C566731B9617EFDC93585AC8FB5DEE4C63F2AC42470DE31F087D9E2FB4220DA7DABCFEC35C6F0DEAAAF1FAF6AF46DCD4CE3A2ED33EA092DB69FBD4A608D57A035C7CC76A88050ABC715527A9B96794FC6298C3A11AF1BF04681FDABAF44A07CB9AD68FC4247D57A6DB259C1142985DA3B5737E219BCED57E95555DE4CC29EE74BA64491E919675887B9AF36F1A785A0B8B29E72D9CD3C23B48CAB33E56F1A7846296621699E1AD1DACB49B85229E35F3543D6C27C088BC1C3C9B971FED57ADE9737CA39AF98A9F11F450D8DF864156715A44442F6FBBA556500355100CA076A87655C4CC08A2A841B46CE9509A6219DA9BB47A0A918E55A8B6FCD598132C2691E83588CDB55E61B3BD4B36316FEF0C7D1AB97BC99A6EE69126A59F87BC8F0E4F712FDF22B9EF0AA992F962233F357AE96878BCD7B9F537856C85AE9F1ED0071DAB676FEFBA5751E77535228F1597E27D2D350B328D8AE628F15F1A7C3299F4F9B6CCA78ACBFD9E740FECCD7A4DFF7B35D112F9B43EA7FE0A83EF3541CC5FB4A8D97CE9C9EF5914C4BCD3FEDD62D1483767B5780F8ABC2E74FBE6772C9CD7A145F43CD7EEC8FA6267CB53D05709EB0FC567DD3ECA903C57E35EB91CD0ADA8A6FC17F0E948CDF4C381F76BA286E27B1EAEB7C223BAB8BBCBEF3EFE57AA918D230E7D62EAE351113DC48D1E7EE82715D1F8DAE561F0B1DBF29C76ABA0BDF30C4FC27CB9AF5E39BCAE9B41D05B50F0BCF2EDE7D6B1C57F18F4E8694E2707A7DA3586B1329F5AEEB49B86AF0712AD519F454B63AFB5C6DAD18EA0D42A1780374E0D59245E5E28F2E9A311A62A6F962AC9212285805301A516A2236FBD660273E94BE46290224DB4D650B41A94EE6F123AC4BAD4C366835316E640D4DD0F4EFED5D4D630A7655D38DD98567CB1B9DEF8C749163E1A60A368C5709F0DF48FB6EB08F8C815ED1F3D17EE9F4E692A2288255DDBFBDAD19C9D4D4B6FA556D623095CA6C711AFDB6F8651DABCDBE1FCCDA5F8A65CB7F157650F88996C7D1F6F279F681E9F047DEB2EACCCD2B351CF1505A8FDF39AC0D91A2B36DE82B1F5FF08E9FE298B173FBB6F514EED6C672826693DC0DD53C126699A93B7CB58D7D2E735207CEDF11A59354F148B75E707B57AFF862C7FB2B41821E9C574D2EA673D8B777FF001ECE6B8E5B807755CC9A459D27446967F3EA2F89937D9F41DA16B7C3AFDE1C38C7EE9F32EB2DFE99DEBD87E1F47E7783596B8713FC63D7A7F044F32F1469B2695AD3B7AD5DD2EE3A735E56317EF0FA3A4EE8EAECAF2B7A09F7A5729B930A5A684C8CAE6A3F2DAAD198E54A76DF6AA3121283D298C3154056D94F09FEC8ACC042B4DDE12A4224125EC6B58D79AE0A46C621D41A5FBD50F5A11A955D79E3935DF781ECA2D3544970AA1BE95DD865EF1E7635DA04FF0014FC596D2689E426326A3F839A17936FE7C8BF8D7A8CF0FEC9EBB19DBD2B4A0E79AB91C9D4D9B740DD2B33522D24DF3D719D48E73558FF0070FF004AF10D3AE5A1F134DFEF574E1FE2225B1F49E85779D0E1CF5AD646DAB44BE26665FB398796D469D16EDC6B9CDD17BCBF6A4C52198FBE9D05DB2B56E493CF7E7D6B9FD6F55FB2DACAF9ED5049E45E0AD29FC4BE2F9EF24F9A20DFC5CD7B1E17007615D30F84C64CA5AAB84B06C571141AD3D8ECF477DB64A2B9CF8A338FECCDB5D186F8CF3B147CF37D0ACB767E45FCABDB3E1EE9423F07EEDA3F2AF2EABFDE1EBFF29C17C4CD376CBE662B93B0E2B9715AB4CFA0C37C26FD9CBEF5BF6737BD701D86AC12558A943235A9F2B5640FDAA6A3DB54624463A8CC63D28286ECA89BE5A462559095ACD9E63EA682D18F7331F5ACA9307AF3526E88C8A889F7AA3435FC2FA136A175E637DC15BFA94DE5C9B50FCA2BD4A4AD13E7B153E691C2EB2CFADEB905A7F0D7D0BE11D323D3F468D140CE2BD13CD9F637D78ED5A71261291817A093CBE7B5675CDCFDB2E8F15CB2D8D62666A518F25863B57823C613C64E3D5A940D4FA1B44FF8F1857DAB69A5DAB5B3DCCCB104BB62AD6D37FD5566345FCD56E2A40CA586A3DB8AD4A239D85713E3FBE8AD7467F9FF0078FC0A820E6FC277C3C39A41DA0798FDEA49BC6D723FE5AD767439771EDE2A9EEA2F29D81A9FCBC479EB59C8EAA7B1D668A3CD856B99F8AB1F951AAD7461BE33CEC49E132A8374DC57BE782AC9D3C1D15795557BE7AFFCA71FF12B4CDD6A4E39AF2BB6C8AC2BFD93DBC2BF74D688915AB672FBD79C7A26E59CB5A62818EF2A97C8A9249554D1B714CC986053368F4AD06478A81F1E82A08285CD605C4869168CC979EB550C6B4CD115DEA6D1F497D5AEB62F4AAA7F113525CA8F62F0A785E089562DBF5E2B7FC5DE10D06D74491E3B7D9305FBD5EBEC7CB4E5791F3AF86E3FB478A269BAA86E2BD9F45F10792369276D76A31A9B9DBE97750DF77AE83ECDF2F14998219B5A35271C5675BF3B9BBD73CB63580CBD8545B48C7D2BC0E1916E7C70781F7E953353DE2C5F6C231C559591A43D4D6AF732669AF4C5695A4C57BD41512F8763FC468DA6A447316BE27B393FE5A7E757D2F619BA3AFE75BB88B9AC4326C3FC55E57E378CEA7AD456C9B982F61CD65CA55CAF2E9978C302D652BF4AC99B4CB81D6DE5FF00BE6B6D494D15262D63838C1ADBB5F1445243B5FE5A23A9AFA1E93E1797CCB3571F76B92F8B1704D6B85F88F3B1078DC28B25D7E35F4AF87ECF67836D400071DABCE9FC67A2F789CB78FB47F36CC57885C58FD86E196A66BDC3D8C23258EAE45C57928F60D6B373EF5B70C948468C78353ECA1012607A53368F4A66244462AAB3D328ACD30AAA66A0122948C7D6B32E0541B142502B3A5A06554B6799B68EA6BD43C21E175B184363E73DEBBF0D13C9C64F43D4F41D1FC95DE6B87F8B3E2116962D6A87E67AF40F0CE17C37E02B8B7B0376ABBF777AB6BBADCFD3B1AD65B9117746CE87AFBDB4FF0079B6FA66BD3B43F175BDF00AC76BD6BBA30E5B337AE265FB29D98E6B212B9DA34895B5361F6297E95E09A4C61FC6CF81FC75BD05EF05CF77846C807D2ADD90DCD597507B1A91F356233591A2356D8D59A2E480FFD9")

	var err error
	var doc Document

	doc.Mf.Lds1.Com, err = NewCOM(com)
	if err != nil {
		t.Fatalf("unexpected error (NewCOM): %s", err)
	}

	err = doc.NewDG(1, dg1)
	if err != nil {
		t.Fatalf("unexpected error (NewDG:1): %s", err)
	}

	err = doc.NewDG(2, dg2)
	if err != nil {
		t.Fatalf("unexpected error (NewDG:2): %s", err)
	}

	doc.Mf.Lds1.Sod, err = NewSOD(sod)
	if err != nil {
		t.Fatalf("unexpected error (NewSOD): %s", err)
	}

	err = doc.Verify()
	if err != nil {
		t.Fatalf("unexpected error (doc.Verify): %s", err)
	}
}

func TestDgHashBadDgErr(t *testing.T) {
	var doc Document

	// NB -1 is not a valid DG, so we expect an error
	_, err := doc.DgHash(-1)
	if err == nil {
		t.Errorf("expected error")
	}
}

func TestDgHashUnknownHashOidErr(t *testing.T) {
	var dg1 []byte = utils.HexToBytes("615B5F1F58503C47425253414E444552534F4E3C3C4F534341523C434841524C45533C4544574152443C3C3C3C3C3C3C3C30393932353036393236474252373830343035364D323230373137393C3C3C3C3C3C3C3C3C3C3C3C3C3C3032")
	var sod []byte = utils.HexToBytes("778207853082078106092A864886F70D010702A08207723082076E020103310D300B0609608648016503040201306E0606678108010101A06404623060020100300B0609608648016503040201304E30250201010420CA34A2808CA60C6671EC66F4E1229ADF0474BF1A7E099A05946B999438D511AD302502010204205F03553723906ACBE6B68B52F639F73B9F9E3C3135BC87E6E3D511C922AC7D20A08204F8308204F4308202DCA0030201020204492EBA13300D06092A864886F70D01010B05003041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479301E170D3131303830313132353535335A170D3232313230313031323535335A304F310B3009060355040613026762310D300B060355040A1304756B7073310F300D060355040B13066C6F6E646F6E3120301E06035504031317446F63756D656E74205369676E696E67204B657920333530820122300D06092A864886F70D01010105000382010F003082010A0282010100CE65C9D95D8FADB3C2AEABAB99220F96B5880F69AE651B3A7A378E293099B343BD1CB58FD28F0FD2F0166EA05273ECA9A3BE315397A7C6951C3FD09DCFF864C5F4B763F89851C8F9632E63D819C9EC905B90DA9D78FE0376F7218FE4B51EE88C66ECED44F4F98FEDFDBDD920484DA7AEE39E199196895DDC2C58ECF16B72D6E84770DE10793434C42FE01B8E7FC5DB7C38D7ACDEC5C1476CF1E69152E9D31CAEC122AF71280078AE054509F1CFEFC1340797FDAFCEAE5B4CBA8EDC7AB391DE69649CF9A33CA2596718E887C948EEA60BD99AA0E80C88FF94FA6FB78EEFAE98F4EC2CACC201D7EED96126292A23C4F9452D5EFF66333CC6DBE3E2EEDC3EC360DF0203010001A381E53081E2302B0603551D1004243022800F32303131303830313133323535335A810F32303131313130333133323535335A300E0603551D0F0101FF04040302078030630603551D1F045C305A3058A056A054A4523050310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F72697479310D300B0603550403130443524C34301F0603551D230418301680144531A5B73BCF8BB27C7FAC88C74B4505F6C936B3301D0603551D0E0416041467B8149943C5F8C949BC846A34DBE7E05D241404300D06092A864886F70D01010B050003820201005BFB66391196171815A26AE99FD1653B7F6C9FFB751BBD69ADEF0B4182C043C4726FD826C8011BF12DA9374A79963613672C84289671EC31D53CA73E23E0A119F884B5D5836CE1F9DD03787624ABBDFEF475F16D5BFFFD719DE0B0FD1C0FE9D0E8064C6F77372CBBB00E1E43715A157EFB5F3D97E60A5018B6F07E7C735067FC73480B393D8945D09ED79F3D9C3F6299B7F2A2FC5829ABCE927C23010FE74788AF2AC7D38A08075C4559E256ECF8CB62BC27316FB477A79653A836EC03032CFA2FDF009EE6C9B5A102C91C381C0B941952A22AF5DAF9552A8A7F70D1F5847C8D3762CC7A2C0B44CC12A74C6CB410985641979B4CAD092A199A7371716592B9BC0A8691B60D830E13E749B31FFE120E0E2C98E2DE1C745ED16D3D2DF7205DDDC34C1B06413C28C9DC11C1F03F3E0A20321D8ACC13183EE003CE36DCA354E8053145F6055451C3F6A2A8E40998C5EF40609E431894C524CA9A7523B8B3BD667BD09F1F9E0EAC7602E1B8758F82EE61DA953E9B188ADF5A382D23EE4137F50B0A7AE8833AF55D5F0DD9E6E5D71B2A2543FBFAA2F7902D8E1BD656B6654264E108792E70C68227CE7F58C5C866D5CCFD3572941F21CFC2AA85EAEC84B4C6988C75BEC1711F11149356DC40119F4B023154BCED5B581FD71FEC2BC106D737E8D1F9704C5686A182C0148CA90B93CA17DD2797FBA2619F69D3F8474BC9D9493A33F45A318201EC308201E802010130493041310B3009060355040613026762310E300C060355040A1305554B4B50413122302006035504031319436F756E747279205369676E696E6720417574686F726974790204492EBA13300B0609608648016503040201A048301506092A864886F70D01090331080606678108010101302F06092A864886F70D010904312204206A2DFFE58D6A59A5AAE942C2BAF9A585B4B20E63C4B7ED0CE4B497FFC7F80992303D06092A864886F70D01010A3030A00D300B0609608648016503040201A11A301806092A864886F70D010108300B0609608648016503040201A203020120048201007465E8179610CC7D48D7F2AB0A88FD939E5CAB0D7226874F5647AA1A97911CF61DED88DA44D1AEC330C7045E3B5DFB7A79F19698C12D659BC37B8E98375D130ADEC2BD6688A57C996D9FC2DC8E0E2594BFA3E43E4FD7E63A7895435182D566F749C39FB4E948658E58769F871E665FA92C4C620DF2940DA028C72F2B05B4FA35E16201BD912AB7F6E4C07116E6086724C2009C2C29C2B83050546EE29CB162B975EF2A9718CDEC2737518D282CBA5B11A95707EA3DC915047A8906181B3E4FE823EA34A5C1BF7A93D5510EA8A7A355385C344E76647EF73AFF9270CC678D6DBAD06088C950E2BFC2DF382E48D765ACC6E4207E09457011AC72EBB4DBABB81611")

	var err error
	var doc Document

	doc.Mf.Lds1.Sod, err = NewSOD(sod)
	if err != nil {
		t.Fatalf("unexpected error (NewSOD): %s", err)
	}

	// update the SoD to reference an invalid Hash OID (OidBrainpoolP256r1 is NOT valid)
	doc.Mf.Lds1.Sod.LdsSecurityObject.HashAlgorithm.Algorithm = oid.OidBrainpoolP256r1

	err = doc.NewDG(1, dg1)
	if err != nil {
		t.Fatalf("unexpected error (NewDG:1): %s", err)
	}

	// NB SoD has inalid Hash-OID reference, so we expect an error
	_, err = doc.DgHash(1)
	if err == nil {
		t.Errorf("expected error")
	}
}
